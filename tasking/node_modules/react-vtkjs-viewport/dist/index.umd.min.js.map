{"version":3,"sources":["webpack://VTKViewport/webpack/universalModuleDefinition","webpack://VTKViewport/webpack/bootstrap","webpack://VTKViewport/./node_modules/prop-types/index.js","webpack://VTKViewport/external \"vtk.js/Sources/macro\"","webpack://VTKViewport/./node_modules/@babel/runtime/helpers/toConsumableArray.js","webpack://VTKViewport/external \"react\"","webpack://VTKViewport/./node_modules/@babel/runtime/helpers/defineProperty.js","webpack://VTKViewport/external \"vtk.js/Sources/Rendering/Core/Coordinate\"","webpack://VTKViewport/external \"vtk.js/Sources/Common/Core/Math\"","webpack://VTKViewport/./node_modules/@babel/runtime/helpers/slicedToArray.js","webpack://VTKViewport/external {\"commonjs\":\"cornerstone-core\",\"commonjs2\":\"cornerstone-core\",\"amd\":\"cornerstone-core\",\"root\":\"cornerstone\"}","webpack://VTKViewport/external \"vtk.js/Sources/Rendering/Core/InteractorStyle/Constants\"","webpack://VTKViewport/external \"vtk.js/Sources/Common/Core/MatrixBuilder\"","webpack://VTKViewport/./node_modules/@babel/runtime/helpers/classCallCheck.js","webpack://VTKViewport/./node_modules/@babel/runtime/helpers/createClass.js","webpack://VTKViewport/./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js","webpack://VTKViewport/./node_modules/@babel/runtime/helpers/getPrototypeOf.js","webpack://VTKViewport/./node_modules/@babel/runtime/helpers/inherits.js","webpack://VTKViewport/./node_modules/@babel/runtime/helpers/extends.js","webpack://VTKViewport/external \"vtk.js/Sources/Rendering/Misc/GenericRenderWindow\"","webpack://VTKViewport/external \"vtk.js/Sources/Widgets/Core/WidgetManager\"","webpack://VTKViewport/external \"vtk.js/Sources/Filters/General/PaintFilter\"","webpack://VTKViewport/external \"vtk.js/Sources/Widgets/Widgets3D/PaintWidget\"","webpack://VTKViewport/external \"vtk.js/Sources/Widgets/Core/WidgetManager/Constants\"","webpack://VTKViewport/external \"vtk.js/Sources/Common/DataModel/ImageData\"","webpack://VTKViewport/external \"vtk.js/Sources/Common/Core/DataArray\"","webpack://VTKViewport/./node_modules/@babel/runtime/helpers/assertThisInitialized.js","webpack://VTKViewport/external {\"commonjs\":\"cornerstone-tools\",\"commonjs2\":\"cornerstone-tools\",\"amd\":\"cornerstone-tools\",\"root\":\"cornerstoneTools\"}","webpack://VTKViewport/external \"vtk.js/Sources/Rendering/Core/Renderer\"","webpack://VTKViewport/external \"vtk.js/Sources/Interaction/Style/InteractorStyleManipulator\"","webpack://VTKViewport/external \"vtk.js/Sources/Interaction/Manipulators/MouseCameraTrackballRotateManipulator\"","webpack://VTKViewport/external \"vtk.js/Sources/Interaction/Manipulators/MouseCameraTrackballPanManipulator\"","webpack://VTKViewport/external \"vtk.js/Sources/Interaction/Manipulators/MouseCameraTrackballZoomManipulator\"","webpack://VTKViewport/external \"vtk.js/Sources/Interaction/Manipulators/MouseRangeManipulator\"","webpack://VTKViewport/external \"vtk.js/Sources/Rendering/Core/Volume\"","webpack://VTKViewport/external \"vtk.js/Sources/Rendering/Core/VolumeMapper\"","webpack://VTKViewport/external \"vtk.js/Sources/Rendering/Core/ColorTransferFunction\"","webpack://VTKViewport/external \"vtk.js/Sources/Common/DataModel/PiecewiseFunction\"","webpack://VTKViewport/./node_modules/@babel/runtime/helpers/arrayWithHoles.js","webpack://VTKViewport/./node_modules/@babel/runtime/helpers/iterableToArrayLimit.js","webpack://VTKViewport/./node_modules/@babel/runtime/helpers/nonIterableRest.js","webpack://VTKViewport/./node_modules/@babel/runtime/helpers/arrayWithoutHoles.js","webpack://VTKViewport/./node_modules/@babel/runtime/helpers/iterableToArray.js","webpack://VTKViewport/./node_modules/@babel/runtime/helpers/nonIterableSpread.js","webpack://VTKViewport/./node_modules/@babel/runtime/helpers/typeof.js","webpack://VTKViewport/./node_modules/@babel/runtime/helpers/setPrototypeOf.js","webpack://VTKViewport/./node_modules/prop-types/factoryWithThrowingShims.js","webpack://VTKViewport/./node_modules/prop-types/lib/ReactPropTypesSecret.js","webpack://VTKViewport/./src/ViewportOverlay/ViewportOverlay.css?0f53","webpack://VTKViewport/./src/ViewportOverlay/ViewportOverlay.css","webpack://VTKViewport/./node_modules/css-loader/dist/runtime/api.js","webpack://VTKViewport/./node_modules/style-loader/lib/addStyles.js","webpack://VTKViewport/./node_modules/style-loader/lib/urls.js","webpack://VTKViewport/./node_modules/gl-matrix/esm/common.js","webpack://VTKViewport/./node_modules/gl-matrix/esm/mat4.js","webpack://VTKViewport/./node_modules/gl-matrix/esm/vec3.js","webpack://VTKViewport/./node_modules/gl-matrix/esm/vec4.js","webpack://VTKViewport/./node_modules/gl-matrix/esm/quat.js","webpack://VTKViewport/./node_modules/gl-matrix/esm/mat3.js","webpack://VTKViewport/./node_modules/gl-matrix/esm/vec2.js","webpack://VTKViewport/./src/lib/math/angles.js","webpack://VTKViewport/./src/events.js","webpack://VTKViewport/./src/VTKViewport/ViewportData.js","webpack://VTKViewport/./src/VTKViewport/vtkInteractorStyleMPRSlice.js","webpack://VTKViewport/./src/VTKViewport/vtkSVGWidgetManager.js","webpack://VTKViewport/./node_modules/date-fns/esm/locale/en-US/_lib/formatDistance/index.js","webpack://VTKViewport/./node_modules/date-fns/esm/locale/_lib/buildFormatLongFn/index.js","webpack://VTKViewport/./node_modules/date-fns/esm/locale/en-US/_lib/formatLong/index.js","webpack://VTKViewport/./node_modules/date-fns/esm/locale/en-US/_lib/formatRelative/index.js","webpack://VTKViewport/./node_modules/date-fns/esm/locale/_lib/buildLocalizeFn/index.js","webpack://VTKViewport/./node_modules/date-fns/esm/locale/_lib/buildMatchFn/index.js","webpack://VTKViewport/./node_modules/date-fns/esm/locale/en-US/_lib/match/index.js","webpack://VTKViewport/./node_modules/date-fns/esm/locale/_lib/buildMatchPatternFn/index.js","webpack://VTKViewport/./node_modules/date-fns/esm/locale/en-US/index.js","webpack://VTKViewport/./node_modules/date-fns/esm/locale/en-US/_lib/localize/index.js","webpack://VTKViewport/./node_modules/date-fns/esm/_lib/toInteger/index.js","webpack://VTKViewport/./node_modules/date-fns/esm/toDate/index.js","webpack://VTKViewport/./node_modules/date-fns/esm/subMilliseconds/index.js","webpack://VTKViewport/./node_modules/date-fns/esm/addMilliseconds/index.js","webpack://VTKViewport/./node_modules/date-fns/esm/_lib/assign/index.js","webpack://VTKViewport/./node_modules/date-fns/esm/_lib/format/longFormatters/index.js","webpack://VTKViewport/./node_modules/date-fns/esm/_lib/getTimezoneOffsetInMilliseconds/index.js","webpack://VTKViewport/./node_modules/date-fns/esm/_lib/protectedTokens/index.js","webpack://VTKViewport/./node_modules/date-fns/esm/_lib/startOfUTCWeek/index.js","webpack://VTKViewport/./node_modules/date-fns/esm/_lib/getUTCWeekYear/index.js","webpack://VTKViewport/./node_modules/date-fns/esm/_lib/setUTCDay/index.js","webpack://VTKViewport/./node_modules/date-fns/esm/_lib/startOfUTCISOWeek/index.js","webpack://VTKViewport/./node_modules/date-fns/esm/_lib/getUTCISOWeekYear/index.js","webpack://VTKViewport/./node_modules/date-fns/esm/_lib/getUTCISOWeek/index.js","webpack://VTKViewport/./node_modules/date-fns/esm/_lib/startOfUTCISOWeekYear/index.js","webpack://VTKViewport/./node_modules/date-fns/esm/_lib/getUTCWeek/index.js","webpack://VTKViewport/./node_modules/date-fns/esm/_lib/startOfUTCWeekYear/index.js","webpack://VTKViewport/./node_modules/date-fns/esm/parse/_lib/parsers/index.js","webpack://VTKViewport/./node_modules/date-fns/esm/_lib/setUTCWeek/index.js","webpack://VTKViewport/./node_modules/date-fns/esm/_lib/setUTCISOWeek/index.js","webpack://VTKViewport/./node_modules/date-fns/esm/_lib/setUTCISODay/index.js","webpack://VTKViewport/./node_modules/date-fns/esm/parse/index.js","webpack://VTKViewport/./node_modules/date-fns/esm/_lib/addLeadingZeros/index.js","webpack://VTKViewport/./node_modules/date-fns/esm/_lib/format/lightFormatters/index.js","webpack://VTKViewport/./node_modules/date-fns/esm/_lib/getUTCDayOfYear/index.js","webpack://VTKViewport/./node_modules/date-fns/esm/_lib/format/formatters/index.js","webpack://VTKViewport/./node_modules/date-fns/esm/format/index.js","webpack://VTKViewport/./node_modules/date-fns/esm/isValid/index.js","webpack://VTKViewport/./src/helpers/index.js","webpack://VTKViewport/./src/helpers/formatPN.js","webpack://VTKViewport/./src/helpers/formatDA.js","webpack://VTKViewport/./src/helpers/formatTM.js","webpack://VTKViewport/./src/ViewportOverlay/ViewportOverlay.js","webpack://VTKViewport/./src/lib/createSub.js","webpack://VTKViewport/./src/VTKViewport/setGlobalOpacity.js","webpack://VTKViewport/./src/VTKViewport/createLabelPipeline.js","webpack://VTKViewport/./src/VTKViewport/View2D.js","webpack://VTKViewport/./src/helpers/uuidv4.js","webpack://VTKViewport/./src/lib/math/realsApproximatelyEqual.js","webpack://VTKViewport/./src/VTKViewport/View3D.js","webpack://VTKViewport/./src/lib/windowLevelRangeConverter.js","webpack://VTKViewport/./src/VTKViewport/vtkInteractorStyleMPRWindowLevel.js","webpack://VTKViewport/./src/VTKViewport/vtkInteractorStyleMPRCrosshairs.js","webpack://VTKViewport/./src/VTKViewport/vtkInteractorStyleRotatableMPRCrosshairs.js","webpack://VTKViewport/./src/VTKViewport/vtkInteractorStyleMPRRotate.js","webpack://VTKViewport/./src/VTKViewport/vtkSVGCrosshairsWidget.js","webpack://VTKViewport/./src/helpers/liangBarksyClip.js","webpack://VTKViewport/./src/VTKViewport/vtkSVGRotatableCrosshairsWidget.js","webpack://VTKViewport/./src/lib/data/imageDataCache.js","webpack://VTKViewport/./src/lib/getImageData.js","webpack://VTKViewport/./src/lib/data/buildMetadata.js","webpack://VTKViewport/./src/lib/data/sortDatasetsByImagePosition.js","webpack://VTKViewport/./src/lib/data/getPatientWeightAndCorrectedDose.js","webpack://VTKViewport/./src/lib/loadImageData.js","webpack://VTKViewport/./src/lib/data/insertSlice.js","webpack://VTKViewport/./src/lib/invertVolume.js","webpack://VTKViewport/./src/index.js"],"names":["root","factory","exports","module","require","define","amd","this","__WEBPACK_EXTERNAL_MODULE__1__","__WEBPACK_EXTERNAL_MODULE__3__","__WEBPACK_EXTERNAL_MODULE__5__","__WEBPACK_EXTERNAL_MODULE__6__","__WEBPACK_EXTERNAL_MODULE__8__","__WEBPACK_EXTERNAL_MODULE__9__","__WEBPACK_EXTERNAL_MODULE__10__","__WEBPACK_EXTERNAL_MODULE__17__","__WEBPACK_EXTERNAL_MODULE__18__","__WEBPACK_EXTERNAL_MODULE__19__","__WEBPACK_EXTERNAL_MODULE__20__","__WEBPACK_EXTERNAL_MODULE__21__","__WEBPACK_EXTERNAL_MODULE__22__","__WEBPACK_EXTERNAL_MODULE__23__","__WEBPACK_EXTERNAL_MODULE__25__","__WEBPACK_EXTERNAL_MODULE__26__","__WEBPACK_EXTERNAL_MODULE__27__","__WEBPACK_EXTERNAL_MODULE__28__","__WEBPACK_EXTERNAL_MODULE__29__","__WEBPACK_EXTERNAL_MODULE__30__","__WEBPACK_EXTERNAL_MODULE__31__","__WEBPACK_EXTERNAL_MODULE__32__","__WEBPACK_EXTERNAL_MODULE__33__","__WEBPACK_EXTERNAL_MODULE__34__","__WEBPACK_EXTERNAL_MODULE__35__","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","arrayWithoutHoles","iterableToArray","nonIterableSpread","arr","obj","configurable","writable","arrayWithHoles","iterableToArrayLimit","nonIterableRest","instance","Constructor","TypeError","_defineProperties","target","props","length","descriptor","protoProps","staticProps","_typeof","assertThisInitialized","self","_getPrototypeOf","setPrototypeOf","getPrototypeOf","__proto__","subClass","superClass","constructor","_extends","assign","arguments","source","apply","ReferenceError","Array","isArray","iterator","toString","_arr","_n","_d","_e","undefined","_s","_i","next","done","push","err","arr2","iter","from","_typeof2","_setPrototypeOf","ReactPropTypesSecret","emptyFunction","emptyFunctionWithReset","resetWarningCache","shim","propName","componentName","location","propFullName","secret","Error","getShim","isRequired","ReactPropTypes","array","bool","func","number","string","symbol","any","arrayOf","element","elementType","instanceOf","node","objectOf","oneOf","oneOfType","shape","exact","checkPropTypes","PropTypes","content","options","transform","locals","useSourceMap","list","map","item","cssMapping","btoa","sourceMapping","sourceMap","base64","unescape","encodeURIComponent","JSON","stringify","data","concat","sourceURLs","sources","sourceRoot","join","cssWithMappingToString","mediaQuery","alreadyImportedModules","id","fn","memo","stylesInDom","isOldIE","window","document","all","atob","getTarget","parent","querySelector","getElement","styleTarget","HTMLIFrameElement","contentDocument","head","e","singleton","singletonCounter","stylesInsertedAtTop","fixUrls","addStylesToDom","styles","domStyle","refs","j","parts","addStyle","listToStyles","newStyles","base","part","css","media","insertStyleElement","style","insertInto","lastStyleElementInsertedAtTop","insertAt","nextSibling","insertBefore","appendChild","firstChild","before","removeStyleElement","parentNode","removeChild","idx","indexOf","splice","createStyleElement","createElement","attrs","type","nonce","getNonce","addAttrs","el","keys","forEach","setAttribute","update","remove","result","default","styleIndex","applyToSingletonTag","URL","createObjectURL","revokeObjectURL","Blob","link","rel","createLinkElement","updateLink","href","applyToTag","newObj","DEBUG","newList","mayRemove","textStore","replaceText","index","replacement","filter","Boolean","styleSheet","cssText","cssNode","createTextNode","childNodes","autoFixUrls","convertToAbsoluteUrls","blob","oldSrc","baseUrl","protocol","host","currentDir","pathname","replace","fullMatch","origUrl","newUrl","unquotedOrigUrl","trim","$1","test","EPSILON","ARRAY_TYPE","Float32Array","RANDOM","Math","random","PI","out","clone","a","copy","fromValues","m00","m01","m02","m03","m10","m11","m12","m13","m20","m21","m22","m23","m30","m31","m32","m33","set","identity","transpose","a01","a02","a03","a12","a13","a23","invert","a00","a10","a11","a20","a21","a22","a30","a31","a32","a33","b00","b01","b02","b03","b04","b05","b06","b07","b08","b09","b10","b11","det","adjoint","multiply","b","b0","b1","b2","b3","v","x","y","z","rotate","rad","axis","b12","b20","b21","b22","len","hypot","sin","cos","rotateX","rotateY","rotateZ","fromTranslation","fromScaling","fromRotation","fromXRotation","fromYRotation","fromZRotation","fromRotationTranslation","q","w","x2","y2","z2","xx","xy","xz","yy","yz","zz","wx","wy","wz","fromQuat2","translation","bx","by","bz","bw","ax","ay","az","aw","magnitude","getTranslation","mat","getScaling","getRotation","scaling","is1","is2","is3","sm11","sm12","sm13","sm21","sm22","sm23","sm31","sm32","sm33","trace","S","sqrt","fromRotationTranslationScale","sx","sy","sz","fromRotationTranslationScaleOrigin","ox","oy","oz","out0","out1","out2","out4","out5","out6","out8","out9","out10","fromQuat","yx","zx","zy","frustum","left","right","bottom","top","near","far","rl","tb","nf","perspective","fovy","aspect","f","tan","Infinity","perspectiveFromFieldOfView","fov","upTan","upDegrees","downTan","downDegrees","leftTan","leftDegrees","rightTan","rightDegrees","xScale","yScale","ortho","lr","bt","lookAt","eye","center","up","x0","x1","y0","y1","z0","z1","eyex","eyey","eyez","upx","upy","upz","centerx","centery","centerz","abs","targetTo","str","frob","add","subtract","multiplyScalar","multiplyScalarAndAdd","scale","exactEquals","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","a14","a15","b4","b5","b6","b7","b8","b9","b13","b14","b15","max","mul","sub","divide","ceil","floor","min","round","scaleAndAdd","squaredDistance","squaredLength","negate","inverse","normalize","cross","lerp","hermite","factorTimes2","factor1","factor2","factor3","factor4","bezier","inverseFactor","inverseFactorTimesTwo","zScale","transformMat4","transformMat3","transformQuat","qx","qy","qz","qw","uvx","uvy","uvz","uuvx","uuvy","uuvz","w2","tempA","tempB","cosine","acos","zero","vec","div","sqrDist","sqrLen","stride","offset","count","arg","setAxisAngle","getAxisAngle","out_axis","getAngle","dotproduct","calculateW","exp","et","ln","atan2","log","pow","slerp","omega","cosom","sinom","scale0","scale1","u1","u2","u3","sqrt1MinusU1","sqrtU1","dot","invDot","conjugate","fromMat3","fRoot","fTrace","k","fromEuler","halfToRad","cx","cy","cz","tmpvec3","xUnitVec3","yUnitVec3","temp1","temp2","matr","rotationTo","sqlerp","setAxes","view","transformMat2","transformMat2d","p0","p1","sinC","cosC","len1","len2","degrees2radians","degrees","EVENTS","VIEWPORT_ROTATED","validateNumber","numberValue","Number","isFinite","eventWindow","state","viewUp","sliceNormal","dThetaX","dThetaY","dThetaZ","xAxis","vec3","yAxis","nSliceNormal","nViewUp","planeMat","mat4","zRotQuat","quat","_state","cache","event","CustomEvent","detail","sliceViewUp","bubbles","cancelable","dispatchEvent","_rotate","readOnlyState","parse","freeze","States","Constants","clamp","vtkInteractorStyleMPRSlice","publicAPI","model","classHierarchy","trackballManipulator","vtkMouseCameraTrackballRotateManipulator","newInstance","button","panManipulator","vtkMouseCameraTrackballPanManipulator","zoomManipulator","vtkMouseCameraTrackballZoomManipulator","scrollManipulator","vtkMouseRangeManipulator","scrollEnabled","dragEnabled","sliceRange","sliceCenter","onRotateChanged","setSliceNormalInternal","setViewUpInternal","camera","interactor","getCurrentRenderer","getActiveCamera","setViewUp","normal","_normal","volumeActor","vtkMath","getFocalPoint","dist","getDistance","angle","getViewAngle","isCameraViewInitialized","bounds","getMapper","getBounds","diagonal","distance2BetweenPoints","cameraPos","setPosition","setDistance","setDirectionOfProjection","setViewAngle","setThicknessFromFocalPoint","slabThickness","setCenterOfRotation","updateScrollManipulator","range","getSliceRange","removeScrollListener","setScrollListener","getSlice","scrollToSlice","setViewport","viewportData","getEventWindow","removeEventListener","setViewportData","getCurrentSliceNormal","getCurrentViewUp","addEventListener","getViewport","cameraSub","interactorSub","superSetInteractor","setInteractor","handleButtonPress","callData","apis","apiIndex","startPan","api","svgWidgets","crosshairsWidget","updateCrosshairForApi","rotatableCrosshairsWidget","updateRotatableCrosshairs","thisApi","worldPos","moveCrosshairs","unsubscribe","onModified","modified","onAnimation","getContainer","ViewportData","handleMiddleButtonPress","macro","chain","handleRightButtonPress","superHandleMouseMove","handleMouseMove","handleButtonRelease","superButtonRelease","IS_PAN","endPan","genericRenderWindow","getRenderer","superHandleMiddleButtonRelease","handleMiddleButtonRelease","superHandleRightButtonRelease","handleRightButtonRelease","setVolumeActor","actor","setFreezeFocalPoint","getSliceNormal","vtkMatrixBuilder","buildFromDegree","rotateFromDirections","fp","slice","vtkScrollEvent","uid","getUid","slicePoint","setSlice","onScroll","getOnScroll","renderer","cachedCrosshairWorldPosition","wPos","vtkCoordinate","setCoordinateSystemToWorld","setValue","doubleDisplayPosition","getComputedDoubleDisplayValue","dPos","setCoordinateSystemToDisplay","getComputedWorldValue","directionOfProjection","getDirectionOfProjection","halfSlabThickness","getSlabThickness","clampedSlice","cameraOffset","oldPos","distance","dop","midPoint","zeroPoint","setFocalPoint","points","boundsToCorners","pt","minX","maxX","setSliceNormal","setOrientation","getViewUp","setSliceOrientation","setSlabThickness","setUid","removeAllMouseManipulators","addMouseManipulator","DEFAULT_VALUES","extend","initialValues","vtkInteractorStyleManipulator","setGet","vtkErrorMacro","instanceId","vtkSVGWidgetManager","widgetId","svgRootNode","widgets","setRenderer","getRenderWindow","getInteractor","openGLRenderWindow","getView","setContainer","getReferenceByName","container","getSize","addWidget","svgWidget","render","removeWidget","getWidgetId","widgetNode","requestAnimationFrame","width","height","formatDistanceLocale","lessThanXSeconds","one","other","xSeconds","halfAMinute","lessThanXMinutes","xMinutes","aboutXHours","xHours","xDays","aboutXMonths","xMonths","aboutXYears","xYears","overXYears","almostXYears","buildFormatLongFn","args","dirtyOptions","String","defaultWidth","formats","formatLong","date","full","long","medium","short","time","dateTime","formatRelativeLocale","lastWeek","yesterday","today","tomorrow","nextWeek","buildLocalizeFn","dirtyIndex","valuesArray","context","formattingValues","defaultFormattingWidth","_defaultWidth","_width","values","argumentCallback","buildMatchFn","dirtyString","matchPattern","matchPatterns","defaultMatchWidth","matchResult","match","matchedString","parsePatterns","defaultParseWidth","predicate","findIndex","pattern","findKey","valueCallback","rest","code","formatDistance","token","addSuffix","comparison","formatRelative","_date","_baseDate","_options","localize","ordinalNumber","dirtyNumber","_dirtyOptions","rem100","era","narrow","abbreviated","wide","quarter","month","day","dayPeriod","am","pm","midnight","noon","morning","afternoon","evening","night","parsePattern","parseInt","parseResult","weekStartsOn","firstWeekContainsDate","toInteger","NaN","isNaN","toDate","argument","argStr","Date","getTime","console","warn","stack","subMilliseconds","dirtyDate","dirtyAmount","timestamp","amount","addMilliseconds","dirtyObject","dateLongFormatter","timeLongFormatter","P","dateTimeFormat","datePattern","timePattern","MILLISECONDS_IN_MINUTE","getTimezoneOffsetInMilliseconds","baseTimezoneOffset","getTimezoneOffset","setSeconds","millisecondsPartOfTimezoneOffset","protectedDayOfYearTokens","protectedWeekYearTokens","isProtectedDayOfYearToken","isProtectedWeekYearToken","throwProtectedError","RangeError","startOfUTCWeek","locale","localeWeekStartsOn","defaultWeekStartsOn","getUTCDay","diff","setUTCDate","getUTCDate","setUTCHours","getUTCWeekYear","year","getUTCFullYear","localeFirstWeekContainsDate","defaultFirstWeekContainsDate","firstWeekOfNextYear","setUTCFullYear","startOfNextYear","firstWeekOfThisYear","startOfThisYear","setUTCDay","dirtyDay","startOfUTCISOWeek","getUTCISOWeekYear","fourthOfJanuaryOfNextYear","fourthOfJanuaryOfThisYear","MILLISECONDS_IN_WEEK","getUTCISOWeek","fourthOfJanuary","startOfUTCISOWeekYear","getUTCWeek","firstWeek","startOfUTCWeekYear","MILLISECONDS_IN_HOUR","MILLISECONDS_IN_SECOND","numericPatterns","dayOfYear","week","hour23h","hour24h","hour11h","hour12h","minute","second","singleDigit","twoDigits","threeDigits","fourDigits","anyDigitsSigned","singleDigitSigned","twoDigitsSigned","threeDigitsSigned","fourDigitsSigned","timezonePatterns","parseNumericPattern","parseTimezonePattern","sign","hours","minutes","seconds","parseAnyDigitsSigned","parseNDigits","RegExp","parseNDigitsSigned","dayPeriodEnumToHours","enumValue","normalizeTwoDigitYear","twoDigitYear","currentYear","isCommonEra","absCurrentYear","rangeEnd","DAYS_IN_MONTH","DAYS_IN_MONTH_LEAP_YEAR","isLeapYearIndex","G","priority","flags","incompatibleTokens","isTwoDigitYear","unit","validate","normalizedTwoDigitYear","Y","R","_match","_flags","firstWeekOfYear","u","Q","setUTCMonth","M","L","dirtyWeek","setUTCWeek","I","dirtyISOWeek","isoWeek","setUTCISOWeek","isLeapYear","getUTCMonth","D","E","wholeWeekDays","setUTCISODay","B","h","isPM","getUTCHours","H","K","setUTCMinutes","setUTCSeconds","setUTCMilliseconds","X","timestampIsSet","_token","T","TIMEZONE_UNIT_PRIORITY","formattingTokensRegExp","longFormattingTokensRegExp","escapedStringRegExp","doubleQuoteRegExp","notWhitespaceRegExp","unescapedLatinCharacterRegExp","dirtyDateString","dirtyFormatString","dirtyBackupDate","dateString","formatString","subFnOptions","setters","dateToSystemTimezone","tokens","substring","firstCharacter","longFormatter","usedTokens","useAdditionalWeekYearTokens","useAdditionalDayOfYearTokens","parser","incompatibleToken","usedToken","fullToken","uniquePrioritySetters","setter","sort","reverse","setterArray","utcDate","convertedDate","setFullYear","setHours","getUTCMinutes","getUTCSeconds","getUTCMilliseconds","addLeadingZeros","targetLength","output","signedYear","dayPeriodEnumValue","toUpperCase","numberOfDigits","milliseconds","MILLISECONDS_IN_DAY","dayPeriodEnum","formatTimezoneShort","dirtyDelimiter","absOffset","delimiter","formatTimezoneWithOptionalMinutes","formatTimezone","lightFormatters","signedWeekYear","weekYear","difference","getUTCDayOfYear","dayOfWeek","localDayOfWeek","isoDayOfWeek","_localize","timezoneOffset","_originalDate","O","originalDate","format","dirtyFormatStr","formatStr","isValid","formatterOptions","formatter","helpers","strFormat","parsedDateTime","formatPN","formatDA","formatTM","ViewportOverlay","studyDate","studyTime","studyDescription","patientName","patientId","seriesNumber","seriesDescription","voi","rotation","windowWidth","windowCenter","wwwc","toFixed","rotationString","theta","phi","className","PureComponent","createSub","newSub","setGlobalOpacity","labelmap","colorLUT","opacity","numColors","color","cfun","addRGBPoint","segmentOpacity","ofun","addPointLong","createLabelPipeline","backgroundImageData","paintFilterLabelMapImageData","labelMapData","useSampleDistance","globalOpacity","visible","renderOutline","outlineThickness","vtkImageData","setDimensions","getDimensions","computeTransforms","Uint8Array","getNumberOfPoints","dataArray","vtkDataArray","numberOfComponents","getPointData","setScalars","mapper","vtkVolumeMapper","sampleDistance","getSpacing","reduce","setSampleDistance","labelMap","vtkVolume","vtkColorTransferFunction","vtkPiecewiseFunction","setMapper","setVisibility","getProperty","setRGBTransferFunction","setScalarOpacity","setInterpolationTypeToNearest","setUseLabelOutline","setLabelOutlineThickness","setClamping","setScalarOpacityUnitDistance","setUseGradientOpacity","throttle","cornerstoneTools","importInternal","radiansToDegrees","View2D","getRGBTransferFunction","getMappingRange","widgetManager","vtkWidgetManager","React","createRef","subs","paint","paintStart","paintEnd","interactorStyleSubs","getVOI","volumes","apiProperties","manip","paintWidget","getManipulator","handle","getWidgetState","getHandle","paintRenderer","setNormal","setOrigin","getDirection","crypto","getRandomValues","vtkGenericRenderWindow","background","current","filters","actors","renderWindow","oglrw","getOpenGLRenderWindow","vtkRenderer","addRenderer","setNumberOfLayers","setLayer","setInteractive","buildPass","istyle","setInteractorStyle","updateCameras","baseCamera","paintCamera","position","focalPoint","viewAngle","disablePicking","vtkPaintWidget","setRadius","paintFilter","vtkPaintFilter","setLabel","componentDidUpdate","addVolume","throttledUpdateRotationOverlay","updateRotationOverlay","trailing","orientation","setParallelProjection","resetCamera","updatePaintbrush","svgWidgetManager","setScale","resize","boundUpdateVOI","updateVOI","boundGetOrienation","getOrientation","boundSetOrientation","boundResetOrientation","resetOrientation","boundGetViewUp","boundGetSliceNormal","boundSetInteractorStyle","boundGetSlabThickness","boundSetSlabThickness","boundAddSVGWidget","addSVGWidget","boundGetApiProperty","getApiProperty","boundSetApiProperty","setApiProperty","boundSetSegmentRGB","setSegmentRGB","boundSetSegmentRGBA","setSegmentRGBA","boundSetSegmentAlpha","setSegmentAlpha","boundUpdateImage","updateImage","boundSetSegmentVisibility","setSegmentVisibility","boundSetGlobalOpacity","boundSetVisibility","boundSetOutlineThickness","setOutlineThickness","boundOutlineRendering","setOutlineRendering","boundRequestNewSegmentation","requestNewSegmentation","onCreated","_component","getInteractorStyle","currentIStyle","updateRotationRelativeToOrientation","propertyName","widget","labelmapActor","eps","realsApproximatelyEqual","getVisibility","labelmapRenderingOptions","currentViewport","callbacks","configuration","pop","getVolumeActor","subscription","setState","newNormal","originalSliceNormal","thetaOriginal","phiOriginal","thetaNew","phiNew","thetaRelative","phiRelative","segmentIndex","red","green","blue","alpha","onNewSegmentationRequested","isVisible","prevProps","volume","isA","paintFilterBackgroundImageData","setBackgroundImage","removeVolume","labelmapImageData","segmentsDefaultProperties","properties","segmentNumber","setInputConnection","getOutputPort","setLabelMap","painting","viewWidget","ViewTypes","SLICE","onStartInteractionEvent","startStroke","addPoint","getTrueOrigin","onPaintStart","onInteractionEvent","getPainting","onPaint","onEndInteractionEvent","strokeBufferPromise","endStroke","onPaintEnd","then","strokeBuffer","grabFocus","enablePicking","releaseFocus","onDestroyed","delete","showRotation","ref","dataDetails","Component","View3D","updateLightsGeometryToFollowCamera","addActor","VOLUME","timeEnd","pipeline","toWindowLevel","low","high","wlStartPos","levelScale","pos","IS_WINDOW_LEVEL","windowLevelFromMouse","invokeInteractionEvent","getInputData","getScalars","getRange","imageDynamicRange","multiplier","getLevelScale","dx","dy","levels","setWindowLevel","onLevelsChanged","getOnLevelsChanged","getWindowLevel","lowHigh","lower","upper","toLowHighRange","setMappingRange","superHandleLeftButtonPress","handleLeftButtonPress","shiftKey","controlKey","initialMRange","startWindowLevel","superHandleLeftButtonRelease","handleLeftButtonRelease","endWindowLevel","vtkInteractorStyleMPRWindowLevel","pokedRenderer","vtkInteractorStyleMPRCrosshairs","operations","ROTATE_CROSSHAIRS","MOVE_CROSSHAIRS","MOVE_REFERENCE_LINE","PAN","vtkInteractorStyleRotatableMPRCrosshairs","setOtherApisInactive","lines","getReferenceLines","active","distanceFromLine","line","point","vec2","performOperation","snapToLineIndex","operation","lineIndex","size","getScale","line0toP","line0toline1","magnitudeOfLine","unitVectorAlongLine","distanceAlongLine","newCenterSVG","snapPosToLine","prevPosition","newPosition","getPoint","pointToPreviousPosition","pointToNewPosition","cameraForApi","crosshairPointForApi","initialCrosshairPointForApi","translate","matrix","buildFromRadian","applyTransform","sliceNormalForApi","viewUpForApi","updateCrosshairs","cameraFocalPointForApi","cameraPositionForApi","getPosition","pq","uLength2","newFocalPointForApi","rotateCrosshairs","scrollCrosshairs","direction","lowToHighPoints","otherLineIndex","linePoints","unitVector","lowX","highX","lowY","highY","displayCoordintateScrollIncrement","diagonalWorldLength","worldPosCenter","worldPosOnePixelOver","distanceOfOnePixelInWorld","getDisplayCoordinateScrollIncrement","newCenterPointSVG","shouldUpdate","lineGrabDistance","selectedRotateHandles","selectedLines","centerRadius","getCenterRadius","selectedRotationHandle","rotateHandles","distanceFromFirstLine","distanceFromSecondLine","selected","rotateSelected","handlePassiveMouseMove","lineRotateHandles","selectedLineIndex","selectOpperation","mouseUp","superScrollToSlice","activeLineIndex","disableNormalMPRScroll","rotateStartPos","IS_ROTATE","rotateFromMouse","getViewportSize","xSensitivity","ySensitivity","rotateRelative","startRotate","endRotate","vtkInteractorStyleMPRRotate","vtkSVGCrosshairsWidget","svgContainer","getWidgetNode","strokeColor","strokeWidth","strokeDashArray","padding","getAttribute","display","innerHTML","resetCrosshairs","dims","getViews","error","viewportIndex","mutatedWorldPos","displayPosition","getComputedDisplayValue","setPoint","setGetArray","INSIDE","clipT","num","denom","tE","tL","vtkSVGRotatableCrosshairsWidget","calculateReferenceLines","strokeColors","quarterSmallestDimension","farDistance","referenceLines","crosshairWorldPosition","oldReferenceLines","referenceWorldPointInPlane","doubleSVGPosition","unitVectorFromCenter","distantPoint","negativeDistantPoint","box","da","db","liangBarksyClip","oldReferenceLine","find","refLine","lineSelected","lineActive","firstRotateHandle","secondRotateHandle","referenceLine","setReferenceLines","rotateHandleRadius","selectedStrokeWidth","firstLine","secondLine","firstLineRotateHandles","firstLineRotateSelected","secondLineRotateHandles","secondLineRotateSelected","getSplitReferenceLine","firstLinePart1","firstLinePart2","secondLinePart1","secondLinePart2","firstLineStrokeColor","secondLineStrokeColor","firstLineStrokeWidth","secondLineStrokeWidth","firstLineRotateWidth","secondLineRotateWidth","firstLineRotateHandleRadius","secondLineRotateHandleRadius","firstLineRotateHandleFill","secondLineRotateHandleFill","lineDirection","imageDataCache","Map","iopTolerance","getImageData","imageIds","displaySetInstanceUid","cachedImageDataObject","imageId0","cornerstone","metaData","pixelRepresentation","bitsAllocated","bitsStored","highBit","photometricInterpretation","samplesPerPixel","modality","metaDataMap","imageId","metaData0","imageMetaData0","buildMetadata","rowCosines","columnCosines","rowCosineVec","colCosineVec","scanAxisNormal","orthogonalize3x3","pixelArray","orthogonalizedDirection","imageMetaDataMap","datasets","referenceDataset","distanceDatasetPairs","dataset","positionVector","imagePositionPatient","sortedDatasets","distances","spacing","origin","sortDatasetsByImagePosition","xSpacing","columnPixelSpacing","ySpacing","rowPixelSpacing","zSpacing","xVoxels","columns","yVoxels","rows","zVoxels","signed","scalarArray","imageData","setSpacing","setDirection","imageDataObject","dimensions","loaded","subscriptions","onPixelDataInserted","onPixelDataInsertedError","onAllPixelDataInserted","callback","_publishPixelDataInserted","_publishAllPixelDataInserted","isLoading","_publishPixelDataInsertedError","_fracToDec","fractionalValue","parseFloat","loadImageDataProgressively","modalitySpecificScalingParameters","seriesModule","patientStudyModule","patientWeight","petSequenceModule","radiopharmaceuticalInfo","startTime","radiopharmaceuticalStartTime","totalDose","radionuclideTotalDose","halfLife","radionuclideHalfLife","seriesAcquisitionTime","seriesTime","durationInSeconds","fractionalSeconds","correctedDose","getPatientWeightAndCorrectedDose","getData","NEGATIVE_INFINITY","POSITIVE_INFINITY","numberOfFrames","numberProcessed","reRenderFraction","reRenderTarget","insertPixelData","insertPixelDataErrorHandler","imageLoadPoolManager","requestFn","loadAndCacheImage","addRequest","prefetchImageIds","image","sliceIndex","scalarData","scalingFunction","slope","intercept","pixel","_getScalingFunction","pixels","getPixelData","sliceLength","pixelIndex","destIdx","pixelValue","insertSlice","setRange","rendering","rgbTransferFunction","nodeValue1","getNodeValue","setNodeValue","Function"],"mappings":"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","file":"index.umd.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"vtk.js/Sources/macro\"), require(\"react\"), require(\"vtk.js/Sources/Rendering/Core/Coordinate\"), require(\"vtk.js/Sources/Common/Core/Math\"), require(\"cornerstone-core\"), require(\"vtk.js/Sources/Rendering/Core/InteractorStyle/Constants\"), require(\"vtk.js/Sources/Common/Core/MatrixBuilder\"), require(\"vtk.js/Sources/Rendering/Misc/GenericRenderWindow\"), require(\"vtk.js/Sources/Widgets/Core/WidgetManager\"), require(\"vtk.js/Sources/Filters/General/PaintFilter\"), require(\"vtk.js/Sources/Widgets/Widgets3D/PaintWidget\"), require(\"vtk.js/Sources/Widgets/Core/WidgetManager/Constants\"), require(\"vtk.js/Sources/Common/DataModel/ImageData\"), require(\"vtk.js/Sources/Common/Core/DataArray\"), require(\"cornerstone-tools\"), require(\"vtk.js/Sources/Rendering/Core/Renderer\"), require(\"vtk.js/Sources/Interaction/Style/InteractorStyleManipulator\"), require(\"vtk.js/Sources/Interaction/Manipulators/MouseCameraTrackballRotateManipulator\"), require(\"vtk.js/Sources/Interaction/Manipulators/MouseCameraTrackballPanManipulator\"), require(\"vtk.js/Sources/Interaction/Manipulators/MouseCameraTrackballZoomManipulator\"), require(\"vtk.js/Sources/Interaction/Manipulators/MouseRangeManipulator\"), require(\"vtk.js/Sources/Rendering/Core/Volume\"), require(\"vtk.js/Sources/Rendering/Core/VolumeMapper\"), require(\"vtk.js/Sources/Rendering/Core/ColorTransferFunction\"), require(\"vtk.js/Sources/Common/DataModel/PiecewiseFunction\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"vtk.js/Sources/macro\", \"react\", \"vtk.js/Sources/Rendering/Core/Coordinate\", \"vtk.js/Sources/Common/Core/Math\", \"cornerstone-core\", \"vtk.js/Sources/Rendering/Core/InteractorStyle/Constants\", \"vtk.js/Sources/Common/Core/MatrixBuilder\", \"vtk.js/Sources/Rendering/Misc/GenericRenderWindow\", \"vtk.js/Sources/Widgets/Core/WidgetManager\", \"vtk.js/Sources/Filters/General/PaintFilter\", \"vtk.js/Sources/Widgets/Widgets3D/PaintWidget\", \"vtk.js/Sources/Widgets/Core/WidgetManager/Constants\", \"vtk.js/Sources/Common/DataModel/ImageData\", \"vtk.js/Sources/Common/Core/DataArray\", \"cornerstone-tools\", \"vtk.js/Sources/Rendering/Core/Renderer\", \"vtk.js/Sources/Interaction/Style/InteractorStyleManipulator\", \"vtk.js/Sources/Interaction/Manipulators/MouseCameraTrackballRotateManipulator\", \"vtk.js/Sources/Interaction/Manipulators/MouseCameraTrackballPanManipulator\", \"vtk.js/Sources/Interaction/Manipulators/MouseCameraTrackballZoomManipulator\", \"vtk.js/Sources/Interaction/Manipulators/MouseRangeManipulator\", \"vtk.js/Sources/Rendering/Core/Volume\", \"vtk.js/Sources/Rendering/Core/VolumeMapper\", \"vtk.js/Sources/Rendering/Core/ColorTransferFunction\", \"vtk.js/Sources/Common/DataModel/PiecewiseFunction\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"VTKViewport\"] = factory(require(\"vtk.js/Sources/macro\"), require(\"react\"), require(\"vtk.js/Sources/Rendering/Core/Coordinate\"), require(\"vtk.js/Sources/Common/Core/Math\"), require(\"cornerstone-core\"), require(\"vtk.js/Sources/Rendering/Core/InteractorStyle/Constants\"), require(\"vtk.js/Sources/Common/Core/MatrixBuilder\"), require(\"vtk.js/Sources/Rendering/Misc/GenericRenderWindow\"), require(\"vtk.js/Sources/Widgets/Core/WidgetManager\"), require(\"vtk.js/Sources/Filters/General/PaintFilter\"), require(\"vtk.js/Sources/Widgets/Widgets3D/PaintWidget\"), require(\"vtk.js/Sources/Widgets/Core/WidgetManager/Constants\"), require(\"vtk.js/Sources/Common/DataModel/ImageData\"), require(\"vtk.js/Sources/Common/Core/DataArray\"), require(\"cornerstone-tools\"), require(\"vtk.js/Sources/Rendering/Core/Renderer\"), require(\"vtk.js/Sources/Interaction/Style/InteractorStyleManipulator\"), require(\"vtk.js/Sources/Interaction/Manipulators/MouseCameraTrackballRotateManipulator\"), require(\"vtk.js/Sources/Interaction/Manipulators/MouseCameraTrackballPanManipulator\"), require(\"vtk.js/Sources/Interaction/Manipulators/MouseCameraTrackballZoomManipulator\"), require(\"vtk.js/Sources/Interaction/Manipulators/MouseRangeManipulator\"), require(\"vtk.js/Sources/Rendering/Core/Volume\"), require(\"vtk.js/Sources/Rendering/Core/VolumeMapper\"), require(\"vtk.js/Sources/Rendering/Core/ColorTransferFunction\"), require(\"vtk.js/Sources/Common/DataModel/PiecewiseFunction\"));\n\telse\n\t\troot[\"VTKViewport\"] = factory(root[\"vtk.js/Sources/macro\"], root[\"react\"], root[\"vtk.js/Sources/Rendering/Core/Coordinate\"], root[\"vtk.js/Sources/Common/Core/Math\"], root[\"cornerstone\"], root[\"vtk.js/Sources/Rendering/Core/InteractorStyle/Constants\"], root[\"vtk.js/Sources/Common/Core/MatrixBuilder\"], root[\"vtk.js/Sources/Rendering/Misc/GenericRenderWindow\"], root[\"vtk.js/Sources/Widgets/Core/WidgetManager\"], root[\"vtk.js/Sources/Filters/General/PaintFilter\"], root[\"vtk.js/Sources/Widgets/Widgets3D/PaintWidget\"], root[\"vtk.js/Sources/Widgets/Core/WidgetManager/Constants\"], root[\"vtk.js/Sources/Common/DataModel/ImageData\"], root[\"vtk.js/Sources/Common/Core/DataArray\"], root[\"cornerstoneTools\"], root[\"vtk.js/Sources/Rendering/Core/Renderer\"], root[\"vtk.js/Sources/Interaction/Style/InteractorStyleManipulator\"], root[\"vtk.js/Sources/Interaction/Manipulators/MouseCameraTrackballRotateManipulator\"], root[\"vtk.js/Sources/Interaction/Manipulators/MouseCameraTrackballPanManipulator\"], root[\"vtk.js/Sources/Interaction/Manipulators/MouseCameraTrackballZoomManipulator\"], root[\"vtk.js/Sources/Interaction/Manipulators/MouseRangeManipulator\"], root[\"vtk.js/Sources/Rendering/Core/Volume\"], root[\"vtk.js/Sources/Rendering/Core/VolumeMapper\"], root[\"vtk.js/Sources/Rendering/Core/ColorTransferFunction\"], root[\"vtk.js/Sources/Common/DataModel/PiecewiseFunction\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE__1__, __WEBPACK_EXTERNAL_MODULE__3__, __WEBPACK_EXTERNAL_MODULE__5__, __WEBPACK_EXTERNAL_MODULE__6__, __WEBPACK_EXTERNAL_MODULE__8__, __WEBPACK_EXTERNAL_MODULE__9__, __WEBPACK_EXTERNAL_MODULE__10__, __WEBPACK_EXTERNAL_MODULE__17__, __WEBPACK_EXTERNAL_MODULE__18__, __WEBPACK_EXTERNAL_MODULE__19__, __WEBPACK_EXTERNAL_MODULE__20__, __WEBPACK_EXTERNAL_MODULE__21__, __WEBPACK_EXTERNAL_MODULE__22__, __WEBPACK_EXTERNAL_MODULE__23__, __WEBPACK_EXTERNAL_MODULE__25__, __WEBPACK_EXTERNAL_MODULE__26__, __WEBPACK_EXTERNAL_MODULE__27__, __WEBPACK_EXTERNAL_MODULE__28__, __WEBPACK_EXTERNAL_MODULE__29__, __WEBPACK_EXTERNAL_MODULE__30__, __WEBPACK_EXTERNAL_MODULE__31__, __WEBPACK_EXTERNAL_MODULE__32__, __WEBPACK_EXTERNAL_MODULE__33__, __WEBPACK_EXTERNAL_MODULE__34__, __WEBPACK_EXTERNAL_MODULE__35__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 55);\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nif (process.env.NODE_ENV !== 'production') {\n  var ReactIs = require('react-is');\n\n  // By explicitly using `prop-types` you are opting into new development behavior.\n  // http://fb.me/prop-types-in-prod\n  var throwOnDirectAccess = true;\n  module.exports = require('./factoryWithTypeCheckers')(ReactIs.isElement, throwOnDirectAccess);\n} else {\n  // By explicitly using `prop-types` you are opting into new production behavior.\n  // http://fb.me/prop-types-in-prod\n  module.exports = require('./factoryWithThrowingShims')();\n}\n","module.exports = __WEBPACK_EXTERNAL_MODULE__1__;","var arrayWithoutHoles = require(\"./arrayWithoutHoles\");\n\nvar iterableToArray = require(\"./iterableToArray\");\n\nvar nonIterableSpread = require(\"./nonIterableSpread\");\n\nfunction _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || nonIterableSpread();\n}\n\nmodule.exports = _toConsumableArray;","module.exports = __WEBPACK_EXTERNAL_MODULE__3__;","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","module.exports = __WEBPACK_EXTERNAL_MODULE__5__;","module.exports = __WEBPACK_EXTERNAL_MODULE__6__;","var arrayWithHoles = require(\"./arrayWithHoles\");\n\nvar iterableToArrayLimit = require(\"./iterableToArrayLimit\");\n\nvar nonIterableRest = require(\"./nonIterableRest\");\n\nfunction _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || nonIterableRest();\n}\n\nmodule.exports = _slicedToArray;","module.exports = __WEBPACK_EXTERNAL_MODULE__8__;","module.exports = __WEBPACK_EXTERNAL_MODULE__9__;","module.exports = __WEBPACK_EXTERNAL_MODULE__10__;","function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;","var _typeof = require(\"../helpers/typeof\");\n\nvar assertThisInitialized = require(\"./assertThisInitialized\");\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return assertThisInitialized(self);\n}\n\nmodule.exports = _possibleConstructorReturn;","function _getPrototypeOf(o) {\n  module.exports = _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nmodule.exports = _getPrototypeOf;","var setPrototypeOf = require(\"./setPrototypeOf\");\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}\n\nmodule.exports = _inherits;","function _extends() {\n  module.exports = _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nmodule.exports = _extends;","module.exports = __WEBPACK_EXTERNAL_MODULE__17__;","module.exports = __WEBPACK_EXTERNAL_MODULE__18__;","module.exports = __WEBPACK_EXTERNAL_MODULE__19__;","module.exports = __WEBPACK_EXTERNAL_MODULE__20__;","module.exports = __WEBPACK_EXTERNAL_MODULE__21__;","module.exports = __WEBPACK_EXTERNAL_MODULE__22__;","module.exports = __WEBPACK_EXTERNAL_MODULE__23__;","function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nmodule.exports = _assertThisInitialized;","module.exports = __WEBPACK_EXTERNAL_MODULE__25__;","module.exports = __WEBPACK_EXTERNAL_MODULE__26__;","module.exports = __WEBPACK_EXTERNAL_MODULE__27__;","module.exports = __WEBPACK_EXTERNAL_MODULE__28__;","module.exports = __WEBPACK_EXTERNAL_MODULE__29__;","module.exports = __WEBPACK_EXTERNAL_MODULE__30__;","module.exports = __WEBPACK_EXTERNAL_MODULE__31__;","module.exports = __WEBPACK_EXTERNAL_MODULE__32__;","module.exports = __WEBPACK_EXTERNAL_MODULE__33__;","module.exports = __WEBPACK_EXTERNAL_MODULE__34__;","module.exports = __WEBPACK_EXTERNAL_MODULE__35__;","function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nmodule.exports = _arrayWithHoles;","function _iterableToArrayLimit(arr, i) {\n  if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === \"[object Arguments]\")) {\n    return;\n  }\n\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nmodule.exports = _iterableToArrayLimit;","function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n}\n\nmodule.exports = _nonIterableRest;","function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  }\n}\n\nmodule.exports = _arrayWithoutHoles;","function _iterableToArray(iter) {\n  if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter);\n}\n\nmodule.exports = _iterableToArray;","function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n}\n\nmodule.exports = _nonIterableSpread;","function _typeof2(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof2 = function _typeof2(obj) { return typeof obj; }; } else { _typeof2 = function _typeof2(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof2(obj); }\n\nfunction _typeof(obj) {\n  if (typeof Symbol === \"function\" && _typeof2(Symbol.iterator) === \"symbol\") {\n    module.exports = _typeof = function _typeof(obj) {\n      return _typeof2(obj);\n    };\n  } else {\n    module.exports = _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : _typeof2(obj);\n    };\n  }\n\n  return _typeof(obj);\n}\n\nmodule.exports = _typeof;","function _setPrototypeOf(o, p) {\n  module.exports = _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}\n\nmodule.exports = _setPrototypeOf;","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactPropTypesSecret = require('./lib/ReactPropTypesSecret');\n\nfunction emptyFunction() {}\nfunction emptyFunctionWithReset() {}\nemptyFunctionWithReset.resetWarningCache = emptyFunction;\n\nmodule.exports = function() {\n  function shim(props, propName, componentName, location, propFullName, secret) {\n    if (secret === ReactPropTypesSecret) {\n      // It is still safe when called from React.\n      return;\n    }\n    var err = new Error(\n      'Calling PropTypes validators directly is not supported by the `prop-types` package. ' +\n      'Use PropTypes.checkPropTypes() to call them. ' +\n      'Read more at http://fb.me/use-check-prop-types'\n    );\n    err.name = 'Invariant Violation';\n    throw err;\n  };\n  shim.isRequired = shim;\n  function getShim() {\n    return shim;\n  };\n  // Important!\n  // Keep this list in sync with production version in `./factoryWithTypeCheckers.js`.\n  var ReactPropTypes = {\n    array: shim,\n    bool: shim,\n    func: shim,\n    number: shim,\n    object: shim,\n    string: shim,\n    symbol: shim,\n\n    any: shim,\n    arrayOf: getShim,\n    element: shim,\n    elementType: shim,\n    instanceOf: getShim,\n    node: shim,\n    objectOf: getShim,\n    oneOf: getShim,\n    oneOfType: getShim,\n    shape: getShim,\n    exact: getShim,\n\n    checkPropTypes: emptyFunctionWithReset,\n    resetWarningCache: emptyFunction\n  };\n\n  ReactPropTypes.PropTypes = ReactPropTypes;\n\n  return ReactPropTypes;\n};\n","/**\n * Copyright (c) 2013-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n'use strict';\n\nvar ReactPropTypesSecret = 'SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED';\n\nmodule.exports = ReactPropTypesSecret;\n","\nvar content = require(\"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/postcss-loader/src/index.js??ref--5-2!./ViewportOverlay.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/postcss-loader/src/index.js??ref--5-2!./ViewportOverlay.css\", function() {\n\t\tvar newContent = require(\"!!../../node_modules/css-loader/dist/cjs.js!../../node_modules/postcss-loader/src/index.js??ref--5-2!./ViewportOverlay.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \":root {\\n  --viewport-tag-padding: 20px;\\n}\\n\\n.ViewportOverlay {\\n  color: #9ccef9;\\n}\\n\\n.ViewportOverlay .overlay-element {\\n  position: absolute;\\n  font-weight: 400;\\n  text-shadow: 1px 1px black;\\n  pointer-events: none;\\n}\\n\\n.ViewportOverlay .top-left {\\n  top: var(--viewport-tag-padding);\\n  left: var(--viewport-tag-padding);\\n}\\n\\n.ViewportOverlay .top-center {\\n  top: var(--viewport-tag-padding);\\n  padding-top: var(--viewport-tag-padding);\\n  width: 100%;\\n  text-align: center;\\n}\\n\\n.ViewportOverlay .top-right {\\n  top: var(--viewport-tag-padding);\\n  right: var(--viewport-tag-padding);\\n  text-align: right;\\n}\\n\\n.ViewportOverlay .bottom-left {\\n  bottom: var(--viewport-tag-padding);\\n  left: var(--viewport-tag-padding);\\n}\\n\\n.ViewportOverlay .bottom-right {\\n  bottom: var(--viewport-tag-padding);\\n  right: var(--viewport-tag-padding);\\n  text-align: right;\\n}\\n\\n.ViewportOverlay svg {\\n  color: #9ccef9;\\n  fill: #9ccef9;\\n  stroke: #9ccef9;\\n  background-color: transparent;\\n  margin: 2px;\\n  width: 18px;\\n  height: 18px;\\n}\\n\", \"\"]);\n","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\n// eslint-disable-next-line func-names\nmodule.exports = function (useSourceMap) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = cssWithMappingToString(item, useSourceMap);\n\n      if (item[2]) {\n        return \"@media \".concat(item[2], \"{\").concat(content, \"}\");\n      }\n\n      return content;\n    }).join('');\n  }; // import a list of modules into the list\n  // eslint-disable-next-line func-names\n\n\n  list.i = function (modules, mediaQuery) {\n    if (typeof modules === 'string') {\n      // eslint-disable-next-line no-param-reassign\n      modules = [[null, modules, '']];\n    }\n\n    var alreadyImportedModules = {};\n\n    for (var i = 0; i < this.length; i++) {\n      // eslint-disable-next-line prefer-destructuring\n      var id = this[i][0];\n\n      if (id != null) {\n        alreadyImportedModules[id] = true;\n      }\n    }\n\n    for (var _i = 0; _i < modules.length; _i++) {\n      var item = modules[_i]; // skip already imported module\n      // this implementation is not 100% perfect for weird media query combinations\n      // when a module is imported multiple times with different media queries.\n      // I hope this will never occur (Hey this way we have smaller bundles)\n\n      if (item[0] == null || !alreadyImportedModules[item[0]]) {\n        if (mediaQuery && !item[2]) {\n          item[2] = mediaQuery;\n        } else if (mediaQuery) {\n          item[2] = \"(\".concat(item[2], \") and (\").concat(mediaQuery, \")\");\n        }\n\n        list.push(item);\n      }\n    }\n  };\n\n  return list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n  var content = item[1] || ''; // eslint-disable-next-line prefer-destructuring\n\n  var cssMapping = item[3];\n\n  if (!cssMapping) {\n    return content;\n  }\n\n  if (useSourceMap && typeof btoa === 'function') {\n    var sourceMapping = toComment(cssMapping);\n    var sourceURLs = cssMapping.sources.map(function (source) {\n      return \"/*# sourceURL=\".concat(cssMapping.sourceRoot).concat(source, \" */\");\n    });\n    return [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n  }\n\n  return [content].join('\\n');\n} // Adapted from convert-source-map (MIT)\n\n\nfunction toComment(sourceMap) {\n  // eslint-disable-next-line no-undef\n  var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n  var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n  return \"/*# \".concat(data, \" */\");\n}","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\nvar stylesInDom = {};\n\nvar\tmemoize = function (fn) {\n\tvar memo;\n\n\treturn function () {\n\t\tif (typeof memo === \"undefined\") memo = fn.apply(this, arguments);\n\t\treturn memo;\n\t};\n};\n\nvar isOldIE = memoize(function () {\n\t// Test for IE <= 9 as proposed by Browserhacks\n\t// @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n\t// Tests for existence of standard globals is to allow style-loader\n\t// to operate correctly into non-standard environments\n\t// @see https://github.com/webpack-contrib/style-loader/issues/177\n\treturn window && document && document.all && !window.atob;\n});\n\nvar getTarget = function (target, parent) {\n  if (parent){\n    return parent.querySelector(target);\n  }\n  return document.querySelector(target);\n};\n\nvar getElement = (function (fn) {\n\tvar memo = {};\n\n\treturn function(target, parent) {\n                // If passing function in options, then use it for resolve \"head\" element.\n                // Useful for Shadow Root style i.e\n                // {\n                //   insertInto: function () { return document.querySelector(\"#foo\").shadowRoot }\n                // }\n                if (typeof target === 'function') {\n                        return target();\n                }\n                if (typeof memo[target] === \"undefined\") {\n\t\t\tvar styleTarget = getTarget.call(this, target, parent);\n\t\t\t// Special case to return head of iframe instead of iframe itself\n\t\t\tif (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n\t\t\t\ttry {\n\t\t\t\t\t// This will throw an exception if access to iframe is blocked\n\t\t\t\t\t// due to cross-origin restrictions\n\t\t\t\t\tstyleTarget = styleTarget.contentDocument.head;\n\t\t\t\t} catch(e) {\n\t\t\t\t\tstyleTarget = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\tmemo[target] = styleTarget;\n\t\t}\n\t\treturn memo[target]\n\t};\n})();\n\nvar singleton = null;\nvar\tsingletonCounter = 0;\nvar\tstylesInsertedAtTop = [];\n\nvar\tfixUrls = require(\"./urls\");\n\nmodule.exports = function(list, options) {\n\tif (typeof DEBUG !== \"undefined\" && DEBUG) {\n\t\tif (typeof document !== \"object\") throw new Error(\"The style-loader cannot be used in a non-browser environment\");\n\t}\n\n\toptions = options || {};\n\n\toptions.attrs = typeof options.attrs === \"object\" ? options.attrs : {};\n\n\t// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n\t// tags it will allow on a page\n\tif (!options.singleton && typeof options.singleton !== \"boolean\") options.singleton = isOldIE();\n\n\t// By default, add <style> tags to the <head> element\n        if (!options.insertInto) options.insertInto = \"head\";\n\n\t// By default, add <style> tags to the bottom of the target\n\tif (!options.insertAt) options.insertAt = \"bottom\";\n\n\tvar styles = listToStyles(list, options);\n\n\taddStylesToDom(styles, options);\n\n\treturn function update (newList) {\n\t\tvar mayRemove = [];\n\n\t\tfor (var i = 0; i < styles.length; i++) {\n\t\t\tvar item = styles[i];\n\t\t\tvar domStyle = stylesInDom[item.id];\n\n\t\t\tdomStyle.refs--;\n\t\t\tmayRemove.push(domStyle);\n\t\t}\n\n\t\tif(newList) {\n\t\t\tvar newStyles = listToStyles(newList, options);\n\t\t\taddStylesToDom(newStyles, options);\n\t\t}\n\n\t\tfor (var i = 0; i < mayRemove.length; i++) {\n\t\t\tvar domStyle = mayRemove[i];\n\n\t\t\tif(domStyle.refs === 0) {\n\t\t\t\tfor (var j = 0; j < domStyle.parts.length; j++) domStyle.parts[j]();\n\n\t\t\t\tdelete stylesInDom[domStyle.id];\n\t\t\t}\n\t\t}\n\t};\n};\n\nfunction addStylesToDom (styles, options) {\n\tfor (var i = 0; i < styles.length; i++) {\n\t\tvar item = styles[i];\n\t\tvar domStyle = stylesInDom[item.id];\n\n\t\tif(domStyle) {\n\t\t\tdomStyle.refs++;\n\n\t\t\tfor(var j = 0; j < domStyle.parts.length; j++) {\n\t\t\t\tdomStyle.parts[j](item.parts[j]);\n\t\t\t}\n\n\t\t\tfor(; j < item.parts.length; j++) {\n\t\t\t\tdomStyle.parts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\t\t} else {\n\t\t\tvar parts = [];\n\n\t\t\tfor(var j = 0; j < item.parts.length; j++) {\n\t\t\t\tparts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\n\t\t\tstylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};\n\t\t}\n\t}\n}\n\nfunction listToStyles (list, options) {\n\tvar styles = [];\n\tvar newStyles = {};\n\n\tfor (var i = 0; i < list.length; i++) {\n\t\tvar item = list[i];\n\t\tvar id = options.base ? item[0] + options.base : item[0];\n\t\tvar css = item[1];\n\t\tvar media = item[2];\n\t\tvar sourceMap = item[3];\n\t\tvar part = {css: css, media: media, sourceMap: sourceMap};\n\n\t\tif(!newStyles[id]) styles.push(newStyles[id] = {id: id, parts: [part]});\n\t\telse newStyles[id].parts.push(part);\n\t}\n\n\treturn styles;\n}\n\nfunction insertStyleElement (options, style) {\n\tvar target = getElement(options.insertInto)\n\n\tif (!target) {\n\t\tthrow new Error(\"Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.\");\n\t}\n\n\tvar lastStyleElementInsertedAtTop = stylesInsertedAtTop[stylesInsertedAtTop.length - 1];\n\n\tif (options.insertAt === \"top\") {\n\t\tif (!lastStyleElementInsertedAtTop) {\n\t\t\ttarget.insertBefore(style, target.firstChild);\n\t\t} else if (lastStyleElementInsertedAtTop.nextSibling) {\n\t\t\ttarget.insertBefore(style, lastStyleElementInsertedAtTop.nextSibling);\n\t\t} else {\n\t\t\ttarget.appendChild(style);\n\t\t}\n\t\tstylesInsertedAtTop.push(style);\n\t} else if (options.insertAt === \"bottom\") {\n\t\ttarget.appendChild(style);\n\t} else if (typeof options.insertAt === \"object\" && options.insertAt.before) {\n\t\tvar nextSibling = getElement(options.insertAt.before, target);\n\t\ttarget.insertBefore(style, nextSibling);\n\t} else {\n\t\tthrow new Error(\"[Style Loader]\\n\\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\\n Must be 'top', 'bottom', or Object.\\n (https://github.com/webpack-contrib/style-loader#insertat)\\n\");\n\t}\n}\n\nfunction removeStyleElement (style) {\n\tif (style.parentNode === null) return false;\n\tstyle.parentNode.removeChild(style);\n\n\tvar idx = stylesInsertedAtTop.indexOf(style);\n\tif(idx >= 0) {\n\t\tstylesInsertedAtTop.splice(idx, 1);\n\t}\n}\n\nfunction createStyleElement (options) {\n\tvar style = document.createElement(\"style\");\n\n\tif(options.attrs.type === undefined) {\n\t\toptions.attrs.type = \"text/css\";\n\t}\n\n\tif(options.attrs.nonce === undefined) {\n\t\tvar nonce = getNonce();\n\t\tif (nonce) {\n\t\t\toptions.attrs.nonce = nonce;\n\t\t}\n\t}\n\n\taddAttrs(style, options.attrs);\n\tinsertStyleElement(options, style);\n\n\treturn style;\n}\n\nfunction createLinkElement (options) {\n\tvar link = document.createElement(\"link\");\n\n\tif(options.attrs.type === undefined) {\n\t\toptions.attrs.type = \"text/css\";\n\t}\n\toptions.attrs.rel = \"stylesheet\";\n\n\taddAttrs(link, options.attrs);\n\tinsertStyleElement(options, link);\n\n\treturn link;\n}\n\nfunction addAttrs (el, attrs) {\n\tObject.keys(attrs).forEach(function (key) {\n\t\tel.setAttribute(key, attrs[key]);\n\t});\n}\n\nfunction getNonce() {\n\tif (typeof __webpack_nonce__ === 'undefined') {\n\t\treturn null;\n\t}\n\n\treturn __webpack_nonce__;\n}\n\nfunction addStyle (obj, options) {\n\tvar style, update, remove, result;\n\n\t// If a transform function was defined, run it on the css\n\tif (options.transform && obj.css) {\n\t    result = typeof options.transform === 'function'\n\t\t ? options.transform(obj.css) \n\t\t : options.transform.default(obj.css);\n\n\t    if (result) {\n\t    \t// If transform returns a value, use that instead of the original css.\n\t    \t// This allows running runtime transformations on the css.\n\t    \tobj.css = result;\n\t    } else {\n\t    \t// If the transform function returns a falsy value, don't add this css.\n\t    \t// This allows conditional loading of css\n\t    \treturn function() {\n\t    \t\t// noop\n\t    \t};\n\t    }\n\t}\n\n\tif (options.singleton) {\n\t\tvar styleIndex = singletonCounter++;\n\n\t\tstyle = singleton || (singleton = createStyleElement(options));\n\n\t\tupdate = applyToSingletonTag.bind(null, style, styleIndex, false);\n\t\tremove = applyToSingletonTag.bind(null, style, styleIndex, true);\n\n\t} else if (\n\t\tobj.sourceMap &&\n\t\ttypeof URL === \"function\" &&\n\t\ttypeof URL.createObjectURL === \"function\" &&\n\t\ttypeof URL.revokeObjectURL === \"function\" &&\n\t\ttypeof Blob === \"function\" &&\n\t\ttypeof btoa === \"function\"\n\t) {\n\t\tstyle = createLinkElement(options);\n\t\tupdate = updateLink.bind(null, style, options);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\n\t\t\tif(style.href) URL.revokeObjectURL(style.href);\n\t\t};\n\t} else {\n\t\tstyle = createStyleElement(options);\n\t\tupdate = applyToTag.bind(null, style);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\t\t};\n\t}\n\n\tupdate(obj);\n\n\treturn function updateStyle (newObj) {\n\t\tif (newObj) {\n\t\t\tif (\n\t\t\t\tnewObj.css === obj.css &&\n\t\t\t\tnewObj.media === obj.media &&\n\t\t\t\tnewObj.sourceMap === obj.sourceMap\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tupdate(obj = newObj);\n\t\t} else {\n\t\t\tremove();\n\t\t}\n\t};\n}\n\nvar replaceText = (function () {\n\tvar textStore = [];\n\n\treturn function (index, replacement) {\n\t\ttextStore[index] = replacement;\n\n\t\treturn textStore.filter(Boolean).join('\\n');\n\t};\n})();\n\nfunction applyToSingletonTag (style, index, remove, obj) {\n\tvar css = remove ? \"\" : obj.css;\n\n\tif (style.styleSheet) {\n\t\tstyle.styleSheet.cssText = replaceText(index, css);\n\t} else {\n\t\tvar cssNode = document.createTextNode(css);\n\t\tvar childNodes = style.childNodes;\n\n\t\tif (childNodes[index]) style.removeChild(childNodes[index]);\n\n\t\tif (childNodes.length) {\n\t\t\tstyle.insertBefore(cssNode, childNodes[index]);\n\t\t} else {\n\t\t\tstyle.appendChild(cssNode);\n\t\t}\n\t}\n}\n\nfunction applyToTag (style, obj) {\n\tvar css = obj.css;\n\tvar media = obj.media;\n\n\tif(media) {\n\t\tstyle.setAttribute(\"media\", media)\n\t}\n\n\tif(style.styleSheet) {\n\t\tstyle.styleSheet.cssText = css;\n\t} else {\n\t\twhile(style.firstChild) {\n\t\t\tstyle.removeChild(style.firstChild);\n\t\t}\n\n\t\tstyle.appendChild(document.createTextNode(css));\n\t}\n}\n\nfunction updateLink (link, options, obj) {\n\tvar css = obj.css;\n\tvar sourceMap = obj.sourceMap;\n\n\t/*\n\t\tIf convertToAbsoluteUrls isn't defined, but sourcemaps are enabled\n\t\tand there is no publicPath defined then lets turn convertToAbsoluteUrls\n\t\ton by default.  Otherwise default to the convertToAbsoluteUrls option\n\t\tdirectly\n\t*/\n\tvar autoFixUrls = options.convertToAbsoluteUrls === undefined && sourceMap;\n\n\tif (options.convertToAbsoluteUrls || autoFixUrls) {\n\t\tcss = fixUrls(css);\n\t}\n\n\tif (sourceMap) {\n\t\t// http://stackoverflow.com/a/26603875\n\t\tcss += \"\\n/*# sourceMappingURL=data:application/json;base64,\" + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + \" */\";\n\t}\n\n\tvar blob = new Blob([css], { type: \"text/css\" });\n\n\tvar oldSrc = link.href;\n\n\tlink.href = URL.createObjectURL(blob);\n\n\tif(oldSrc) URL.revokeObjectURL(oldSrc);\n}\n","\n/**\n * When source maps are enabled, `style-loader` uses a link element with a data-uri to\n * embed the css on the page. This breaks all relative urls because now they are relative to a\n * bundle instead of the current page.\n *\n * One solution is to only use full urls, but that may be impossible.\n *\n * Instead, this function \"fixes\" the relative urls to be absolute according to the current page location.\n *\n * A rudimentary test suite is located at `test/fixUrls.js` and can be run via the `npm test` command.\n *\n */\n\nmodule.exports = function (css) {\n  // get current location\n  var location = typeof window !== \"undefined\" && window.location;\n\n  if (!location) {\n    throw new Error(\"fixUrls requires window.location\");\n  }\n\n\t// blank or null?\n\tif (!css || typeof css !== \"string\") {\n\t  return css;\n  }\n\n  var baseUrl = location.protocol + \"//\" + location.host;\n  var currentDir = baseUrl + location.pathname.replace(/\\/[^\\/]*$/, \"/\");\n\n\t// convert each url(...)\n\t/*\n\tThis regular expression is just a way to recursively match brackets within\n\ta string.\n\n\t /url\\s*\\(  = Match on the word \"url\" with any whitespace after it and then a parens\n\t   (  = Start a capturing group\n\t     (?:  = Start a non-capturing group\n\t         [^)(]  = Match anything that isn't a parentheses\n\t         |  = OR\n\t         \\(  = Match a start parentheses\n\t             (?:  = Start another non-capturing groups\n\t                 [^)(]+  = Match anything that isn't a parentheses\n\t                 |  = OR\n\t                 \\(  = Match a start parentheses\n\t                     [^)(]*  = Match anything that isn't a parentheses\n\t                 \\)  = Match a end parentheses\n\t             )  = End Group\n              *\\) = Match anything and then a close parens\n          )  = Close non-capturing group\n          *  = Match anything\n       )  = Close capturing group\n\t \\)  = Match a close parens\n\n\t /gi  = Get all matches, not the first.  Be case insensitive.\n\t */\n\tvar fixedCss = css.replace(/url\\s*\\(((?:[^)(]|\\((?:[^)(]+|\\([^)(]*\\))*\\))*)\\)/gi, function(fullMatch, origUrl) {\n\t\t// strip quotes (if they exist)\n\t\tvar unquotedOrigUrl = origUrl\n\t\t\t.trim()\n\t\t\t.replace(/^\"(.*)\"$/, function(o, $1){ return $1; })\n\t\t\t.replace(/^'(.*)'$/, function(o, $1){ return $1; });\n\n\t\t// already a full url? no change\n\t\tif (/^(#|data:|http:\\/\\/|https:\\/\\/|file:\\/\\/\\/|\\s*$)/i.test(unquotedOrigUrl)) {\n\t\t  return fullMatch;\n\t\t}\n\n\t\t// convert the url to a full url\n\t\tvar newUrl;\n\n\t\tif (unquotedOrigUrl.indexOf(\"//\") === 0) {\n\t\t  \t//TODO: should we add protocol?\n\t\t\tnewUrl = unquotedOrigUrl;\n\t\t} else if (unquotedOrigUrl.indexOf(\"/\") === 0) {\n\t\t\t// path should be relative to the base url\n\t\t\tnewUrl = baseUrl + unquotedOrigUrl; // already starts with '/'\n\t\t} else {\n\t\t\t// path should be relative to current directory\n\t\t\tnewUrl = currentDir + unquotedOrigUrl.replace(/^\\.\\//, \"\"); // Strip leading './'\n\t\t}\n\n\t\t// send back the fixed url(...)\n\t\treturn \"url(\" + JSON.stringify(newUrl) + \")\";\n\t});\n\n\t// send back the fixed css\n\treturn fixedCss;\n};\n","/**\r\n * Common utilities\r\n * @module glMatrix\r\n */\n// Configuration Constants\nexport var EPSILON = 0.000001;\nexport var ARRAY_TYPE = typeof Float32Array !== 'undefined' ? Float32Array : Array;\nexport var RANDOM = Math.random;\n/**\r\n * Sets the type of array used when creating new vectors and matrices\r\n *\r\n * @param {Type} type Array type, such as Float32Array or Array\r\n */\n\nexport function setMatrixArrayType(type) {\n  ARRAY_TYPE = type;\n}\nvar degree = Math.PI / 180;\n/**\r\n * Convert Degree To Radian\r\n *\r\n * @param {Number} a Angle in Degrees\r\n */\n\nexport function toRadian(a) {\n  return a * degree;\n}\n/**\r\n * Tests whether or not the arguments have approximately the same value, within an absolute\r\n * or relative tolerance of glMatrix.EPSILON (an absolute tolerance is used for values less\r\n * than or equal to 1.0, and a relative tolerance is used for larger values)\r\n *\r\n * @param {Number} a The first number to test.\r\n * @param {Number} b The second number to test.\r\n * @returns {Boolean} True if the numbers are approximately equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  return Math.abs(a - b) <= EPSILON * Math.max(1.0, Math.abs(a), Math.abs(b));\n}\nif (!Math.hypot) Math.hypot = function () {\n  var y = 0,\n      i = arguments.length;\n\n  while (i--) {\n    y += arguments[i] * arguments[i];\n  }\n\n  return Math.sqrt(y);\n};","import * as glMatrix from \"./common.js\";\n/**\r\n * 4x4 Matrix<br>Format: column-major, when typed out it looks like row-major<br>The matrices are being post multiplied.\r\n * @module mat4\r\n */\n\n/**\r\n * Creates a new identity mat4\r\n *\r\n * @returns {mat4} a new 4x4 matrix\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(16);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[11] = 0;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n  }\n\n  out[0] = 1;\n  out[5] = 1;\n  out[10] = 1;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a new mat4 initialized with values from an existing matrix\r\n *\r\n * @param {mat4} a matrix to clone\r\n * @returns {mat4} a new 4x4 matrix\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\r\n * Copy the values from one mat4 to another\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\r\n * Create a new mat4 with the given values\r\n *\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\r\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\r\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\r\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\r\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\r\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\r\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\r\n * @returns {mat4} A new mat4\r\n */\n\nexport function fromValues(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\r\n * Set the components of a mat4 to the given values\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\r\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\r\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\r\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\r\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\r\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\r\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\r\n * @returns {mat4} out\r\n */\n\nexport function set(out, m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\r\n * Set a mat4 to the identity matrix\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @returns {mat4} out\r\n */\n\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Transpose the values of a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    var a01 = a[1],\n        a02 = a[2],\n        a03 = a[3];\n    var a12 = a[6],\n        a13 = a[7];\n    var a23 = a[11];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a01;\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a02;\n    out[9] = a12;\n    out[11] = a[14];\n    out[12] = a03;\n    out[13] = a13;\n    out[14] = a23;\n  } else {\n    out[0] = a[0];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a[1];\n    out[5] = a[5];\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a[2];\n    out[9] = a[6];\n    out[10] = a[10];\n    out[11] = a[14];\n    out[12] = a[3];\n    out[13] = a[7];\n    out[14] = a[11];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\r\n * Inverts a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function invert(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n  out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n  out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n  out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n  out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n  out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n  out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n  return out;\n}\n/**\r\n * Calculates the adjugate of a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the source matrix\r\n * @returns {mat4} out\r\n */\n\nexport function adjoint(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  out[0] = a11 * (a22 * a33 - a23 * a32) - a21 * (a12 * a33 - a13 * a32) + a31 * (a12 * a23 - a13 * a22);\n  out[1] = -(a01 * (a22 * a33 - a23 * a32) - a21 * (a02 * a33 - a03 * a32) + a31 * (a02 * a23 - a03 * a22));\n  out[2] = a01 * (a12 * a33 - a13 * a32) - a11 * (a02 * a33 - a03 * a32) + a31 * (a02 * a13 - a03 * a12);\n  out[3] = -(a01 * (a12 * a23 - a13 * a22) - a11 * (a02 * a23 - a03 * a22) + a21 * (a02 * a13 - a03 * a12));\n  out[4] = -(a10 * (a22 * a33 - a23 * a32) - a20 * (a12 * a33 - a13 * a32) + a30 * (a12 * a23 - a13 * a22));\n  out[5] = a00 * (a22 * a33 - a23 * a32) - a20 * (a02 * a33 - a03 * a32) + a30 * (a02 * a23 - a03 * a22);\n  out[6] = -(a00 * (a12 * a33 - a13 * a32) - a10 * (a02 * a33 - a03 * a32) + a30 * (a02 * a13 - a03 * a12));\n  out[7] = a00 * (a12 * a23 - a13 * a22) - a10 * (a02 * a23 - a03 * a22) + a20 * (a02 * a13 - a03 * a12);\n  out[8] = a10 * (a21 * a33 - a23 * a31) - a20 * (a11 * a33 - a13 * a31) + a30 * (a11 * a23 - a13 * a21);\n  out[9] = -(a00 * (a21 * a33 - a23 * a31) - a20 * (a01 * a33 - a03 * a31) + a30 * (a01 * a23 - a03 * a21));\n  out[10] = a00 * (a11 * a33 - a13 * a31) - a10 * (a01 * a33 - a03 * a31) + a30 * (a01 * a13 - a03 * a11);\n  out[11] = -(a00 * (a11 * a23 - a13 * a21) - a10 * (a01 * a23 - a03 * a21) + a20 * (a01 * a13 - a03 * a11));\n  out[12] = -(a10 * (a21 * a32 - a22 * a31) - a20 * (a11 * a32 - a12 * a31) + a30 * (a11 * a22 - a12 * a21));\n  out[13] = a00 * (a21 * a32 - a22 * a31) - a20 * (a01 * a32 - a02 * a31) + a30 * (a01 * a22 - a02 * a21);\n  out[14] = -(a00 * (a11 * a32 - a12 * a31) - a10 * (a01 * a32 - a02 * a31) + a30 * (a01 * a12 - a02 * a11));\n  out[15] = a00 * (a11 * a22 - a12 * a21) - a10 * (a01 * a22 - a02 * a21) + a20 * (a01 * a12 - a02 * a11);\n  return out;\n}\n/**\r\n * Calculates the determinant of a mat4\r\n *\r\n * @param {mat4} a the source matrix\r\n * @returns {Number} determinant of a\r\n */\n\nexport function determinant(a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  return b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n}\n/**\r\n * Multiplies two mat4s\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the first operand\r\n * @param {mat4} b the second operand\r\n * @returns {mat4} out\r\n */\n\nexport function multiply(out, a, b) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15]; // Cache only the current line of the second matrix\n\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[4];\n  b1 = b[5];\n  b2 = b[6];\n  b3 = b[7];\n  out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[8];\n  b1 = b[9];\n  b2 = b[10];\n  b3 = b[11];\n  out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[12];\n  b1 = b[13];\n  b2 = b[14];\n  b3 = b[15];\n  out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  return out;\n}\n/**\r\n * Translate a mat4 by the given vector\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the matrix to translate\r\n * @param {vec3} v vector to translate by\r\n * @returns {mat4} out\r\n */\n\nexport function translate(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n\n  if (a === out) {\n    out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\n    out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\n    out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\n    out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\n  } else {\n    a00 = a[0];\n    a01 = a[1];\n    a02 = a[2];\n    a03 = a[3];\n    a10 = a[4];\n    a11 = a[5];\n    a12 = a[6];\n    a13 = a[7];\n    a20 = a[8];\n    a21 = a[9];\n    a22 = a[10];\n    a23 = a[11];\n    out[0] = a00;\n    out[1] = a01;\n    out[2] = a02;\n    out[3] = a03;\n    out[4] = a10;\n    out[5] = a11;\n    out[6] = a12;\n    out[7] = a13;\n    out[8] = a20;\n    out[9] = a21;\n    out[10] = a22;\n    out[11] = a23;\n    out[12] = a00 * x + a10 * y + a20 * z + a[12];\n    out[13] = a01 * x + a11 * y + a21 * z + a[13];\n    out[14] = a02 * x + a12 * y + a22 * z + a[14];\n    out[15] = a03 * x + a13 * y + a23 * z + a[15];\n  }\n\n  return out;\n}\n/**\r\n * Scales the mat4 by the dimensions in the given vec3 not using vectorization\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the matrix to scale\r\n * @param {vec3} v the vec3 to scale the matrix by\r\n * @returns {mat4} out\r\n **/\n\nexport function scale(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  out[0] = a[0] * x;\n  out[1] = a[1] * x;\n  out[2] = a[2] * x;\n  out[3] = a[3] * x;\n  out[4] = a[4] * y;\n  out[5] = a[5] * y;\n  out[6] = a[6] * y;\n  out[7] = a[7] * y;\n  out[8] = a[8] * z;\n  out[9] = a[9] * z;\n  out[10] = a[10] * z;\n  out[11] = a[11] * z;\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\r\n * Rotates a mat4 by the given angle around the given axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @param {vec3} axis the axis to rotate around\r\n * @returns {mat4} out\r\n */\n\nexport function rotate(out, a, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.hypot(x, y, z);\n  var s, c, t;\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n  var b00, b01, b02;\n  var b10, b11, b12;\n  var b20, b21, b22;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c;\n  a00 = a[0];\n  a01 = a[1];\n  a02 = a[2];\n  a03 = a[3];\n  a10 = a[4];\n  a11 = a[5];\n  a12 = a[6];\n  a13 = a[7];\n  a20 = a[8];\n  a21 = a[9];\n  a22 = a[10];\n  a23 = a[11]; // Construct the elements of the rotation matrix\n\n  b00 = x * x * t + c;\n  b01 = y * x * t + z * s;\n  b02 = z * x * t - y * s;\n  b10 = x * y * t - z * s;\n  b11 = y * y * t + c;\n  b12 = z * y * t + x * s;\n  b20 = x * z * t + y * s;\n  b21 = y * z * t - x * s;\n  b22 = z * z * t + c; // Perform rotation-specific matrix multiplication\n\n  out[0] = a00 * b00 + a10 * b01 + a20 * b02;\n  out[1] = a01 * b00 + a11 * b01 + a21 * b02;\n  out[2] = a02 * b00 + a12 * b01 + a22 * b02;\n  out[3] = a03 * b00 + a13 * b01 + a23 * b02;\n  out[4] = a00 * b10 + a10 * b11 + a20 * b12;\n  out[5] = a01 * b10 + a11 * b11 + a21 * b12;\n  out[6] = a02 * b10 + a12 * b11 + a22 * b12;\n  out[7] = a03 * b10 + a13 * b11 + a23 * b12;\n  out[8] = a00 * b20 + a10 * b21 + a20 * b22;\n  out[9] = a01 * b20 + a11 * b21 + a21 * b22;\n  out[10] = a02 * b20 + a12 * b21 + a22 * b22;\n  out[11] = a03 * b20 + a13 * b21 + a23 * b22;\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\r\n * Rotates a matrix by the given angle around the X axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function rotateX(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[4] = a10 * c + a20 * s;\n  out[5] = a11 * c + a21 * s;\n  out[6] = a12 * c + a22 * s;\n  out[7] = a13 * c + a23 * s;\n  out[8] = a20 * c - a10 * s;\n  out[9] = a21 * c - a11 * s;\n  out[10] = a22 * c - a12 * s;\n  out[11] = a23 * c - a13 * s;\n  return out;\n}\n/**\r\n * Rotates a matrix by the given angle around the Y axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function rotateY(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[4] = a[4];\n    out[5] = a[5];\n    out[6] = a[6];\n    out[7] = a[7];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c - a20 * s;\n  out[1] = a01 * c - a21 * s;\n  out[2] = a02 * c - a22 * s;\n  out[3] = a03 * c - a23 * s;\n  out[8] = a00 * s + a20 * c;\n  out[9] = a01 * s + a21 * c;\n  out[10] = a02 * s + a22 * c;\n  out[11] = a03 * s + a23 * c;\n  return out;\n}\n/**\r\n * Rotates a matrix by the given angle around the Z axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function rotateZ(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[8] = a[8];\n    out[9] = a[9];\n    out[10] = a[10];\n    out[11] = a[11];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c + a10 * s;\n  out[1] = a01 * c + a11 * s;\n  out[2] = a02 * c + a12 * s;\n  out[3] = a03 * c + a13 * s;\n  out[4] = a10 * c - a00 * s;\n  out[5] = a11 * c - a01 * s;\n  out[6] = a12 * c - a02 * s;\n  out[7] = a13 * c - a03 * s;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, dest, vec);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {vec3} v Translation vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector scaling\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.scale(dest, dest, vec);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {vec3} v Scaling vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = v[1];\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = v[2];\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a given angle around a given axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotate(dest, dest, rad, axis);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @param {vec3} axis the axis to rotate around\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotation(out, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.hypot(x, y, z);\n  var s, c, t;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c; // Perform rotation-specific matrix multiplication\n\n  out[0] = x * x * t + c;\n  out[1] = y * x * t + z * s;\n  out[2] = z * x * t - y * s;\n  out[3] = 0;\n  out[4] = x * y * t - z * s;\n  out[5] = y * y * t + c;\n  out[6] = z * y * t + x * s;\n  out[7] = 0;\n  out[8] = x * z * t + y * s;\n  out[9] = y * z * t - x * s;\n  out[10] = z * z * t + c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from the given angle around the X axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateX(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function fromXRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = c;\n  out[6] = s;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = -s;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from the given angle around the Y axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateY(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function fromYRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = 0;\n  out[2] = -s;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = s;\n  out[9] = 0;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from the given angle around the Z axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateZ(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\n\nexport function fromZRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -s;\n  out[5] = c;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a quaternion rotation and vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {vec3} v Translation vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotationTranslation(out, q, v) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - (yy + zz);\n  out[1] = xy + wz;\n  out[2] = xz - wy;\n  out[3] = 0;\n  out[4] = xy - wz;\n  out[5] = 1 - (xx + zz);\n  out[6] = yz + wx;\n  out[7] = 0;\n  out[8] = xz + wy;\n  out[9] = yz - wx;\n  out[10] = 1 - (xx + yy);\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a new mat4 from a dual quat.\r\n *\r\n * @param {mat4} out Matrix\r\n * @param {quat2} a Dual Quaternion\r\n * @returns {mat4} mat4 receiving operation result\r\n */\n\nexport function fromQuat2(out, a) {\n  var translation = new glMatrix.ARRAY_TYPE(3);\n  var bx = -a[0],\n      by = -a[1],\n      bz = -a[2],\n      bw = a[3],\n      ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7];\n  var magnitude = bx * bx + by * by + bz * bz + bw * bw; //Only scale if it makes sense\n\n  if (magnitude > 0) {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2 / magnitude;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2 / magnitude;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2 / magnitude;\n  } else {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\n  }\n\n  fromRotationTranslation(out, a, translation);\n  return out;\n}\n/**\r\n * Returns the translation vector component of a transformation\r\n *  matrix. If a matrix is built with fromRotationTranslation,\r\n *  the returned vector will be the same as the translation vector\r\n *  originally supplied.\r\n * @param  {vec3} out Vector to receive translation component\r\n * @param  {mat4} mat Matrix to be decomposed (input)\r\n * @return {vec3} out\r\n */\n\nexport function getTranslation(out, mat) {\n  out[0] = mat[12];\n  out[1] = mat[13];\n  out[2] = mat[14];\n  return out;\n}\n/**\r\n * Returns the scaling factor component of a transformation\r\n *  matrix. If a matrix is built with fromRotationTranslationScale\r\n *  with a normalized Quaternion paramter, the returned vector will be\r\n *  the same as the scaling vector\r\n *  originally supplied.\r\n * @param  {vec3} out Vector to receive scaling factor component\r\n * @param  {mat4} mat Matrix to be decomposed (input)\r\n * @return {vec3} out\r\n */\n\nexport function getScaling(out, mat) {\n  var m11 = mat[0];\n  var m12 = mat[1];\n  var m13 = mat[2];\n  var m21 = mat[4];\n  var m22 = mat[5];\n  var m23 = mat[6];\n  var m31 = mat[8];\n  var m32 = mat[9];\n  var m33 = mat[10];\n  out[0] = Math.hypot(m11, m12, m13);\n  out[1] = Math.hypot(m21, m22, m23);\n  out[2] = Math.hypot(m31, m32, m33);\n  return out;\n}\n/**\r\n * Returns a quaternion representing the rotational component\r\n *  of a transformation matrix. If a matrix is built with\r\n *  fromRotationTranslation, the returned quaternion will be the\r\n *  same as the quaternion originally supplied.\r\n * @param {quat} out Quaternion to receive the rotation component\r\n * @param {mat4} mat Matrix to be decomposed (input)\r\n * @return {quat} out\r\n */\n\nexport function getRotation(out, mat) {\n  var scaling = new glMatrix.ARRAY_TYPE(3);\n  getScaling(scaling, mat);\n  var is1 = 1 / scaling[0];\n  var is2 = 1 / scaling[1];\n  var is3 = 1 / scaling[2];\n  var sm11 = mat[0] * is1;\n  var sm12 = mat[1] * is2;\n  var sm13 = mat[2] * is3;\n  var sm21 = mat[4] * is1;\n  var sm22 = mat[5] * is2;\n  var sm23 = mat[6] * is3;\n  var sm31 = mat[8] * is1;\n  var sm32 = mat[9] * is2;\n  var sm33 = mat[10] * is3;\n  var trace = sm11 + sm22 + sm33;\n  var S = 0;\n\n  if (trace > 0) {\n    S = Math.sqrt(trace + 1.0) * 2;\n    out[3] = 0.25 * S;\n    out[0] = (sm23 - sm32) / S;\n    out[1] = (sm31 - sm13) / S;\n    out[2] = (sm12 - sm21) / S;\n  } else if (sm11 > sm22 && sm11 > sm33) {\n    S = Math.sqrt(1.0 + sm11 - sm22 - sm33) * 2;\n    out[3] = (sm23 - sm32) / S;\n    out[0] = 0.25 * S;\n    out[1] = (sm12 + sm21) / S;\n    out[2] = (sm31 + sm13) / S;\n  } else if (sm22 > sm33) {\n    S = Math.sqrt(1.0 + sm22 - sm11 - sm33) * 2;\n    out[3] = (sm31 - sm13) / S;\n    out[0] = (sm12 + sm21) / S;\n    out[1] = 0.25 * S;\n    out[2] = (sm23 + sm32) / S;\n  } else {\n    S = Math.sqrt(1.0 + sm33 - sm11 - sm22) * 2;\n    out[3] = (sm12 - sm21) / S;\n    out[0] = (sm31 + sm13) / S;\n    out[1] = (sm23 + sm32) / S;\n    out[2] = 0.25 * S;\n  }\n\n  return out;\n}\n/**\r\n * Creates a matrix from a quaternion rotation, vector translation and vector scale\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *     mat4.scale(dest, scale)\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {vec3} v Translation vector\r\n * @param {vec3} s Scaling vector\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotationTranslationScale(out, q, v, s) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  out[0] = (1 - (yy + zz)) * sx;\n  out[1] = (xy + wz) * sx;\n  out[2] = (xz - wy) * sx;\n  out[3] = 0;\n  out[4] = (xy - wz) * sy;\n  out[5] = (1 - (xx + zz)) * sy;\n  out[6] = (yz + wx) * sy;\n  out[7] = 0;\n  out[8] = (xz + wy) * sz;\n  out[9] = (yz - wx) * sz;\n  out[10] = (1 - (xx + yy)) * sz;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a quaternion rotation, vector translation and vector scale, rotating and scaling around the given origin\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     mat4.translate(dest, origin);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *     mat4.scale(dest, scale)\r\n *     mat4.translate(dest, negativeOrigin);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {vec3} v Translation vector\r\n * @param {vec3} s Scaling vector\r\n * @param {vec3} o The origin vector around which to scale and rotate\r\n * @returns {mat4} out\r\n */\n\nexport function fromRotationTranslationScaleOrigin(out, q, v, s, o) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  var ox = o[0];\n  var oy = o[1];\n  var oz = o[2];\n  var out0 = (1 - (yy + zz)) * sx;\n  var out1 = (xy + wz) * sx;\n  var out2 = (xz - wy) * sx;\n  var out4 = (xy - wz) * sy;\n  var out5 = (1 - (xx + zz)) * sy;\n  var out6 = (yz + wx) * sy;\n  var out8 = (xz + wy) * sz;\n  var out9 = (yz - wx) * sz;\n  var out10 = (1 - (xx + yy)) * sz;\n  out[0] = out0;\n  out[1] = out1;\n  out[2] = out2;\n  out[3] = 0;\n  out[4] = out4;\n  out[5] = out5;\n  out[6] = out6;\n  out[7] = 0;\n  out[8] = out8;\n  out[9] = out9;\n  out[10] = out10;\n  out[11] = 0;\n  out[12] = v[0] + ox - (out0 * ox + out4 * oy + out8 * oz);\n  out[13] = v[1] + oy - (out1 * ox + out5 * oy + out9 * oz);\n  out[14] = v[2] + oz - (out2 * ox + out6 * oy + out10 * oz);\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Calculates a 4x4 matrix from the given quaternion\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat} q Quaternion to create matrix from\r\n *\r\n * @returns {mat4} out\r\n */\n\nexport function fromQuat(out, q) {\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var yx = y * x2;\n  var yy = y * y2;\n  var zx = z * x2;\n  var zy = z * y2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[1] = yx + wz;\n  out[2] = zx - wy;\n  out[3] = 0;\n  out[4] = yx - wz;\n  out[5] = 1 - xx - zz;\n  out[6] = zy + wx;\n  out[7] = 0;\n  out[8] = zx + wy;\n  out[9] = zy - wx;\n  out[10] = 1 - xx - yy;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Generates a frustum matrix with the given bounds\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {Number} left Left bound of the frustum\r\n * @param {Number} right Right bound of the frustum\r\n * @param {Number} bottom Bottom bound of the frustum\r\n * @param {Number} top Top bound of the frustum\r\n * @param {Number} near Near bound of the frustum\r\n * @param {Number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\n\nexport function frustum(out, left, right, bottom, top, near, far) {\n  var rl = 1 / (right - left);\n  var tb = 1 / (top - bottom);\n  var nf = 1 / (near - far);\n  out[0] = near * 2 * rl;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = near * 2 * tb;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = (right + left) * rl;\n  out[9] = (top + bottom) * tb;\n  out[10] = (far + near) * nf;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = far * near * 2 * nf;\n  out[15] = 0;\n  return out;\n}\n/**\r\n * Generates a perspective projection matrix with the given bounds.\r\n * Passing null/undefined/no value for far will generate infinite projection matrix.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {number} fovy Vertical field of view in radians\r\n * @param {number} aspect Aspect ratio. typically viewport width/height\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum, can be null or Infinity\r\n * @returns {mat4} out\r\n */\n\nexport function perspective(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2),\n      nf;\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n\n  if (far != null && far !== Infinity) {\n    nf = 1 / (near - far);\n    out[10] = (far + near) * nf;\n    out[14] = 2 * far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -2 * near;\n  }\n\n  return out;\n}\n/**\r\n * Generates a perspective projection matrix with the given field of view.\r\n * This is primarily useful for generating projection matrices to be used\r\n * with the still experiemental WebVR API.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {Object} fov Object containing the following values: upDegrees, downDegrees, leftDegrees, rightDegrees\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\n\nexport function perspectiveFromFieldOfView(out, fov, near, far) {\n  var upTan = Math.tan(fov.upDegrees * Math.PI / 180.0);\n  var downTan = Math.tan(fov.downDegrees * Math.PI / 180.0);\n  var leftTan = Math.tan(fov.leftDegrees * Math.PI / 180.0);\n  var rightTan = Math.tan(fov.rightDegrees * Math.PI / 180.0);\n  var xScale = 2.0 / (leftTan + rightTan);\n  var yScale = 2.0 / (upTan + downTan);\n  out[0] = xScale;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  out[4] = 0.0;\n  out[5] = yScale;\n  out[6] = 0.0;\n  out[7] = 0.0;\n  out[8] = -((leftTan - rightTan) * xScale * 0.5);\n  out[9] = (upTan - downTan) * yScale * 0.5;\n  out[10] = far / (near - far);\n  out[11] = -1.0;\n  out[12] = 0.0;\n  out[13] = 0.0;\n  out[14] = far * near / (near - far);\n  out[15] = 0.0;\n  return out;\n}\n/**\r\n * Generates a orthogonal projection matrix with the given bounds\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {number} left Left bound of the frustum\r\n * @param {number} right Right bound of the frustum\r\n * @param {number} bottom Bottom bound of the frustum\r\n * @param {number} top Top bound of the frustum\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\n\nexport function ortho(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 2 * nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = (far + near) * nf;\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Generates a look-at matrix with the given eye position, focal point, and up axis.\r\n * If you want a matrix that actually makes an object look at another object, you should use targetTo instead.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {vec3} eye Position of the viewer\r\n * @param {vec3} center Point the viewer is looking at\r\n * @param {vec3} up vec3 pointing up\r\n * @returns {mat4} out\r\n */\n\nexport function lookAt(out, eye, center, up) {\n  var x0, x1, x2, y0, y1, y2, z0, z1, z2, len;\n  var eyex = eye[0];\n  var eyey = eye[1];\n  var eyez = eye[2];\n  var upx = up[0];\n  var upy = up[1];\n  var upz = up[2];\n  var centerx = center[0];\n  var centery = center[1];\n  var centerz = center[2];\n\n  if (Math.abs(eyex - centerx) < glMatrix.EPSILON && Math.abs(eyey - centery) < glMatrix.EPSILON && Math.abs(eyez - centerz) < glMatrix.EPSILON) {\n    return identity(out);\n  }\n\n  z0 = eyex - centerx;\n  z1 = eyey - centery;\n  z2 = eyez - centerz;\n  len = 1 / Math.hypot(z0, z1, z2);\n  z0 *= len;\n  z1 *= len;\n  z2 *= len;\n  x0 = upy * z2 - upz * z1;\n  x1 = upz * z0 - upx * z2;\n  x2 = upx * z1 - upy * z0;\n  len = Math.hypot(x0, x1, x2);\n\n  if (!len) {\n    x0 = 0;\n    x1 = 0;\n    x2 = 0;\n  } else {\n    len = 1 / len;\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  y0 = z1 * x2 - z2 * x1;\n  y1 = z2 * x0 - z0 * x2;\n  y2 = z0 * x1 - z1 * x0;\n  len = Math.hypot(y0, y1, y2);\n\n  if (!len) {\n    y0 = 0;\n    y1 = 0;\n    y2 = 0;\n  } else {\n    len = 1 / len;\n    y0 *= len;\n    y1 *= len;\n    y2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = y0;\n  out[2] = z0;\n  out[3] = 0;\n  out[4] = x1;\n  out[5] = y1;\n  out[6] = z1;\n  out[7] = 0;\n  out[8] = x2;\n  out[9] = y2;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = -(x0 * eyex + x1 * eyey + x2 * eyez);\n  out[13] = -(y0 * eyex + y1 * eyey + y2 * eyez);\n  out[14] = -(z0 * eyex + z1 * eyey + z2 * eyez);\n  out[15] = 1;\n  return out;\n}\n/**\r\n * Generates a matrix that makes something look at something else.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {vec3} eye Position of the viewer\r\n * @param {vec3} center Point the viewer is looking at\r\n * @param {vec3} up vec3 pointing up\r\n * @returns {mat4} out\r\n */\n\nexport function targetTo(out, eye, target, up) {\n  var eyex = eye[0],\n      eyey = eye[1],\n      eyez = eye[2],\n      upx = up[0],\n      upy = up[1],\n      upz = up[2];\n  var z0 = eyex - target[0],\n      z1 = eyey - target[1],\n      z2 = eyez - target[2];\n  var len = z0 * z0 + z1 * z1 + z2 * z2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    z0 *= len;\n    z1 *= len;\n    z2 *= len;\n  }\n\n  var x0 = upy * z2 - upz * z1,\n      x1 = upz * z0 - upx * z2,\n      x2 = upx * z1 - upy * z0;\n  len = x0 * x0 + x1 * x1 + x2 * x2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = x1;\n  out[2] = x2;\n  out[3] = 0;\n  out[4] = z1 * x2 - z2 * x1;\n  out[5] = z2 * x0 - z0 * x2;\n  out[6] = z0 * x1 - z1 * x0;\n  out[7] = 0;\n  out[8] = z0;\n  out[9] = z1;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = eyex;\n  out[13] = eyey;\n  out[14] = eyez;\n  out[15] = 1;\n  return out;\n}\n;\n/**\r\n * Returns a string representation of a mat4\r\n *\r\n * @param {mat4} a matrix to represent as a string\r\n * @returns {String} string representation of the matrix\r\n */\n\nexport function str(a) {\n  return 'mat4(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + a[3] + ', ' + a[4] + ', ' + a[5] + ', ' + a[6] + ', ' + a[7] + ', ' + a[8] + ', ' + a[9] + ', ' + a[10] + ', ' + a[11] + ', ' + a[12] + ', ' + a[13] + ', ' + a[14] + ', ' + a[15] + ')';\n}\n/**\r\n * Returns Frobenius norm of a mat4\r\n *\r\n * @param {mat4} a the matrix to calculate Frobenius norm of\r\n * @returns {Number} Frobenius norm\r\n */\n\nexport function frob(a) {\n  return Math.hypot(a[0], a[1], a[3], a[4], a[5], a[6], a[7], a[8], a[9], a[10], a[11], a[12], a[13], a[14], a[15]);\n}\n/**\r\n * Adds two mat4's\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the first operand\r\n * @param {mat4} b the second operand\r\n * @returns {mat4} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  out[9] = a[9] + b[9];\n  out[10] = a[10] + b[10];\n  out[11] = a[11] + b[11];\n  out[12] = a[12] + b[12];\n  out[13] = a[13] + b[13];\n  out[14] = a[14] + b[14];\n  out[15] = a[15] + b[15];\n  return out;\n}\n/**\r\n * Subtracts matrix b from matrix a\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the first operand\r\n * @param {mat4} b the second operand\r\n * @returns {mat4} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  out[9] = a[9] - b[9];\n  out[10] = a[10] - b[10];\n  out[11] = a[11] - b[11];\n  out[12] = a[12] - b[12];\n  out[13] = a[13] - b[13];\n  out[14] = a[14] - b[14];\n  out[15] = a[15] - b[15];\n  return out;\n}\n/**\r\n * Multiply each element of the matrix by a scalar.\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the matrix to scale\r\n * @param {Number} b amount to scale the matrix's elements by\r\n * @returns {mat4} out\r\n */\n\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  out[9] = a[9] * b;\n  out[10] = a[10] * b;\n  out[11] = a[11] * b;\n  out[12] = a[12] * b;\n  out[13] = a[13] * b;\n  out[14] = a[14] * b;\n  out[15] = a[15] * b;\n  return out;\n}\n/**\r\n * Adds two mat4's after multiplying each element of the second operand by a scalar value.\r\n *\r\n * @param {mat4} out the receiving vector\r\n * @param {mat4} a the first operand\r\n * @param {mat4} b the second operand\r\n * @param {Number} scale the amount to scale b's elements by before adding\r\n * @returns {mat4} out\r\n */\n\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  out[9] = a[9] + b[9] * scale;\n  out[10] = a[10] + b[10] * scale;\n  out[11] = a[11] + b[11] * scale;\n  out[12] = a[12] + b[12] * scale;\n  out[13] = a[13] + b[13] * scale;\n  out[14] = a[14] + b[14] * scale;\n  out[15] = a[15] + b[15] * scale;\n  return out;\n}\n/**\r\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {mat4} a The first matrix.\r\n * @param {mat4} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8] && a[9] === b[9] && a[10] === b[10] && a[11] === b[11] && a[12] === b[12] && a[13] === b[13] && a[14] === b[14] && a[15] === b[15];\n}\n/**\r\n * Returns whether or not the matrices have approximately the same elements in the same position.\r\n *\r\n * @param {mat4} a The first matrix.\r\n * @param {mat4} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var a4 = a[4],\n      a5 = a[5],\n      a6 = a[6],\n      a7 = a[7];\n  var a8 = a[8],\n      a9 = a[9],\n      a10 = a[10],\n      a11 = a[11];\n  var a12 = a[12],\n      a13 = a[13],\n      a14 = a[14],\n      a15 = a[15];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  var b4 = b[4],\n      b5 = b[5],\n      b6 = b[6],\n      b7 = b[7];\n  var b8 = b[8],\n      b9 = b[9],\n      b10 = b[10],\n      b11 = b[11];\n  var b12 = b[12],\n      b13 = b[13],\n      b14 = b[14],\n      b15 = b[15];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8)) && Math.abs(a9 - b9) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a9), Math.abs(b9)) && Math.abs(a10 - b10) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a10), Math.abs(b10)) && Math.abs(a11 - b11) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a11), Math.abs(b11)) && Math.abs(a12 - b12) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a12), Math.abs(b12)) && Math.abs(a13 - b13) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a13), Math.abs(b13)) && Math.abs(a14 - b14) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a14), Math.abs(b14)) && Math.abs(a15 - b15) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a15), Math.abs(b15));\n}\n/**\r\n * Alias for {@link mat4.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link mat4.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;","import * as glMatrix from \"./common.js\";\n/**\r\n * 3 Dimensional Vector\r\n * @module vec3\r\n */\n\n/**\r\n * Creates a new, empty vec3\r\n *\r\n * @returns {vec3} a new 3D vector\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(3);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n\n  return out;\n}\n/**\r\n * Creates a new vec3 initialized with values from an existing vector\r\n *\r\n * @param {vec3} a vector to clone\r\n * @returns {vec3} a new 3D vector\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\r\n * Calculates the length of a vec3\r\n *\r\n * @param {vec3} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\n\nexport function length(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return Math.hypot(x, y, z);\n}\n/**\r\n * Creates a new vec3 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @returns {vec3} a new 3D vector\r\n */\n\nexport function fromValues(x, y, z) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\r\n * Copy the values from one vec3 to another\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the source vector\r\n * @returns {vec3} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\r\n * Set the components of a vec3 to the given values\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @returns {vec3} out\r\n */\n\nexport function set(out, x, y, z) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\r\n * Adds two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  return out;\n}\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  return out;\n}\n/**\r\n * Multiplies two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  return out;\n}\n/**\r\n * Divides two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  return out;\n}\n/**\r\n * Math.ceil the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a vector to ceil\r\n * @returns {vec3} out\r\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  return out;\n}\n/**\r\n * Math.floor the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a vector to floor\r\n * @returns {vec3} out\r\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  return out;\n}\n/**\r\n * Returns the minimum of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  return out;\n}\n/**\r\n * Returns the maximum of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  return out;\n}\n/**\r\n * Math.round the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a vector to round\r\n * @returns {vec3} out\r\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  out[2] = Math.round(a[2]);\n  return out;\n}\n/**\r\n * Scales a vec3 by a scalar number\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec3} out\r\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  return out;\n}\n/**\r\n * Adds two vec3's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec3} out\r\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  return out;\n}\n/**\r\n * Calculates the euclidian distance between two vec3's\r\n *\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return Math.hypot(x, y, z);\n}\n/**\r\n * Calculates the squared euclidian distance between two vec3's\r\n *\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return x * x + y * y + z * z;\n}\n/**\r\n * Calculates the squared length of a vec3\r\n *\r\n * @param {vec3} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\n\nexport function squaredLength(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return x * x + y * y + z * z;\n}\n/**\r\n * Negates the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a vector to negate\r\n * @returns {vec3} out\r\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  return out;\n}\n/**\r\n * Returns the inverse of the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a vector to invert\r\n * @returns {vec3} out\r\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  return out;\n}\n/**\r\n * Normalize a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a vector to normalize\r\n * @returns {vec3} out\r\n */\n\nexport function normalize(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var len = x * x + y * y + z * z;\n\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  out[2] = a[2] * len;\n  return out;\n}\n/**\r\n * Calculates the dot product of two vec3's\r\n *\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n}\n/**\r\n * Computes the cross product of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function cross(out, a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2];\n  out[0] = ay * bz - az * by;\n  out[1] = az * bx - ax * bz;\n  out[2] = ax * by - ay * bx;\n  return out;\n}\n/**\r\n * Performs a linear interpolation between two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  return out;\n}\n/**\r\n * Performs a hermite interpolation with two control points\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @param {vec3} c the third operand\r\n * @param {vec3} d the fourth operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\n\nexport function hermite(out, a, b, c, d, t) {\n  var factorTimes2 = t * t;\n  var factor1 = factorTimes2 * (2 * t - 3) + 1;\n  var factor2 = factorTimes2 * (t - 2) + t;\n  var factor3 = factorTimes2 * (t - 1);\n  var factor4 = factorTimes2 * (3 - 2 * t);\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\r\n * Performs a bezier interpolation with two control points\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @param {vec3} c the third operand\r\n * @param {vec3} d the fourth operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\n\nexport function bezier(out, a, b, c, d, t) {\n  var inverseFactor = 1 - t;\n  var inverseFactorTimesTwo = inverseFactor * inverseFactor;\n  var factorTimes2 = t * t;\n  var factor1 = inverseFactorTimesTwo * inverseFactor;\n  var factor2 = 3 * t * inverseFactorTimesTwo;\n  var factor3 = 3 * factorTimes2 * inverseFactor;\n  var factor4 = factorTimes2 * t;\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec3} out\r\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0;\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  var z = glMatrix.RANDOM() * 2.0 - 1.0;\n  var zScale = Math.sqrt(1.0 - z * z) * scale;\n  out[0] = Math.cos(r) * zScale;\n  out[1] = Math.sin(r) * zScale;\n  out[2] = z * scale;\n  return out;\n}\n/**\r\n * Transforms the vec3 with a mat4.\r\n * 4th vector component is implicitly '1'\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the vector to transform\r\n * @param {mat4} m matrix to transform with\r\n * @returns {vec3} out\r\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var w = m[3] * x + m[7] * y + m[11] * z + m[15];\n  w = w || 1.0;\n  out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\n  out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\n  out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\n  return out;\n}\n/**\r\n * Transforms the vec3 with a mat3.\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the vector to transform\r\n * @param {mat3} m the 3x3 matrix to transform with\r\n * @returns {vec3} out\r\n */\n\nexport function transformMat3(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  out[0] = x * m[0] + y * m[3] + z * m[6];\n  out[1] = x * m[1] + y * m[4] + z * m[7];\n  out[2] = x * m[2] + y * m[5] + z * m[8];\n  return out;\n}\n/**\r\n * Transforms the vec3 with a quat\r\n * Can also be used for dual quaternions. (Multiply it with the real part)\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the vector to transform\r\n * @param {quat} q quaternion to transform with\r\n * @returns {vec3} out\r\n */\n\nexport function transformQuat(out, a, q) {\n  // benchmarks: https://jsperf.com/quaternion-transform-vec3-implementations-fixed\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3];\n  var x = a[0],\n      y = a[1],\n      z = a[2]; // var qvec = [qx, qy, qz];\n  // var uv = vec3.cross([], qvec, a);\n\n  var uvx = qy * z - qz * y,\n      uvy = qz * x - qx * z,\n      uvz = qx * y - qy * x; // var uuv = vec3.cross([], qvec, uv);\n\n  var uuvx = qy * uvz - qz * uvy,\n      uuvy = qz * uvx - qx * uvz,\n      uuvz = qx * uvy - qy * uvx; // vec3.scale(uv, uv, 2 * w);\n\n  var w2 = qw * 2;\n  uvx *= w2;\n  uvy *= w2;\n  uvz *= w2; // vec3.scale(uuv, uuv, 2);\n\n  uuvx *= 2;\n  uuvy *= 2;\n  uuvz *= 2; // return vec3.add(out, a, vec3.add(out, uv, uuv));\n\n  out[0] = x + uvx + uuvx;\n  out[1] = y + uvy + uuvy;\n  out[2] = z + uvz + uuvz;\n  return out;\n}\n/**\r\n * Rotate a 3D vector around the x-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {vec3} a The vec3 point to rotate\r\n * @param {vec3} b The origin of the rotation\r\n * @param {Number} c The angle of rotation\r\n * @returns {vec3} out\r\n */\n\nexport function rotateX(out, a, b, c) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0];\n  r[1] = p[1] * Math.cos(c) - p[2] * Math.sin(c);\n  r[2] = p[1] * Math.sin(c) + p[2] * Math.cos(c); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\r\n * Rotate a 3D vector around the y-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {vec3} a The vec3 point to rotate\r\n * @param {vec3} b The origin of the rotation\r\n * @param {Number} c The angle of rotation\r\n * @returns {vec3} out\r\n */\n\nexport function rotateY(out, a, b, c) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[2] * Math.sin(c) + p[0] * Math.cos(c);\n  r[1] = p[1];\n  r[2] = p[2] * Math.cos(c) - p[0] * Math.sin(c); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\r\n * Rotate a 3D vector around the z-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {vec3} a The vec3 point to rotate\r\n * @param {vec3} b The origin of the rotation\r\n * @param {Number} c The angle of rotation\r\n * @returns {vec3} out\r\n */\n\nexport function rotateZ(out, a, b, c) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0] * Math.cos(c) - p[1] * Math.sin(c);\n  r[1] = p[0] * Math.sin(c) + p[1] * Math.cos(c);\n  r[2] = p[2]; //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\r\n * Get the angle between two 3D vectors\r\n * @param {vec3} a The first operand\r\n * @param {vec3} b The second operand\r\n * @returns {Number} The angle in radians\r\n */\n\nexport function angle(a, b) {\n  var tempA = fromValues(a[0], a[1], a[2]);\n  var tempB = fromValues(b[0], b[1], b[2]);\n  normalize(tempA, tempA);\n  normalize(tempB, tempB);\n  var cosine = dot(tempA, tempB);\n\n  if (cosine > 1.0) {\n    return 0;\n  } else if (cosine < -1.0) {\n    return Math.PI;\n  } else {\n    return Math.acos(cosine);\n  }\n}\n/**\r\n * Set the components of a vec3 to zero\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @returns {vec3} out\r\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  return out;\n}\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {vec3} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\n\nexport function str(a) {\n  return 'vec3(' + a[0] + ', ' + a[1] + ', ' + a[2] + ')';\n}\n/**\r\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {vec3} a The first vector.\r\n * @param {vec3} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2];\n}\n/**\r\n * Returns whether or not the vectors have approximately the same elements in the same position.\r\n *\r\n * @param {vec3} a The first vector.\r\n * @param {vec3} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2));\n}\n/**\r\n * Alias for {@link vec3.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;\n/**\r\n * Alias for {@link vec3.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link vec3.divide}\r\n * @function\r\n */\n\nexport var div = divide;\n/**\r\n * Alias for {@link vec3.distance}\r\n * @function\r\n */\n\nexport var dist = distance;\n/**\r\n * Alias for {@link vec3.squaredDistance}\r\n * @function\r\n */\n\nexport var sqrDist = squaredDistance;\n/**\r\n * Alias for {@link vec3.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Alias for {@link vec3.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Perform some operation over an array of vec3s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec3. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec3s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 3;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n    }\n\n    return a;\n  };\n}();","import * as glMatrix from \"./common.js\";\n/**\r\n * 4 Dimensional Vector\r\n * @module vec4\r\n */\n\n/**\r\n * Creates a new, empty vec4\r\n *\r\n * @returns {vec4} a new 4D vector\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(4);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n  }\n\n  return out;\n}\n/**\r\n * Creates a new vec4 initialized with values from an existing vector\r\n *\r\n * @param {vec4} a vector to clone\r\n * @returns {vec4} a new 4D vector\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Creates a new vec4 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {vec4} a new 4D vector\r\n */\n\nexport function fromValues(x, y, z, w) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = w;\n  return out;\n}\n/**\r\n * Copy the values from one vec4 to another\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the source vector\r\n * @returns {vec4} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Set the components of a vec4 to the given values\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {vec4} out\r\n */\n\nexport function set(out, x, y, z, w) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = w;\n  return out;\n}\n/**\r\n * Adds two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  return out;\n}\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  return out;\n}\n/**\r\n * Multiplies two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  out[3] = a[3] * b[3];\n  return out;\n}\n/**\r\n * Divides two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  out[3] = a[3] / b[3];\n  return out;\n}\n/**\r\n * Math.ceil the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a vector to ceil\r\n * @returns {vec4} out\r\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  out[3] = Math.ceil(a[3]);\n  return out;\n}\n/**\r\n * Math.floor the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a vector to floor\r\n * @returns {vec4} out\r\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  out[3] = Math.floor(a[3]);\n  return out;\n}\n/**\r\n * Returns the minimum of two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  out[3] = Math.min(a[3], b[3]);\n  return out;\n}\n/**\r\n * Returns the maximum of two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {vec4} out\r\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  out[3] = Math.max(a[3], b[3]);\n  return out;\n}\n/**\r\n * Math.round the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a vector to round\r\n * @returns {vec4} out\r\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  out[2] = Math.round(a[2]);\n  out[3] = Math.round(a[3]);\n  return out;\n}\n/**\r\n * Scales a vec4 by a scalar number\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec4} out\r\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  return out;\n}\n/**\r\n * Adds two vec4's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec4} out\r\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  return out;\n}\n/**\r\n * Calculates the euclidian distance between two vec4's\r\n *\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  var w = b[3] - a[3];\n  return Math.hypot(x, y, z, w);\n}\n/**\r\n * Calculates the squared euclidian distance between two vec4's\r\n *\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  var w = b[3] - a[3];\n  return x * x + y * y + z * z + w * w;\n}\n/**\r\n * Calculates the length of a vec4\r\n *\r\n * @param {vec4} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\n\nexport function length(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  return Math.hypot(x, y, z, w);\n}\n/**\r\n * Calculates the squared length of a vec4\r\n *\r\n * @param {vec4} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\n\nexport function squaredLength(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  return x * x + y * y + z * z + w * w;\n}\n/**\r\n * Negates the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a vector to negate\r\n * @returns {vec4} out\r\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = -a[3];\n  return out;\n}\n/**\r\n * Returns the inverse of the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a vector to invert\r\n * @returns {vec4} out\r\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  out[3] = 1.0 / a[3];\n  return out;\n}\n/**\r\n * Normalize a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a vector to normalize\r\n * @returns {vec4} out\r\n */\n\nexport function normalize(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  var len = x * x + y * y + z * z + w * w;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = x * len;\n  out[1] = y * len;\n  out[2] = z * len;\n  out[3] = w * len;\n  return out;\n}\n/**\r\n * Calculates the dot product of two vec4's\r\n *\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2] + a[3] * b[3];\n}\n/**\r\n * Returns the cross-product of three vectors in a 4-dimensional space\r\n *\r\n * @param {vec4} result the receiving vector\r\n * @param {vec4} U the first vector\r\n * @param {vec4} V the second vector\r\n * @param {vec4} W the third vector\r\n * @returns {vec4} result\r\n */\n\nexport function cross(out, u, v, w) {\n  var A = v[0] * w[1] - v[1] * w[0],\n      B = v[0] * w[2] - v[2] * w[0],\n      C = v[0] * w[3] - v[3] * w[0],\n      D = v[1] * w[2] - v[2] * w[1],\n      E = v[1] * w[3] - v[3] * w[1],\n      F = v[2] * w[3] - v[3] * w[2];\n  var G = u[0];\n  var H = u[1];\n  var I = u[2];\n  var J = u[3];\n  out[0] = H * F - I * E + J * D;\n  out[1] = -(G * F) + I * C - J * B;\n  out[2] = G * E - H * C + J * A;\n  out[3] = -(G * D) + H * B - I * A;\n  return out;\n}\n;\n/**\r\n * Performs a linear interpolation between two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec4} out\r\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  var aw = a[3];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  out[3] = aw + t * (b[3] - aw);\n  return out;\n}\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec4} out\r\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0; // Marsaglia, George. Choosing a Point from the Surface of a\n  // Sphere. Ann. Math. Statist. 43 (1972), no. 2, 645--646.\n  // http://projecteuclid.org/euclid.aoms/1177692644;\n\n  var v1, v2, v3, v4;\n  var s1, s2;\n\n  do {\n    v1 = glMatrix.RANDOM() * 2 - 1;\n    v2 = glMatrix.RANDOM() * 2 - 1;\n    s1 = v1 * v1 + v2 * v2;\n  } while (s1 >= 1);\n\n  do {\n    v3 = glMatrix.RANDOM() * 2 - 1;\n    v4 = glMatrix.RANDOM() * 2 - 1;\n    s2 = v3 * v3 + v4 * v4;\n  } while (s2 >= 1);\n\n  var d = Math.sqrt((1 - s1) / s2);\n  out[0] = scale * v1;\n  out[1] = scale * v2;\n  out[2] = scale * v3 * d;\n  out[3] = scale * v4 * d;\n  return out;\n}\n/**\r\n * Transforms the vec4 with a mat4.\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the vector to transform\r\n * @param {mat4} m matrix to transform with\r\n * @returns {vec4} out\r\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2],\n      w = a[3];\n  out[0] = m[0] * x + m[4] * y + m[8] * z + m[12] * w;\n  out[1] = m[1] * x + m[5] * y + m[9] * z + m[13] * w;\n  out[2] = m[2] * x + m[6] * y + m[10] * z + m[14] * w;\n  out[3] = m[3] * x + m[7] * y + m[11] * z + m[15] * w;\n  return out;\n}\n/**\r\n * Transforms the vec4 with a quat\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the vector to transform\r\n * @param {quat} q quaternion to transform with\r\n * @returns {vec4} out\r\n */\n\nexport function transformQuat(out, a, q) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3]; // calculate quat * vec\n\n  var ix = qw * x + qy * z - qz * y;\n  var iy = qw * y + qz * x - qx * z;\n  var iz = qw * z + qx * y - qy * x;\n  var iw = -qx * x - qy * y - qz * z; // calculate result * inverse quat\n\n  out[0] = ix * qw + iw * -qx + iy * -qz - iz * -qy;\n  out[1] = iy * qw + iw * -qy + iz * -qx - ix * -qz;\n  out[2] = iz * qw + iw * -qz + ix * -qy - iy * -qx;\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Set the components of a vec4 to zero\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @returns {vec4} out\r\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  return out;\n}\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {vec4} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\n\nexport function str(a) {\n  return 'vec4(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + a[3] + ')';\n}\n/**\r\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {vec4} a The first vector.\r\n * @param {vec4} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3];\n}\n/**\r\n * Returns whether or not the vectors have approximately the same elements in the same position.\r\n *\r\n * @param {vec4} a The first vector.\r\n * @param {vec4} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3));\n}\n/**\r\n * Alias for {@link vec4.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;\n/**\r\n * Alias for {@link vec4.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link vec4.divide}\r\n * @function\r\n */\n\nexport var div = divide;\n/**\r\n * Alias for {@link vec4.distance}\r\n * @function\r\n */\n\nexport var dist = distance;\n/**\r\n * Alias for {@link vec4.squaredDistance}\r\n * @function\r\n */\n\nexport var sqrDist = squaredDistance;\n/**\r\n * Alias for {@link vec4.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Alias for {@link vec4.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Perform some operation over an array of vec4s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec4. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec4s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 4;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      vec[3] = a[i + 3];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n      a[i + 3] = vec[3];\n    }\n\n    return a;\n  };\n}();","import * as glMatrix from \"./common.js\";\nimport * as mat3 from \"./mat3.js\";\nimport * as vec3 from \"./vec3.js\";\nimport * as vec4 from \"./vec4.js\";\n/**\r\n * Quaternion\r\n * @module quat\r\n */\n\n/**\r\n * Creates a new identity quat\r\n *\r\n * @returns {quat} a new quaternion\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(4);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n\n  out[3] = 1;\n  return out;\n}\n/**\r\n * Set a quat to the identity quaternion\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @returns {quat} out\r\n */\n\nexport function identity(out) {\n  out[0] = 0;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  return out;\n}\n/**\r\n * Sets a quat from the given angle and rotation axis,\r\n * then returns it.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {vec3} axis the axis around which to rotate\r\n * @param {Number} rad the angle in radians\r\n * @returns {quat} out\r\n **/\n\nexport function setAxisAngle(out, axis, rad) {\n  rad = rad * 0.5;\n  var s = Math.sin(rad);\n  out[0] = s * axis[0];\n  out[1] = s * axis[1];\n  out[2] = s * axis[2];\n  out[3] = Math.cos(rad);\n  return out;\n}\n/**\r\n * Gets the rotation axis and angle for a given\r\n *  quaternion. If a quaternion is created with\r\n *  setAxisAngle, this method will return the same\r\n *  values as providied in the original parameter list\r\n *  OR functionally equivalent values.\r\n * Example: The quaternion formed by axis [0, 0, 1] and\r\n *  angle -90 is the same as the quaternion formed by\r\n *  [0, 0, 1] and 270. This method favors the latter.\r\n * @param  {vec3} out_axis  Vector receiving the axis of rotation\r\n * @param  {quat} q     Quaternion to be decomposed\r\n * @return {Number}     Angle, in radians, of the rotation\r\n */\n\nexport function getAxisAngle(out_axis, q) {\n  var rad = Math.acos(q[3]) * 2.0;\n  var s = Math.sin(rad / 2.0);\n\n  if (s > glMatrix.EPSILON) {\n    out_axis[0] = q[0] / s;\n    out_axis[1] = q[1] / s;\n    out_axis[2] = q[2] / s;\n  } else {\n    // If s is zero, return any axis (no rotation - axis does not matter)\n    out_axis[0] = 1;\n    out_axis[1] = 0;\n    out_axis[2] = 0;\n  }\n\n  return rad;\n}\n/**\r\n * Gets the angular distance between two unit quaternions\r\n *\r\n * @param  {quat} a     Origin unit quaternion \r\n * @param  {quat} b     Destination unit quaternion\r\n * @return {Number}     Angle, in radians, between the two quaternions\r\n */\n\nexport function getAngle(a, b) {\n  var dotproduct = dot(a, b);\n  return Math.acos(2 * dotproduct * dotproduct - 1);\n}\n/**\r\n * Multiplies two quat's\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a the first operand\r\n * @param {quat} b the second operand\r\n * @returns {quat} out\r\n */\n\nexport function multiply(out, a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2],\n      bw = b[3];\n  out[0] = ax * bw + aw * bx + ay * bz - az * by;\n  out[1] = ay * bw + aw * by + az * bx - ax * bz;\n  out[2] = az * bw + aw * bz + ax * by - ay * bx;\n  out[3] = aw * bw - ax * bx - ay * by - az * bz;\n  return out;\n}\n/**\r\n * Rotates a quaternion by the given angle about the X axis\r\n *\r\n * @param {quat} out quat receiving operation result\r\n * @param {quat} a quat to rotate\r\n * @param {number} rad angle (in radians) to rotate\r\n * @returns {quat} out\r\n */\n\nexport function rotateX(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bx = Math.sin(rad),\n      bw = Math.cos(rad);\n  out[0] = ax * bw + aw * bx;\n  out[1] = ay * bw + az * bx;\n  out[2] = az * bw - ay * bx;\n  out[3] = aw * bw - ax * bx;\n  return out;\n}\n/**\r\n * Rotates a quaternion by the given angle about the Y axis\r\n *\r\n * @param {quat} out quat receiving operation result\r\n * @param {quat} a quat to rotate\r\n * @param {number} rad angle (in radians) to rotate\r\n * @returns {quat} out\r\n */\n\nexport function rotateY(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var by = Math.sin(rad),\n      bw = Math.cos(rad);\n  out[0] = ax * bw - az * by;\n  out[1] = ay * bw + aw * by;\n  out[2] = az * bw + ax * by;\n  out[3] = aw * bw - ay * by;\n  return out;\n}\n/**\r\n * Rotates a quaternion by the given angle about the Z axis\r\n *\r\n * @param {quat} out quat receiving operation result\r\n * @param {quat} a quat to rotate\r\n * @param {number} rad angle (in radians) to rotate\r\n * @returns {quat} out\r\n */\n\nexport function rotateZ(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bz = Math.sin(rad),\n      bw = Math.cos(rad);\n  out[0] = ax * bw + ay * bz;\n  out[1] = ay * bw - ax * bz;\n  out[2] = az * bw + aw * bz;\n  out[3] = aw * bw - az * bz;\n  return out;\n}\n/**\r\n * Calculates the W component of a quat from the X, Y, and Z components.\r\n * Assumes that quaternion is 1 unit in length.\r\n * Any existing W component will be ignored.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a quat to calculate W component of\r\n * @returns {quat} out\r\n */\n\nexport function calculateW(out, a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = Math.sqrt(Math.abs(1.0 - x * x - y * y - z * z));\n  return out;\n}\n/**\r\n * Calculate the exponential of a unit quaternion.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a quat to calculate the exponential of\r\n * @returns {quat} out\r\n */\n\nexport function exp(out, a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2],\n      w = a[3];\n  var r = Math.sqrt(x * x + y * y + z * z);\n  var et = Math.exp(w);\n  var s = r > 0 ? et * Math.sin(r) / r : 0;\n  out[0] = x * s;\n  out[1] = y * s;\n  out[2] = z * s;\n  out[3] = et * Math.cos(r);\n  return out;\n}\n/**\r\n * Calculate the natural logarithm of a unit quaternion.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a quat to calculate the exponential of\r\n * @returns {quat} out\r\n */\n\nexport function ln(out, a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2],\n      w = a[3];\n  var r = Math.sqrt(x * x + y * y + z * z);\n  var t = r > 0 ? Math.atan2(r, w) / r : 0;\n  out[0] = x * t;\n  out[1] = y * t;\n  out[2] = z * t;\n  out[3] = 0.5 * Math.log(x * x + y * y + z * z + w * w);\n  return out;\n}\n/**\r\n * Calculate the scalar power of a unit quaternion.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a quat to calculate the exponential of\r\n * @param {Number} b amount to scale the quaternion by\r\n * @returns {quat} out\r\n */\n\nexport function pow(out, a, b) {\n  ln(out, a);\n  scale(out, out, b);\n  exp(out, out);\n  return out;\n}\n/**\r\n * Performs a spherical linear interpolation between two quat\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a the first operand\r\n * @param {quat} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat} out\r\n */\n\nexport function slerp(out, a, b, t) {\n  // benchmarks:\n  //    http://jsperf.com/quaternion-slerp-implementations\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2],\n      bw = b[3];\n  var omega, cosom, sinom, scale0, scale1; // calc cosine\n\n  cosom = ax * bx + ay * by + az * bz + aw * bw; // adjust signs (if necessary)\n\n  if (cosom < 0.0) {\n    cosom = -cosom;\n    bx = -bx;\n    by = -by;\n    bz = -bz;\n    bw = -bw;\n  } // calculate coefficients\n\n\n  if (1.0 - cosom > glMatrix.EPSILON) {\n    // standard case (slerp)\n    omega = Math.acos(cosom);\n    sinom = Math.sin(omega);\n    scale0 = Math.sin((1.0 - t) * omega) / sinom;\n    scale1 = Math.sin(t * omega) / sinom;\n  } else {\n    // \"from\" and \"to\" quaternions are very close\n    //  ... so we can do a linear interpolation\n    scale0 = 1.0 - t;\n    scale1 = t;\n  } // calculate final values\n\n\n  out[0] = scale0 * ax + scale1 * bx;\n  out[1] = scale0 * ay + scale1 * by;\n  out[2] = scale0 * az + scale1 * bz;\n  out[3] = scale0 * aw + scale1 * bw;\n  return out;\n}\n/**\r\n * Generates a random unit quaternion\r\n * \r\n * @param {quat} out the receiving quaternion\r\n * @returns {quat} out\r\n */\n\nexport function random(out) {\n  // Implementation of http://planning.cs.uiuc.edu/node198.html\n  // TODO: Calling random 3 times is probably not the fastest solution\n  var u1 = glMatrix.RANDOM();\n  var u2 = glMatrix.RANDOM();\n  var u3 = glMatrix.RANDOM();\n  var sqrt1MinusU1 = Math.sqrt(1 - u1);\n  var sqrtU1 = Math.sqrt(u1);\n  out[0] = sqrt1MinusU1 * Math.sin(2.0 * Math.PI * u2);\n  out[1] = sqrt1MinusU1 * Math.cos(2.0 * Math.PI * u2);\n  out[2] = sqrtU1 * Math.sin(2.0 * Math.PI * u3);\n  out[3] = sqrtU1 * Math.cos(2.0 * Math.PI * u3);\n  return out;\n}\n/**\r\n * Calculates the inverse of a quat\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a quat to calculate inverse of\r\n * @returns {quat} out\r\n */\n\nexport function invert(out, a) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var dot = a0 * a0 + a1 * a1 + a2 * a2 + a3 * a3;\n  var invDot = dot ? 1.0 / dot : 0; // TODO: Would be faster to return [0,0,0,0] immediately if dot == 0\n\n  out[0] = -a0 * invDot;\n  out[1] = -a1 * invDot;\n  out[2] = -a2 * invDot;\n  out[3] = a3 * invDot;\n  return out;\n}\n/**\r\n * Calculates the conjugate of a quat\r\n * If the quaternion is normalized, this function is faster than quat.inverse and produces the same result.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a quat to calculate conjugate of\r\n * @returns {quat} out\r\n */\n\nexport function conjugate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\r\n * Creates a quaternion from the given 3x3 rotation matrix.\r\n *\r\n * NOTE: The resultant quaternion is not normalized, so you should be sure\r\n * to renormalize the quaternion yourself where necessary.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {mat3} m rotation matrix\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport function fromMat3(out, m) {\n  // Algorithm in Ken Shoemake's article in 1987 SIGGRAPH course notes\n  // article \"Quaternion Calculus and Fast Animation\".\n  var fTrace = m[0] + m[4] + m[8];\n  var fRoot;\n\n  if (fTrace > 0.0) {\n    // |w| > 1/2, may as well choose w > 1/2\n    fRoot = Math.sqrt(fTrace + 1.0); // 2w\n\n    out[3] = 0.5 * fRoot;\n    fRoot = 0.5 / fRoot; // 1/(4w)\n\n    out[0] = (m[5] - m[7]) * fRoot;\n    out[1] = (m[6] - m[2]) * fRoot;\n    out[2] = (m[1] - m[3]) * fRoot;\n  } else {\n    // |w| <= 1/2\n    var i = 0;\n    if (m[4] > m[0]) i = 1;\n    if (m[8] > m[i * 3 + i]) i = 2;\n    var j = (i + 1) % 3;\n    var k = (i + 2) % 3;\n    fRoot = Math.sqrt(m[i * 3 + i] - m[j * 3 + j] - m[k * 3 + k] + 1.0);\n    out[i] = 0.5 * fRoot;\n    fRoot = 0.5 / fRoot;\n    out[3] = (m[j * 3 + k] - m[k * 3 + j]) * fRoot;\n    out[j] = (m[j * 3 + i] + m[i * 3 + j]) * fRoot;\n    out[k] = (m[k * 3 + i] + m[i * 3 + k]) * fRoot;\n  }\n\n  return out;\n}\n/**\r\n * Creates a quaternion from the given euler angle x, y, z.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {x} Angle to rotate around X axis in degrees.\r\n * @param {y} Angle to rotate around Y axis in degrees.\r\n * @param {z} Angle to rotate around Z axis in degrees.\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport function fromEuler(out, x, y, z) {\n  var halfToRad = 0.5 * Math.PI / 180.0;\n  x *= halfToRad;\n  y *= halfToRad;\n  z *= halfToRad;\n  var sx = Math.sin(x);\n  var cx = Math.cos(x);\n  var sy = Math.sin(y);\n  var cy = Math.cos(y);\n  var sz = Math.sin(z);\n  var cz = Math.cos(z);\n  out[0] = sx * cy * cz - cx * sy * sz;\n  out[1] = cx * sy * cz + sx * cy * sz;\n  out[2] = cx * cy * sz - sx * sy * cz;\n  out[3] = cx * cy * cz + sx * sy * sz;\n  return out;\n}\n/**\r\n * Returns a string representation of a quatenion\r\n *\r\n * @param {quat} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\n\nexport function str(a) {\n  return 'quat(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + a[3] + ')';\n}\n/**\r\n * Creates a new quat initialized with values from an existing quaternion\r\n *\r\n * @param {quat} a quaternion to clone\r\n * @returns {quat} a new quaternion\r\n * @function\r\n */\n\nexport var clone = vec4.clone;\n/**\r\n * Creates a new quat initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {quat} a new quaternion\r\n * @function\r\n */\n\nexport var fromValues = vec4.fromValues;\n/**\r\n * Copy the values from one quat to another\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a the source quaternion\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var copy = vec4.copy;\n/**\r\n * Set the components of a quat to the given values\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var set = vec4.set;\n/**\r\n * Adds two quat's\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a the first operand\r\n * @param {quat} b the second operand\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var add = vec4.add;\n/**\r\n * Alias for {@link quat.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Scales a quat by a scalar number\r\n *\r\n * @param {quat} out the receiving vector\r\n * @param {quat} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var scale = vec4.scale;\n/**\r\n * Calculates the dot product of two quat's\r\n *\r\n * @param {quat} a the first operand\r\n * @param {quat} b the second operand\r\n * @returns {Number} dot product of a and b\r\n * @function\r\n */\n\nexport var dot = vec4.dot;\n/**\r\n * Performs a linear interpolation between two quat's\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a the first operand\r\n * @param {quat} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var lerp = vec4.lerp;\n/**\r\n * Calculates the length of a quat\r\n *\r\n * @param {quat} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\n\nexport var length = vec4.length;\n/**\r\n * Alias for {@link quat.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Calculates the squared length of a quat\r\n *\r\n * @param {quat} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n * @function\r\n */\n\nexport var squaredLength = vec4.squaredLength;\n/**\r\n * Alias for {@link quat.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Normalize a quat\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a quaternion to normalize\r\n * @returns {quat} out\r\n * @function\r\n */\n\nexport var normalize = vec4.normalize;\n/**\r\n * Returns whether or not the quaternions have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {quat} a The first quaternion.\r\n * @param {quat} b The second quaternion.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport var exactEquals = vec4.exactEquals;\n/**\r\n * Returns whether or not the quaternions have approximately the same elements in the same position.\r\n *\r\n * @param {quat} a The first vector.\r\n * @param {quat} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport var equals = vec4.equals;\n/**\r\n * Sets a quaternion to represent the shortest rotation from one\r\n * vector to another.\r\n *\r\n * Both vectors are assumed to be unit length.\r\n *\r\n * @param {quat} out the receiving quaternion.\r\n * @param {vec3} a the initial vector\r\n * @param {vec3} b the destination vector\r\n * @returns {quat} out\r\n */\n\nexport var rotationTo = function () {\n  var tmpvec3 = vec3.create();\n  var xUnitVec3 = vec3.fromValues(1, 0, 0);\n  var yUnitVec3 = vec3.fromValues(0, 1, 0);\n  return function (out, a, b) {\n    var dot = vec3.dot(a, b);\n\n    if (dot < -0.999999) {\n      vec3.cross(tmpvec3, xUnitVec3, a);\n      if (vec3.len(tmpvec3) < 0.000001) vec3.cross(tmpvec3, yUnitVec3, a);\n      vec3.normalize(tmpvec3, tmpvec3);\n      setAxisAngle(out, tmpvec3, Math.PI);\n      return out;\n    } else if (dot > 0.999999) {\n      out[0] = 0;\n      out[1] = 0;\n      out[2] = 0;\n      out[3] = 1;\n      return out;\n    } else {\n      vec3.cross(tmpvec3, a, b);\n      out[0] = tmpvec3[0];\n      out[1] = tmpvec3[1];\n      out[2] = tmpvec3[2];\n      out[3] = 1 + dot;\n      return normalize(out, out);\n    }\n  };\n}();\n/**\r\n * Performs a spherical linear interpolation with two control points\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a the first operand\r\n * @param {quat} b the second operand\r\n * @param {quat} c the third operand\r\n * @param {quat} d the fourth operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat} out\r\n */\n\nexport var sqlerp = function () {\n  var temp1 = create();\n  var temp2 = create();\n  return function (out, a, b, c, d, t) {\n    slerp(temp1, a, d, t);\n    slerp(temp2, b, c, t);\n    slerp(out, temp1, temp2, 2 * t * (1 - t));\n    return out;\n  };\n}();\n/**\r\n * Sets the specified quaternion with values corresponding to the given\r\n * axes. Each axis is a vec3 and is expected to be unit length and\r\n * perpendicular to all other specified axes.\r\n *\r\n * @param {vec3} view  the vector representing the viewing direction\r\n * @param {vec3} right the vector representing the local \"right\" direction\r\n * @param {vec3} up    the vector representing the local \"up\" direction\r\n * @returns {quat} out\r\n */\n\nexport var setAxes = function () {\n  var matr = mat3.create();\n  return function (out, view, right, up) {\n    matr[0] = right[0];\n    matr[3] = right[1];\n    matr[6] = right[2];\n    matr[1] = up[0];\n    matr[4] = up[1];\n    matr[7] = up[2];\n    matr[2] = -view[0];\n    matr[5] = -view[1];\n    matr[8] = -view[2];\n    return normalize(out, fromMat3(out, matr));\n  };\n}();","import * as glMatrix from \"./common.js\";\n/**\r\n * 3x3 Matrix\r\n * @module mat3\r\n */\n\n/**\r\n * Creates a new identity mat3\r\n *\r\n * @returns {mat3} a new 3x3 matrix\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(9);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[5] = 0;\n    out[6] = 0;\n    out[7] = 0;\n  }\n\n  out[0] = 1;\n  out[4] = 1;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Copies the upper-left 3x3 values into the given mat3.\r\n *\r\n * @param {mat3} out the receiving 3x3 matrix\r\n * @param {mat4} a   the source 4x4 matrix\r\n * @returns {mat3} out\r\n */\n\nexport function fromMat4(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[4];\n  out[4] = a[5];\n  out[5] = a[6];\n  out[6] = a[8];\n  out[7] = a[9];\n  out[8] = a[10];\n  return out;\n}\n/**\r\n * Creates a new mat3 initialized with values from an existing matrix\r\n *\r\n * @param {mat3} a matrix to clone\r\n * @returns {mat3} a new 3x3 matrix\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(9);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n/**\r\n * Copy the values from one mat3 to another\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the source matrix\r\n * @returns {mat3} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n/**\r\n * Create a new mat3 with the given values\r\n *\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 3)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 4)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 5)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 6)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 7)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 8)\r\n * @returns {mat3} A new mat3\r\n */\n\nexport function fromValues(m00, m01, m02, m10, m11, m12, m20, m21, m22) {\n  var out = new glMatrix.ARRAY_TYPE(9);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m10;\n  out[4] = m11;\n  out[5] = m12;\n  out[6] = m20;\n  out[7] = m21;\n  out[8] = m22;\n  return out;\n}\n/**\r\n * Set the components of a mat3 to the given values\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 3)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 4)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 5)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 6)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 7)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 8)\r\n * @returns {mat3} out\r\n */\n\nexport function set(out, m00, m01, m02, m10, m11, m12, m20, m21, m22) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m10;\n  out[4] = m11;\n  out[5] = m12;\n  out[6] = m20;\n  out[7] = m21;\n  out[8] = m22;\n  return out;\n}\n/**\r\n * Set a mat3 to the identity matrix\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @returns {mat3} out\r\n */\n\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 1;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Transpose the values of a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the source matrix\r\n * @returns {mat3} out\r\n */\n\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    var a01 = a[1],\n        a02 = a[2],\n        a12 = a[5];\n    out[1] = a[3];\n    out[2] = a[6];\n    out[3] = a01;\n    out[5] = a[7];\n    out[6] = a02;\n    out[7] = a12;\n  } else {\n    out[0] = a[0];\n    out[1] = a[3];\n    out[2] = a[6];\n    out[3] = a[1];\n    out[4] = a[4];\n    out[5] = a[7];\n    out[6] = a[2];\n    out[7] = a[5];\n    out[8] = a[8];\n  }\n\n  return out;\n}\n/**\r\n * Inverts a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the source matrix\r\n * @returns {mat3} out\r\n */\n\nexport function invert(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  var b01 = a22 * a11 - a12 * a21;\n  var b11 = -a22 * a10 + a12 * a20;\n  var b21 = a21 * a10 - a11 * a20; // Calculate the determinant\n\n  var det = a00 * b01 + a01 * b11 + a02 * b21;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = b01 * det;\n  out[1] = (-a22 * a01 + a02 * a21) * det;\n  out[2] = (a12 * a01 - a02 * a11) * det;\n  out[3] = b11 * det;\n  out[4] = (a22 * a00 - a02 * a20) * det;\n  out[5] = (-a12 * a00 + a02 * a10) * det;\n  out[6] = b21 * det;\n  out[7] = (-a21 * a00 + a01 * a20) * det;\n  out[8] = (a11 * a00 - a01 * a10) * det;\n  return out;\n}\n/**\r\n * Calculates the adjugate of a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the source matrix\r\n * @returns {mat3} out\r\n */\n\nexport function adjoint(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  out[0] = a11 * a22 - a12 * a21;\n  out[1] = a02 * a21 - a01 * a22;\n  out[2] = a01 * a12 - a02 * a11;\n  out[3] = a12 * a20 - a10 * a22;\n  out[4] = a00 * a22 - a02 * a20;\n  out[5] = a02 * a10 - a00 * a12;\n  out[6] = a10 * a21 - a11 * a20;\n  out[7] = a01 * a20 - a00 * a21;\n  out[8] = a00 * a11 - a01 * a10;\n  return out;\n}\n/**\r\n * Calculates the determinant of a mat3\r\n *\r\n * @param {mat3} a the source matrix\r\n * @returns {Number} determinant of a\r\n */\n\nexport function determinant(a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  return a00 * (a22 * a11 - a12 * a21) + a01 * (-a22 * a10 + a12 * a20) + a02 * (a21 * a10 - a11 * a20);\n}\n/**\r\n * Multiplies two mat3's\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the first operand\r\n * @param {mat3} b the second operand\r\n * @returns {mat3} out\r\n */\n\nexport function multiply(out, a, b) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  var b00 = b[0],\n      b01 = b[1],\n      b02 = b[2];\n  var b10 = b[3],\n      b11 = b[4],\n      b12 = b[5];\n  var b20 = b[6],\n      b21 = b[7],\n      b22 = b[8];\n  out[0] = b00 * a00 + b01 * a10 + b02 * a20;\n  out[1] = b00 * a01 + b01 * a11 + b02 * a21;\n  out[2] = b00 * a02 + b01 * a12 + b02 * a22;\n  out[3] = b10 * a00 + b11 * a10 + b12 * a20;\n  out[4] = b10 * a01 + b11 * a11 + b12 * a21;\n  out[5] = b10 * a02 + b11 * a12 + b12 * a22;\n  out[6] = b20 * a00 + b21 * a10 + b22 * a20;\n  out[7] = b20 * a01 + b21 * a11 + b22 * a21;\n  out[8] = b20 * a02 + b21 * a12 + b22 * a22;\n  return out;\n}\n/**\r\n * Translate a mat3 by the given vector\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the matrix to translate\r\n * @param {vec2} v vector to translate by\r\n * @returns {mat3} out\r\n */\n\nexport function translate(out, a, v) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a10 = a[3],\n      a11 = a[4],\n      a12 = a[5],\n      a20 = a[6],\n      a21 = a[7],\n      a22 = a[8],\n      x = v[0],\n      y = v[1];\n  out[0] = a00;\n  out[1] = a01;\n  out[2] = a02;\n  out[3] = a10;\n  out[4] = a11;\n  out[5] = a12;\n  out[6] = x * a00 + y * a10 + a20;\n  out[7] = x * a01 + y * a11 + a21;\n  out[8] = x * a02 + y * a12 + a22;\n  return out;\n}\n/**\r\n * Rotates a mat3 by the given angle\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat3} out\r\n */\n\nexport function rotate(out, a, rad) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a10 = a[3],\n      a11 = a[4],\n      a12 = a[5],\n      a20 = a[6],\n      a21 = a[7],\n      a22 = a[8],\n      s = Math.sin(rad),\n      c = Math.cos(rad);\n  out[0] = c * a00 + s * a10;\n  out[1] = c * a01 + s * a11;\n  out[2] = c * a02 + s * a12;\n  out[3] = c * a10 - s * a00;\n  out[4] = c * a11 - s * a01;\n  out[5] = c * a12 - s * a02;\n  out[6] = a20;\n  out[7] = a21;\n  out[8] = a22;\n  return out;\n}\n;\n/**\r\n * Scales the mat3 by the dimensions in the given vec2\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the matrix to rotate\r\n * @param {vec2} v the vec2 to scale the matrix by\r\n * @returns {mat3} out\r\n **/\n\nexport function scale(out, a, v) {\n  var x = v[0],\n      y = v[1];\n  out[0] = x * a[0];\n  out[1] = x * a[1];\n  out[2] = x * a[2];\n  out[3] = y * a[3];\n  out[4] = y * a[4];\n  out[5] = y * a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n/**\r\n * Creates a matrix from a vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat3.identity(dest);\r\n *     mat3.translate(dest, dest, vec);\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {vec2} v Translation vector\r\n * @returns {mat3} out\r\n */\n\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 1;\n  out[5] = 0;\n  out[6] = v[0];\n  out[7] = v[1];\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a given angle\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat3.identity(dest);\r\n *     mat3.rotate(dest, dest, rad);\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat3} out\r\n */\n\nexport function fromRotation(out, rad) {\n  var s = Math.sin(rad),\n      c = Math.cos(rad);\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n  out[3] = -s;\n  out[4] = c;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Creates a matrix from a vector scaling\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat3.identity(dest);\r\n *     mat3.scale(dest, dest, vec);\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {vec2} v Scaling vector\r\n * @returns {mat3} out\r\n */\n\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = v[1];\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Copies the values from a mat2d into a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat2d} a the matrix to copy\r\n * @returns {mat3} out\r\n **/\n\nexport function fromMat2d(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = 0;\n  out[3] = a[2];\n  out[4] = a[3];\n  out[5] = 0;\n  out[6] = a[4];\n  out[7] = a[5];\n  out[8] = 1;\n  return out;\n}\n/**\r\n* Calculates a 3x3 matrix from the given quaternion\r\n*\r\n* @param {mat3} out mat3 receiving operation result\r\n* @param {quat} q Quaternion to create matrix from\r\n*\r\n* @returns {mat3} out\r\n*/\n\nexport function fromQuat(out, q) {\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var yx = y * x2;\n  var yy = y * y2;\n  var zx = z * x2;\n  var zy = z * y2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[3] = yx - wz;\n  out[6] = zx + wy;\n  out[1] = yx + wz;\n  out[4] = 1 - xx - zz;\n  out[7] = zy - wx;\n  out[2] = zx - wy;\n  out[5] = zy + wx;\n  out[8] = 1 - xx - yy;\n  return out;\n}\n/**\r\n* Calculates a 3x3 normal matrix (transpose inverse) from the 4x4 matrix\r\n*\r\n* @param {mat3} out mat3 receiving operation result\r\n* @param {mat4} a Mat4 to derive the normal matrix from\r\n*\r\n* @returns {mat3} out\r\n*/\n\nexport function normalFromMat4(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[2] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[3] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[4] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[5] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[6] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[7] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[8] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  return out;\n}\n/**\r\n * Generates a 2D projection matrix with the given bounds\r\n *\r\n * @param {mat3} out mat3 frustum matrix will be written into\r\n * @param {number} width Width of your gl context\r\n * @param {number} height Height of gl context\r\n * @returns {mat3} out\r\n */\n\nexport function projection(out, width, height) {\n  out[0] = 2 / width;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -2 / height;\n  out[5] = 0;\n  out[6] = -1;\n  out[7] = 1;\n  out[8] = 1;\n  return out;\n}\n/**\r\n * Returns a string representation of a mat3\r\n *\r\n * @param {mat3} a matrix to represent as a string\r\n * @returns {String} string representation of the matrix\r\n */\n\nexport function str(a) {\n  return 'mat3(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + a[3] + ', ' + a[4] + ', ' + a[5] + ', ' + a[6] + ', ' + a[7] + ', ' + a[8] + ')';\n}\n/**\r\n * Returns Frobenius norm of a mat3\r\n *\r\n * @param {mat3} a the matrix to calculate Frobenius norm of\r\n * @returns {Number} Frobenius norm\r\n */\n\nexport function frob(a) {\n  return Math.hypot(a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8]);\n}\n/**\r\n * Adds two mat3's\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the first operand\r\n * @param {mat3} b the second operand\r\n * @returns {mat3} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  return out;\n}\n/**\r\n * Subtracts matrix b from matrix a\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the first operand\r\n * @param {mat3} b the second operand\r\n * @returns {mat3} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  return out;\n}\n/**\r\n * Multiply each element of the matrix by a scalar.\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the matrix to scale\r\n * @param {Number} b amount to scale the matrix's elements by\r\n * @returns {mat3} out\r\n */\n\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  return out;\n}\n/**\r\n * Adds two mat3's after multiplying each element of the second operand by a scalar value.\r\n *\r\n * @param {mat3} out the receiving vector\r\n * @param {mat3} a the first operand\r\n * @param {mat3} b the second operand\r\n * @param {Number} scale the amount to scale b's elements by before adding\r\n * @returns {mat3} out\r\n */\n\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  return out;\n}\n/**\r\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {mat3} a The first matrix.\r\n * @param {mat3} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8];\n}\n/**\r\n * Returns whether or not the matrices have approximately the same elements in the same position.\r\n *\r\n * @param {mat3} a The first matrix.\r\n * @param {mat3} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3],\n      a4 = a[4],\n      a5 = a[5],\n      a6 = a[6],\n      a7 = a[7],\n      a8 = a[8];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3],\n      b4 = b[4],\n      b5 = b[5],\n      b6 = b[6],\n      b7 = b[7],\n      b8 = b[8];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8));\n}\n/**\r\n * Alias for {@link mat3.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link mat3.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;","import * as glMatrix from \"./common.js\";\n/**\r\n * 2 Dimensional Vector\r\n * @module vec2\r\n */\n\n/**\r\n * Creates a new, empty vec2\r\n *\r\n * @returns {vec2} a new 2D vector\r\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(2);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n  }\n\n  return out;\n}\n/**\r\n * Creates a new vec2 initialized with values from an existing vector\r\n *\r\n * @param {vec2} a vector to clone\r\n * @returns {vec2} a new 2D vector\r\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(2);\n  out[0] = a[0];\n  out[1] = a[1];\n  return out;\n}\n/**\r\n * Creates a new vec2 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @returns {vec2} a new 2D vector\r\n */\n\nexport function fromValues(x, y) {\n  var out = new glMatrix.ARRAY_TYPE(2);\n  out[0] = x;\n  out[1] = y;\n  return out;\n}\n/**\r\n * Copy the values from one vec2 to another\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the source vector\r\n * @returns {vec2} out\r\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  return out;\n}\n/**\r\n * Set the components of a vec2 to the given values\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @returns {vec2} out\r\n */\n\nexport function set(out, x, y) {\n  out[0] = x;\n  out[1] = y;\n  return out;\n}\n/**\r\n * Adds two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  return out;\n}\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  return out;\n}\n/**\r\n * Multiplies two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  return out;\n}\n/**\r\n * Divides two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  return out;\n}\n/**\r\n * Math.ceil the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a vector to ceil\r\n * @returns {vec2} out\r\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  return out;\n}\n/**\r\n * Math.floor the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a vector to floor\r\n * @returns {vec2} out\r\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  return out;\n}\n/**\r\n * Returns the minimum of two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  return out;\n}\n/**\r\n * Returns the maximum of two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {vec2} out\r\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  return out;\n}\n/**\r\n * Math.round the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a vector to round\r\n * @returns {vec2} out\r\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  return out;\n}\n/**\r\n * Scales a vec2 by a scalar number\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec2} out\r\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  return out;\n}\n/**\r\n * Adds two vec2's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec2} out\r\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  return out;\n}\n/**\r\n * Calculates the euclidian distance between two vec2's\r\n *\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0],\n      y = b[1] - a[1];\n  return Math.hypot(x, y);\n}\n/**\r\n * Calculates the squared euclidian distance between two vec2's\r\n *\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0],\n      y = b[1] - a[1];\n  return x * x + y * y;\n}\n/**\r\n * Calculates the length of a vec2\r\n *\r\n * @param {vec2} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\n\nexport function length(a) {\n  var x = a[0],\n      y = a[1];\n  return Math.hypot(x, y);\n}\n/**\r\n * Calculates the squared length of a vec2\r\n *\r\n * @param {vec2} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\n\nexport function squaredLength(a) {\n  var x = a[0],\n      y = a[1];\n  return x * x + y * y;\n}\n/**\r\n * Negates the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a vector to negate\r\n * @returns {vec2} out\r\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  return out;\n}\n/**\r\n * Returns the inverse of the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a vector to invert\r\n * @returns {vec2} out\r\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  return out;\n}\n/**\r\n * Normalize a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a vector to normalize\r\n * @returns {vec2} out\r\n */\n\nexport function normalize(out, a) {\n  var x = a[0],\n      y = a[1];\n  var len = x * x + y * y;\n\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  return out;\n}\n/**\r\n * Calculates the dot product of two vec2's\r\n *\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1];\n}\n/**\r\n * Computes the cross product of two vec2's\r\n * Note that the cross product must by definition produce a 3D vector\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {vec3} out\r\n */\n\nexport function cross(out, a, b) {\n  var z = a[0] * b[1] - a[1] * b[0];\n  out[0] = out[1] = 0;\n  out[2] = z;\n  return out;\n}\n/**\r\n * Performs a linear interpolation between two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec2} out\r\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0],\n      ay = a[1];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  return out;\n}\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec2} out\r\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0;\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  out[0] = Math.cos(r) * scale;\n  out[1] = Math.sin(r) * scale;\n  return out;\n}\n/**\r\n * Transforms the vec2 with a mat2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the vector to transform\r\n * @param {mat2} m matrix to transform with\r\n * @returns {vec2} out\r\n */\n\nexport function transformMat2(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[2] * y;\n  out[1] = m[1] * x + m[3] * y;\n  return out;\n}\n/**\r\n * Transforms the vec2 with a mat2d\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the vector to transform\r\n * @param {mat2d} m matrix to transform with\r\n * @returns {vec2} out\r\n */\n\nexport function transformMat2d(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[2] * y + m[4];\n  out[1] = m[1] * x + m[3] * y + m[5];\n  return out;\n}\n/**\r\n * Transforms the vec2 with a mat3\r\n * 3rd vector component is implicitly '1'\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the vector to transform\r\n * @param {mat3} m matrix to transform with\r\n * @returns {vec2} out\r\n */\n\nexport function transformMat3(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[3] * y + m[6];\n  out[1] = m[1] * x + m[4] * y + m[7];\n  return out;\n}\n/**\r\n * Transforms the vec2 with a mat4\r\n * 3rd vector component is implicitly '0'\r\n * 4th vector component is implicitly '1'\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the vector to transform\r\n * @param {mat4} m matrix to transform with\r\n * @returns {vec2} out\r\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0];\n  var y = a[1];\n  out[0] = m[0] * x + m[4] * y + m[12];\n  out[1] = m[1] * x + m[5] * y + m[13];\n  return out;\n}\n/**\r\n * Rotate a 2D vector\r\n * @param {vec2} out The receiving vec2\r\n * @param {vec2} a The vec2 point to rotate\r\n * @param {vec2} b The origin of the rotation\r\n * @param {Number} c The angle of rotation\r\n * @returns {vec2} out\r\n */\n\nexport function rotate(out, a, b, c) {\n  //Translate point to the origin\n  var p0 = a[0] - b[0],\n      p1 = a[1] - b[1],\n      sinC = Math.sin(c),\n      cosC = Math.cos(c); //perform rotation and translate to correct position\n\n  out[0] = p0 * cosC - p1 * sinC + b[0];\n  out[1] = p0 * sinC + p1 * cosC + b[1];\n  return out;\n}\n/**\r\n * Get the angle between two 2D vectors\r\n * @param {vec2} a The first operand\r\n * @param {vec2} b The second operand\r\n * @returns {Number} The angle in radians\r\n */\n\nexport function angle(a, b) {\n  var x1 = a[0],\n      y1 = a[1],\n      x2 = b[0],\n      y2 = b[1];\n  var len1 = x1 * x1 + y1 * y1;\n\n  if (len1 > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len1 = 1 / Math.sqrt(len1);\n  }\n\n  var len2 = x2 * x2 + y2 * y2;\n\n  if (len2 > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len2 = 1 / Math.sqrt(len2);\n  }\n\n  var cosine = (x1 * x2 + y1 * y2) * len1 * len2;\n\n  if (cosine > 1.0) {\n    return 0;\n  } else if (cosine < -1.0) {\n    return Math.PI;\n  } else {\n    return Math.acos(cosine);\n  }\n}\n/**\r\n * Set the components of a vec2 to zero\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @returns {vec2} out\r\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  return out;\n}\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {vec2} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\n\nexport function str(a) {\n  return 'vec2(' + a[0] + ', ' + a[1] + ')';\n}\n/**\r\n * Returns whether or not the vectors exactly have the same elements in the same position (when compared with ===)\r\n *\r\n * @param {vec2} a The first vector.\r\n * @param {vec2} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1];\n}\n/**\r\n * Returns whether or not the vectors have approximately the same elements in the same position.\r\n *\r\n * @param {vec2} a The first vector.\r\n * @param {vec2} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1];\n  var b0 = b[0],\n      b1 = b[1];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1));\n}\n/**\r\n * Alias for {@link vec2.length}\r\n * @function\r\n */\n\nexport var len = length;\n/**\r\n * Alias for {@link vec2.subtract}\r\n * @function\r\n */\n\nexport var sub = subtract;\n/**\r\n * Alias for {@link vec2.multiply}\r\n * @function\r\n */\n\nexport var mul = multiply;\n/**\r\n * Alias for {@link vec2.divide}\r\n * @function\r\n */\n\nexport var div = divide;\n/**\r\n * Alias for {@link vec2.distance}\r\n * @function\r\n */\n\nexport var dist = distance;\n/**\r\n * Alias for {@link vec2.squaredDistance}\r\n * @function\r\n */\n\nexport var sqrDist = squaredDistance;\n/**\r\n * Alias for {@link vec2.squaredLength}\r\n * @function\r\n */\n\nexport var sqrLen = squaredLength;\n/**\r\n * Perform some operation over an array of vec2s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec2. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec2s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 2;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n    }\n\n    return a;\n  };\n}();","export function degrees2radians(degrees) {\n  return (degrees * Math.PI) / 180;\n}\n\nexport function radians2degrees(rads) {\n  return (rads * 180) / Math.PI;\n}\n","const EVENTS = {\n  VIEWPORT_ROTATED: 'viewportRotated',\n};\n\nexport default EVENTS;\n","import { vec3, mat4, quat } from 'gl-matrix';\nimport { degrees2radians } from '../lib/math/angles.js';\nimport EVENTS from '../events.js';\n\nfunction validateNumber(numberValue) {\n  if (\n    typeof numberValue === 'number' &&\n    numberValue === Number(numberValue) &&\n    Number.isFinite(numberValue)\n  ) {\n    return;\n  }\n\n  throw `Invalid number ${numberValue}`;\n}\n\nfunction createNewViewportData() {\n  return {\n    viewUp: [0, 1, 0],\n    sliceNormal: [0, 0, 1],\n  };\n}\n\nexport default class {\n  _state = null;\n  eventWindow;\n  constructor(eventWindow, state = null) {\n    this.eventWindow = eventWindow;\n\n    if (this._state === null) {\n      this._state = createNewViewportData();\n    } else {\n      this._state = JSON.parse(JSON.stringify(state));\n    }\n\n    // copy the state to a cache, so we can modify internally,\n    // but remember the original values for absolute rotations\n    this._state.cache = {\n      ...this._state,\n    };\n  }\n\n  getEventWindow = () => {\n    return this.eventWindow;\n  };\n\n  _rotate = (viewUp, sliceNormal, dThetaX, dThetaY, dThetaZ = 0) => {\n    validateNumber(dThetaX);\n    validateNumber(dThetaY);\n    validateNumber(dThetaZ);\n\n    let xAxis = [];\n    vec3.cross(xAxis, viewUp, sliceNormal);\n    vec3.normalize(xAxis, xAxis);\n\n    let yAxis = viewUp;\n    // rotate around the vector of the cross product of the\n    // plane and viewup as the X component\n\n    const nSliceNormal = [];\n    const nViewUp = [];\n\n    const planeMat = mat4.create();\n\n    // Rotate around the vertical (slice-up) vector\n    mat4.rotate(planeMat, planeMat, degrees2radians(dThetaY), yAxis);\n\n    // Rotate around the horizontal (screen-x) vector\n    mat4.rotate(planeMat, planeMat, degrees2radians(dThetaX), xAxis);\n\n    vec3.transformMat4(nSliceNormal, sliceNormal, planeMat);\n    vec3.transformMat4(nViewUp, viewUp, planeMat);\n\n    if (dThetaZ !== 0) {\n      // Rotate the viewUp in 90 degree increments\n      const zRotQuat = quat.create();\n      // Use negative degrees clockwise rotation since the axis should really be the direction of projection, which is the negative of the plane normal\n      quat.setAxisAngle(zRotQuat, nSliceNormal, degrees2radians(-dThetaZ));\n      quat.normalize(zRotQuat, zRotQuat);\n\n      // rotate the ViewUp with the z rotation\n      vec3.transformQuat(nViewUp, nViewUp, zRotQuat);\n    }\n\n    this._state.cache.sliceNormal = nSliceNormal;\n    this._state.cache.viewUp = nViewUp;\n\n    var event = new CustomEvent(EVENTS.VIEWPORT_ROTATED, {\n      detail: {\n        sliceNormal: nSliceNormal,\n        sliceViewUp: nViewUp,\n        dThetaX,\n        dThetaY,\n        dThetaZ,\n      },\n      bubbles: true,\n      cancelable: true,\n    });\n\n    this.eventWindow.dispatchEvent(event);\n  };\n\n  rotateAbsolute = (dThetaX, dThetaY, dThetaZ = 0) => {\n    this._rotate(\n      this._state.viewUp,\n      this._state.sliceNormal,\n      dThetaX,\n      dThetaY,\n      dThetaZ\n    );\n  };\n  rotateRelative = (dThetaX, dThetaY, dThetaZ = 0) => {\n    this._rotate(\n      this._state.cache.viewUp,\n      this._state.cache.sliceNormal,\n      dThetaX,\n      dThetaY,\n      dThetaZ\n    );\n  };\n\n  setOrientation = (sliceNormal, viewUp = [0, 1, 0]) => {\n    this._state.sliceNormal = [...sliceNormal];\n    this._state.viewUp = [...viewUp];\n    this._state.cache.sliceNormal = [...sliceNormal];\n    this._state.cache.viewUp = [...viewUp];\n  };\n\n  getViewUp = () => {\n    return this._state.viewUp;\n  };\n\n  getSliceNormal = () => {\n    return this._state.sliceNormal;\n  };\n\n  getCurrentViewUp = () => {\n    return this._state.cache.viewUp;\n  };\n\n  getCurrentSliceNormal = () => {\n    return this._state.cache.sliceNormal;\n  };\n\n  getReadOnlyViewPort = () => {\n    const readOnlyState = JSON.parse(JSON.stringify(this._state));\n\n    Object.freeze(readOnlyState);\n\n    return readOnlyState;\n  };\n}\n","import macro from 'vtk.js/Sources/macro';\nimport vtkMath from 'vtk.js/Sources/Common/Core/Math';\nimport vtkMatrixBuilder from 'vtk.js/Sources/Common/Core/MatrixBuilder';\nimport vtkInteractorStyleManipulator from 'vtk.js/Sources/Interaction/Style/InteractorStyleManipulator';\nimport vtkMouseCameraTrackballRotateManipulator from 'vtk.js/Sources/Interaction/Manipulators/MouseCameraTrackballRotateManipulator';\nimport vtkMouseCameraTrackballPanManipulator from 'vtk.js/Sources/Interaction/Manipulators/MouseCameraTrackballPanManipulator';\nimport vtkMouseCameraTrackballZoomManipulator from 'vtk.js/Sources/Interaction/Manipulators/MouseCameraTrackballZoomManipulator';\nimport vtkMouseRangeManipulator from 'vtk.js/Sources/Interaction/Manipulators/MouseRangeManipulator';\nimport vtkCoordinate from 'vtk.js/Sources/Rendering/Core/Coordinate';\nimport Constants from 'vtk.js/Sources/Rendering/Core/InteractorStyle/Constants';\nimport ViewportData from './ViewportData';\nimport EVENTS from '../events';\n\nconst { States } = Constants;\n\n// ----------------------------------------------------------------------------\n// Global methods\n// ----------------------------------------------------------------------------\n\nfunction boundsToCorners(bounds) {\n  return [\n    [bounds[0], bounds[2], bounds[4]],\n    [bounds[0], bounds[2], bounds[5]],\n    [bounds[0], bounds[3], bounds[4]],\n    [bounds[0], bounds[3], bounds[5]],\n    [bounds[1], bounds[2], bounds[4]],\n    [bounds[1], bounds[2], bounds[5]],\n    [bounds[1], bounds[3], bounds[4]],\n    [bounds[1], bounds[3], bounds[5]],\n  ];\n}\n\n// ----------------------------------------------------------------------------\n\nfunction clamp(value, min, max) {\n  if (value < min) {\n    return min;\n  }\n  if (value > max) {\n    return max;\n  }\n  return value;\n}\n\n// ----------------------------------------------------------------------------\n// vtkInteractorStyleMPRSlice methods\n// ----------------------------------------------------------------------------\n\nfunction vtkInteractorStyleMPRSlice(publicAPI, model) {\n  // Set our className\n  model.classHierarchy.push('vtkInteractorStyleMPRSlice');\n\n  model.trackballManipulator = vtkMouseCameraTrackballRotateManipulator.newInstance(\n    {\n      button: 1,\n    }\n  );\n  model.panManipulator = vtkMouseCameraTrackballPanManipulator.newInstance({\n    button: 2,\n  });\n  model.zoomManipulator = vtkMouseCameraTrackballZoomManipulator.newInstance({\n    button: 3,\n  });\n\n  model.scrollManipulator = vtkMouseRangeManipulator.newInstance({\n    scrollEnabled: true,\n    dragEnabled: false,\n  });\n\n  // cache for sliceRange\n  const cache = {\n    sliceNormal: [0, 0, 0],\n    sliceRange: [0, 0],\n    sliceCenter: [],\n  };\n\n  publicAPI.updateScrollManipulator = () => {\n    const range = publicAPI.getSliceRange();\n    model.scrollManipulator.removeScrollListener();\n    // The Scroll listener has min, max, step, and getValue setValue as params.\n    // Internally, it checks that the result of the GET has changed, and only calls SET if it is new.\n    model.scrollManipulator.setScrollListener(\n      range[0],\n      range[1],\n      1,\n      publicAPI.getSlice,\n      publicAPI.scrollToSlice\n    );\n  };\n\n  function setManipulators() {\n    publicAPI.removeAllMouseManipulators();\n    publicAPI.addMouseManipulator(model.trackballManipulator);\n    publicAPI.addMouseManipulator(model.panManipulator);\n    publicAPI.addMouseManipulator(model.zoomManipulator);\n    publicAPI.addMouseManipulator(model.scrollManipulator);\n    publicAPI.updateScrollManipulator();\n  }\n\n  function isCameraViewInitialized(camera) {\n    const dist = camera.getDistance();\n\n    return (\n      typeof dist === 'number' && dist === Number(dist) && Number.isFinite(dist)\n    );\n  }\n\n  function onRotateChanged(event) {\n    setSliceNormalInternal(event.detail.sliceNormal);\n    setViewUpInternal(event.detail.sliceViewUp);\n  }\n\n  function setViewUpInternal(viewUp) {\n    const renderer = model.interactor.getCurrentRenderer();\n    const camera = renderer.getActiveCamera();\n    camera.setViewUp(...viewUp);\n  }\n\n  // in world space\n  function setSliceNormalInternal(normal) {\n    const renderer = model.interactor.getCurrentRenderer();\n    const camera = renderer.getActiveCamera();\n\n    //copy arguments for internal editing so we don't cause sideeffects\n    const _normal = [...normal];\n\n    if (model.volumeActor) {\n      vtkMath.normalize(_normal);\n\n      let center = camera.getFocalPoint();\n      let dist = camera.getDistance();\n      let angle = camera.getViewAngle();\n\n      if (!isCameraViewInitialized(camera)) {\n        const bounds = model.volumeActor.getMapper().getBounds();\n        // diagonal will be used as \"width\" of camera scene\n        const diagonal = Math.sqrt(\n          vtkMath.distance2BetweenPoints(\n            [bounds[0], bounds[2], bounds[4]],\n            [bounds[1], bounds[3], bounds[5]]\n          )\n        );\n\n        // center will be used as initial focal point\n        center = [\n          (bounds[0] + bounds[1]) / 2.0,\n          (bounds[2] + bounds[3]) / 2.0,\n          (bounds[4] + bounds[5]) / 2.0,\n        ];\n\n        angle = 90;\n\n        // distance from camera to focal point\n        dist = diagonal / (2 * Math.tan((angle / 360) * Math.PI));\n      }\n\n      const cameraPos = [\n        center[0] - _normal[0] * dist,\n        center[1] - _normal[1] * dist,\n        center[2] - _normal[2] * dist,\n      ];\n\n      camera.setPosition(...cameraPos);\n      camera.setDistance(dist);\n      // should be set after pos and distance\n      camera.setDirectionOfProjection(..._normal);\n      camera.setViewAngle(angle);\n\n      camera.setThicknessFromFocalPoint(model.slabThickness);\n\n      publicAPI.setCenterOfRotation(center);\n    }\n  }\n\n  publicAPI.setViewport = viewportData => {\n    if (model.viewportData) {\n      const oldWindow = model.viewportData.getEventWindow();\n\n      oldWindow.removeEventListener(EVENTS.VIEWPORT_ROTATED, onRotateChanged);\n    }\n\n    model.viewportData = viewportData;\n\n    if (model.scrollManipulator.setViewportData) {\n      // scroll manipulator is the custom MouseRangeRotate manipulator\n      model.scrollManipulator.setViewportData(viewportData);\n    }\n\n    if (viewportData) {\n      setSliceNormalInternal(viewportData.getCurrentSliceNormal());\n      setViewUpInternal(viewportData.getCurrentViewUp());\n\n      viewportData\n        .getEventWindow()\n        .addEventListener(EVENTS.VIEWPORT_ROTATED, onRotateChanged);\n    }\n  };\n\n  publicAPI.getViewport = () => model.viewportData;\n\n  let cameraSub = null;\n  let interactorSub = null;\n  const superSetInteractor = publicAPI.setInteractor;\n\n  publicAPI.setInteractor = interactor => {\n    superSetInteractor(interactor);\n\n    if (cameraSub) {\n      cameraSub.unsubscribe();\n      cameraSub = null;\n    }\n\n    if (interactorSub) {\n      interactorSub.unsubscribe();\n      interactorSub = null;\n    }\n\n    if (interactor) {\n      const renderer = interactor.getCurrentRenderer();\n      const camera = renderer.getActiveCamera();\n\n      cameraSub = camera.onModified(() => {\n        publicAPI.updateScrollManipulator();\n        publicAPI.modified();\n      });\n\n      interactorSub = interactor.onAnimation(() => {\n        camera.setThicknessFromFocalPoint(model.slabThickness);\n      });\n\n      const eventWindow = model.interactor.getContainer();\n\n      publicAPI.setViewport(new ViewportData(eventWindow));\n    } else {\n      publicAPI.setViewport(null);\n    }\n  };\n\n  // TODO -> When we want a modular framework we'll have to rethink all this.\n  // TODO -> We need to think of a more generic way to do this for all widget types eventually.\n  // TODO -> We certainly need to be able to register widget types on instantiation.\n  function handleButtonPress(callData) {\n    const { apis, apiIndex } = model;\n\n    if (apis && apis[apiIndex] && apis[apiIndex].type === 'VIEW2D') {\n      publicAPI.startPan();\n\n      const api = apis[apiIndex];\n\n      if (api.svgWidgets.crosshairsWidget) {\n        api.svgWidgets.crosshairsWidget.updateCrosshairForApi(api);\n      }\n      if (api.svgWidgets.rotatableCrosshairsWidget) {\n        updateRotatableCrosshairs(callData);\n      }\n    }\n  }\n\n  function updateRotatableCrosshairs() {\n    const { apis, apiIndex } = model;\n    const thisApi = apis[apiIndex];\n    const { rotatableCrosshairsWidget } = thisApi.svgWidgets;\n    const worldPos = thisApi.get('cachedCrosshairWorldPosition');\n\n    rotatableCrosshairsWidget.moveCrosshairs(worldPos, apis, apiIndex);\n  }\n\n  publicAPI.handleMiddleButtonPress = macro.chain(\n    publicAPI.handleMiddleButtonPress,\n    handleButtonPress\n  );\n\n  publicAPI.handleRightButtonPress = macro.chain(\n    publicAPI.handleRightButtonPress,\n    handleButtonPress\n  );\n\n  const superHandleMouseMove = publicAPI.handleMouseMove;\n  publicAPI.handleMouseMove = callData => {\n    if (superHandleMouseMove) {\n      superHandleMouseMove(callData);\n    }\n\n    const { apis, apiIndex } = model;\n    const thisApi = apis[apiIndex];\n\n    // This stops the clipping range being randomly reset.\n    const renderer = thisApi.genericRenderWindow.getRenderer();\n    const camera = renderer.getActiveCamera();\n\n    camera.setThicknessFromFocalPoint(model.slabThickness);\n\n    if (model.state === States.IS_PAN) {\n      const { apis, apiIndex } = model;\n      const api = apis[apiIndex];\n\n      // TODO -> This is kinda bad but the only way with the current setup.\n      if (api.svgWidgets.crosshairsWidget) {\n        api.svgWidgets.crosshairsWidget.updateCrosshairForApi(api);\n      }\n      if (api.svgWidgets.rotatableCrosshairsWidget) {\n        updateRotatableCrosshairs(callData);\n      }\n    }\n  };\n\n  function handleButtonRelease(superButtonRelease, callData) {\n    if (model.state === States.IS_PAN) {\n      publicAPI.endPan();\n      const { apis, apiIndex } = model;\n      const api = apis[apiIndex];\n\n      if (api.svgWidgets.crosshairsWidget) {\n        api.svgWidgets.crosshairsWidget.updateCrosshairForApi(api);\n      }\n      if (api.svgWidgets.rotatableCrosshairsWidget) {\n        updateRotatableCrosshairs(callData);\n      }\n    }\n\n    superButtonRelease();\n  }\n\n  publicAPI.superHandleMiddleButtonRelease =\n    publicAPI.handleMiddleButtonRelease;\n  publicAPI.handleMiddleButtonRelease = callData => {\n    handleButtonRelease(publicAPI.superHandleMiddleButtonRelease, callData);\n  };\n\n  publicAPI.superHandleRightButtonRelease = publicAPI.handleRightButtonRelease;\n  publicAPI.handleRightButtonRelease = callData => {\n    handleButtonRelease(publicAPI.superHandleRightButtonRelease, callData);\n  };\n\n  publicAPI.setVolumeActor = actor => {\n    model.volumeActor = actor;\n    const renderer = model.interactor.getCurrentRenderer();\n    const camera = renderer.getActiveCamera();\n    if (actor) {\n      // prevent zoom manipulator from messing with our focal point\n      camera.setFreezeFocalPoint(true);\n\n      const viewportData = publicAPI.getViewport();\n\n      if (viewportData) {\n        setSliceNormalInternal(viewportData.getCurrentSliceNormal());\n        setViewUpInternal(viewportData.getCurrentViewUp());\n      }\n\n      publicAPI.updateScrollManipulator();\n      // NOTE: Disabling this because it makes it more difficult to switch\n      // interactor styles. Need to find a better way to do this!\n      //publicAPI.setSliceNormal(...publicAPI.getSliceNormal());\n    } else {\n      camera.setFreezeFocalPoint(false);\n    }\n  };\n\n  publicAPI.getSlice = () => {\n    const renderer = model.interactor.getCurrentRenderer();\n    const camera = renderer.getActiveCamera();\n    const sliceNormal = publicAPI.getSliceNormal();\n\n    // Get rotation matrix from normal to +X (since bounds is aligned to XYZ)\n    const transform = vtkMatrixBuilder\n      .buildFromDegree()\n      .identity()\n      .rotateFromDirections(sliceNormal, [1, 0, 0]);\n\n    const fp = camera.getFocalPoint();\n    transform.apply(fp);\n    return fp[0];\n  };\n\n  // Only run the onScroll callback if called from scrolling,\n  // preventing manual setSlice calls from triggering the CB.\n  publicAPI.scrollToSlice = slice => {\n    // Dispatch custom event\n    const vtkScrollEvent = new CustomEvent('vtkscrollevent', {\n      detail: { uid: publicAPI.getUid() },\n    });\n    window.dispatchEvent(vtkScrollEvent);\n\n    const slicePoint = publicAPI.setSlice(slice);\n\n    // run Callback\n    const onScroll = publicAPI.getOnScroll();\n    if (onScroll) {\n      onScroll({\n        slicePoint,\n      });\n    }\n  };\n\n  model.onScroll = () => {\n    const { apis, apiIndex } = model;\n\n    // TODO -> We need to think of a more generic way to do this for all widget types eventually.\n    // TODO -> We certainly need to be able to register stuff like this.\n    if (apis && apis[apiIndex] && apis[apiIndex].type === 'VIEW2D') {\n      // Check whether crosshairs should be updated.\n\n      const api = apis[apiIndex];\n\n      if (\n        !api.svgWidgets.crosshairsWidget &&\n        !api.svgWidgets.rotatableCrosshairsWidget\n      ) {\n        // If we aren't using the crosshairs widget, bail out early.\n        return;\n      }\n\n      const renderer = api.genericRenderWindow.getRenderer();\n      let cachedCrosshairWorldPosition = api.get(\n        'cachedCrosshairWorldPosition'\n      );\n\n      if (cachedCrosshairWorldPosition === undefined) {\n        // Crosshairs not initilised.\n        return;\n      }\n\n      const wPos = vtkCoordinate.newInstance();\n      wPos.setCoordinateSystemToWorld();\n      wPos.setValue(...cachedCrosshairWorldPosition);\n\n      const doubleDisplayPosition = wPos.getComputedDoubleDisplayValue(\n        renderer\n      );\n\n      const dPos = vtkCoordinate.newInstance();\n      dPos.setCoordinateSystemToDisplay();\n\n      dPos.setValue(doubleDisplayPosition[0], doubleDisplayPosition[1], 0);\n      let worldPos = dPos.getComputedWorldValue(renderer);\n\n      const camera = renderer.getActiveCamera();\n      const directionOfProjection = camera.getDirectionOfProjection();\n      const halfSlabThickness = api.getSlabThickness() / 2;\n\n      // Add half of the slab thickness to the world position, such that we select\n      //The center of the slice.\n\n      for (let i = 0; i < worldPos.length; i++) {\n        worldPos[i] += halfSlabThickness * directionOfProjection[i];\n      }\n\n      if (api.svgWidgets.crosshairsWidget) {\n        api.svgWidgets.crosshairsWidget.moveCrosshairs(\n          worldPos,\n          apis,\n          apiIndex\n        );\n      }\n      if (api.svgWidgets.rotatableCrosshairsWidget) {\n        api.svgWidgets.rotatableCrosshairsWidget.moveCrosshairs(\n          worldPos,\n          apis,\n          apiIndex\n        );\n      }\n    }\n  };\n\n  publicAPI.setSlice = slice => {\n    const renderer = model.interactor.getCurrentRenderer();\n    const camera = renderer.getActiveCamera();\n\n    if (model.volumeActor) {\n      const range = publicAPI.getSliceRange();\n      const bounds = model.volumeActor.getMapper().getBounds();\n\n      const clampedSlice = clamp(slice, ...range);\n\n      let cameraOffset = [0, 0, 0];\n      if (cache.sliceCenter.length) {\n        const oldPos = camera.getFocalPoint();\n        vtkMath.subtract(oldPos, cache.sliceCenter, cameraOffset);\n      }\n\n      const center = [\n        (bounds[0] + bounds[1]) / 2.0,\n        (bounds[2] + bounds[3]) / 2.0,\n        (bounds[4] + bounds[5]) / 2.0,\n      ];\n\n      const distance = camera.getDistance();\n      const dop = camera.getDirectionOfProjection();\n      vtkMath.normalize(dop);\n\n      const midPoint = (range[1] + range[0]) / 2.0;\n      const zeroPoint = [\n        center[0] - dop[0] * midPoint,\n        center[1] - dop[1] * midPoint,\n        center[2] - dop[2] * midPoint,\n      ];\n      const slicePoint = [\n        zeroPoint[0] + dop[0] * clampedSlice,\n        zeroPoint[1] + dop[1] * clampedSlice,\n        zeroPoint[2] + dop[2] * clampedSlice,\n      ];\n\n      // Cache the center for comparison to calculate the next camera offset\n      cache.sliceCenter = [...slicePoint];\n\n      const cameraPos = [\n        slicePoint[0] - dop[0] * distance,\n        slicePoint[1] - dop[1] * distance,\n        slicePoint[2] - dop[2] * distance,\n      ];\n\n      vtkMath.add(slicePoint, cameraOffset, slicePoint);\n      vtkMath.add(cameraPos, cameraOffset, cameraPos);\n\n      camera.setPosition(...cameraPos);\n      camera.setFocalPoint(...slicePoint);\n      return slicePoint;\n    }\n  };\n\n  publicAPI.getSliceRange = () => {\n    if (model.volumeActor) {\n      const sliceNormal = publicAPI.getSliceNormal();\n\n      if (\n        sliceNormal[0] === cache.sliceNormal[0] &&\n        sliceNormal[1] === cache.sliceNormal[1] &&\n        sliceNormal[2] === cache.sliceNormal[2]\n      ) {\n        return cache.sliceRange;\n      }\n\n      const bounds = model.volumeActor.getMapper().getBounds();\n      const points = boundsToCorners(bounds);\n\n      // Get rotation matrix from normal to +X (since bounds is aligned to XYZ)\n      const transform = vtkMatrixBuilder\n        .buildFromDegree()\n        .identity()\n        .rotateFromDirections(sliceNormal, [1, 0, 0]);\n\n      points.forEach(pt => transform.apply(pt));\n\n      // range is now maximum X distance\n      let minX = Infinity;\n      let maxX = -Infinity;\n      for (let i = 0; i < 8; i++) {\n        const x = points[i][0];\n        if (x > maxX) {\n          maxX = x;\n        }\n        if (x < minX) {\n          minX = x;\n        }\n      }\n\n      cache.sliceNormal = sliceNormal;\n      cache.sliceRange = [minX, maxX];\n      return cache.sliceRange;\n    }\n    return [0, 0];\n  };\n\n  // Slice normal is just camera DOP\n  publicAPI.getSliceNormal = () => {\n    if (model.volumeActor && model.interactor) {\n      const renderer = model.interactor.getCurrentRenderer();\n      const camera = renderer.getActiveCamera();\n      return camera.getDirectionOfProjection();\n    }\n    return [0, 0, 0];\n  };\n\n  publicAPI.setSliceNormal = (...normal) => {\n    const viewportData = publicAPI.getViewport();\n\n    if (viewportData) {\n      viewportData.setOrientation(normal, viewportData.getCurrentViewUp());\n    }\n\n    setSliceNormalInternal(normal);\n  };\n\n  publicAPI.getViewUp = () => {\n    if (model.volumeActor && model.interactor) {\n      const renderer = model.interactor.getCurrentRenderer();\n      const camera = renderer.getActiveCamera();\n\n      return camera.getViewUp();\n    }\n\n    return [0, 0, 0];\n  };\n\n  publicAPI.setViewUp = (...viewUp) => {\n    const viewportData = publicAPI.getViewport();\n\n    if (viewportData) {\n      viewportData.setOrientation(viewportData.getSliceNormal(), viewUp);\n    }\n\n    setViewUpInternal(viewUp);\n  };\n\n  publicAPI.setSliceOrientation = (normal, viewUp) => {\n    const viewportData = publicAPI.getViewport();\n\n    if (viewportData) {\n      viewportData.setOrientation(normal, viewUp);\n    }\n\n    setSliceNormalInternal(normal);\n    setViewUpInternal(viewUp);\n  };\n\n  publicAPI.setSlabThickness = slabThickness => {\n    model.slabThickness = slabThickness;\n\n    // Update the camera clipping range if the slab\n    // thickness property is changed\n    const renderer = model.interactor.getCurrentRenderer();\n    const camera = renderer.getActiveCamera();\n    camera.setThicknessFromFocalPoint(slabThickness);\n  };\n\n  publicAPI.setUid = uid => {\n    model.uid = uid;\n  };\n\n  publicAPI.getUid = () => {\n    return model.uid;\n  };\n\n  setManipulators();\n}\n\n// ----------------------------------------------------------------------------\n// Object factory\n// ----------------------------------------------------------------------------\n\nconst DEFAULT_VALUES = {\n  slabThickness: 0.1,\n  uid: '',\n};\n\n// ----------------------------------------------------------------------------\n\nexport function extend(publicAPI, model, initialValues = {}) {\n  Object.assign(model, DEFAULT_VALUES, initialValues);\n\n  // Inheritance\n  vtkInteractorStyleManipulator.extend(publicAPI, model, initialValues);\n\n  macro.setGet(publicAPI, model, ['onScroll']);\n  macro.get(publicAPI, model, [\n    'slabThickness',\n    'volumeActor',\n    'apis',\n    'apiIndex',\n  ]);\n\n  // Object specific methods\n  vtkInteractorStyleMPRSlice(publicAPI, model);\n}\n\n// ----------------------------------------------------------------------------\n\n// Returns new instance factory, takes initial values object\nexport const newInstance = macro.newInstance(\n  extend,\n  'vtkInteractorStyleMPRSlice'\n);\n\n// ----------------------------------------------------------------------------\n\nexport default Object.assign({ newInstance, extend });\n\n// TODO: work with VTK to change the internal formatting of arrays.\nfunction vec9toMat3(vec9) {\n  if (vec9.length !== 9) {\n    throw Error('Array not length 9');\n  }\n  //prettier-ignore\n  return [\n    [vec9[0], vec9[1], vec9[2]],\n    [vec9[3], vec9[4], vec9[5]],\n    [vec9[6], vec9[7], vec9[8]],\n  ];\n}\n","import macro from 'vtk.js/Sources/macro';\n\nconst { vtkErrorMacro } = macro;\nlet instanceId = 1;\n\nfunction createSVGRoot(id) {\n  const el = document.createElement('svg');\n  el.setAttribute('id', id);\n  el.setAttribute(\n    'style',\n    'position: absolute; top: 0; left: 0; width: 100%; height: 100%;'\n  );\n  el.setAttribute('version', '1.1');\n  el.setAttribute('xmlns', 'http://www.w3.org/2000/svg');\n\n  return el;\n}\n\n// ----------------------------------------------------------------------------\n\nfunction vtkSVGWidgetManager(publicAPI, model) {\n  model.classHierarchy.push('vtkSVGWidgetManager');\n  model.widgetId = `vtkSVGWidgetManager-${instanceId++}`;\n  model.svgRootNode = createSVGRoot(model.widgetId);\n  model.widgets = [];\n\n  publicAPI.setRenderer = renderer => {\n    const renderWindow = renderer.getRenderWindow();\n    const interactor = renderWindow.getInteractor();\n    model.openGLRenderWindow = interactor.getView();\n    publicAPI.setContainer(model.openGLRenderWindow.getReferenceByName('el'));\n  };\n\n  publicAPI.setContainer = el => {\n    if (model.container && model.container !== el) {\n      // Remove canvas from previous container\n      if (model.svgRootNode.parentNode === model.container) {\n        model.container.removeChild(model.svgRootNode);\n      } else {\n        vtkErrorMacro('Error: SVG parent node does not match container');\n      }\n    }\n\n    if (model.container !== el) {\n      model.container = el;\n      if (model.container) {\n        model.container.appendChild(model.svgRootNode);\n      }\n\n      // Trigger modified()\n      publicAPI.modified();\n    }\n  };\n\n  publicAPI.getSize = () => model.openGLRenderWindow.getSize();\n\n  publicAPI.addWidget = svgWidget => {\n    if (model.widgets.indexOf(svgWidget) === -1) {\n      model.widgets.push(svgWidget);\n    }\n    publicAPI.render();\n  };\n\n  publicAPI.removeWidget = svgWidget => {\n    const id = svgWidget.getWidgetId();\n    const widgetNode = model.svgRootNode.querySelector(`#${id}`);\n    model.svgRootNode.removeChild(widgetNode);\n    const index = model.widgets.indexOf(svgWidget);\n    if (index !== -1) {\n      model.widgets.splice(index, 1);\n    }\n    publicAPI.render();\n  };\n\n  publicAPI.render = () => {\n    if (model.svgRootNode) {\n      // TODO: Not sure this is the best approach but it seems to be\n      // making things smoother. Updating the DOM seemed to be\n      // the performance bottleneck for the crosshairs tool\n      requestAnimationFrame(() => {\n        const { scale } = model;\n        const [width, height] = publicAPI.getSize();\n        model.svgRootNode.setAttribute(\n          'viewBox',\n          `0 0 ${width * scale} ${height * scale}`\n        );\n        model.svgRootNode.setAttribute('width', `${width * scale}`);\n        model.svgRootNode.setAttribute('height', `${height * scale}`);\n        for (let i = 0; i < model.widgets.length; i++) {\n          model.widgets[i].render(model.svgRootNode, model.scale);\n        }\n      });\n    }\n  };\n}\n\n// ----------------------------------------------------------------------------\n\nconst DEFAULT_VALUES = {\n  scale: 0.5,\n};\n\n// ----------------------------------------------------------------------------\n\nexport function extend(publicAPI, model, initialValues = {}) {\n  Object.assign(model, DEFAULT_VALUES, initialValues);\n\n  macro.obj(publicAPI, model);\n  macro.get(publicAPI, model, ['container']);\n  macro.setGet(publicAPI, model, ['scale']);\n  vtkSVGWidgetManager(publicAPI, model);\n}\n\n// ----------------------------------------------------------------------------\n\nexport const newInstance = macro.newInstance(extend, 'vtkSVGWidgetManager');\n\n// ----------------------------------------------------------------------------\n\nexport default { newInstance, extend };\n","var formatDistanceLocale = {\n  lessThanXSeconds: {\n    one: 'less than a second',\n    other: 'less than {{count}} seconds'\n  },\n  xSeconds: {\n    one: '1 second',\n    other: '{{count}} seconds'\n  },\n  halfAMinute: 'half a minute',\n  lessThanXMinutes: {\n    one: 'less than a minute',\n    other: 'less than {{count}} minutes'\n  },\n  xMinutes: {\n    one: '1 minute',\n    other: '{{count}} minutes'\n  },\n  aboutXHours: {\n    one: 'about 1 hour',\n    other: 'about {{count}} hours'\n  },\n  xHours: {\n    one: '1 hour',\n    other: '{{count}} hours'\n  },\n  xDays: {\n    one: '1 day',\n    other: '{{count}} days'\n  },\n  aboutXMonths: {\n    one: 'about 1 month',\n    other: 'about {{count}} months'\n  },\n  xMonths: {\n    one: '1 month',\n    other: '{{count}} months'\n  },\n  aboutXYears: {\n    one: 'about 1 year',\n    other: 'about {{count}} years'\n  },\n  xYears: {\n    one: '1 year',\n    other: '{{count}} years'\n  },\n  overXYears: {\n    one: 'over 1 year',\n    other: 'over {{count}} years'\n  },\n  almostXYears: {\n    one: 'almost 1 year',\n    other: 'almost {{count}} years'\n  }\n};\nexport default function formatDistance(token, count, options) {\n  options = options || {};\n  var result;\n\n  if (typeof formatDistanceLocale[token] === 'string') {\n    result = formatDistanceLocale[token];\n  } else if (count === 1) {\n    result = formatDistanceLocale[token].one;\n  } else {\n    result = formatDistanceLocale[token].other.replace('{{count}}', count);\n  }\n\n  if (options.addSuffix) {\n    if (options.comparison > 0) {\n      return 'in ' + result;\n    } else {\n      return result + ' ago';\n    }\n  }\n\n  return result;\n}","export default function buildFormatLongFn(args) {\n  return function (dirtyOptions) {\n    var options = dirtyOptions || {};\n    var width = options.width ? String(options.width) : args.defaultWidth;\n    var format = args.formats[width] || args.formats[args.defaultWidth];\n    return format;\n  };\n}","import buildFormatLongFn from '../../../_lib/buildFormatLongFn/index.js';\nvar dateFormats = {\n  full: 'EEEE, MMMM do, y',\n  long: 'MMMM do, y',\n  medium: 'MMM d, y',\n  short: 'MM/dd/yyyy'\n};\nvar timeFormats = {\n  full: 'h:mm:ss a zzzz',\n  long: 'h:mm:ss a z',\n  medium: 'h:mm:ss a',\n  short: 'h:mm a'\n};\nvar dateTimeFormats = {\n  full: \"{{date}} 'at' {{time}}\",\n  long: \"{{date}} 'at' {{time}}\",\n  medium: '{{date}}, {{time}}',\n  short: '{{date}}, {{time}}'\n};\nvar formatLong = {\n  date: buildFormatLongFn({\n    formats: dateFormats,\n    defaultWidth: 'full'\n  }),\n  time: buildFormatLongFn({\n    formats: timeFormats,\n    defaultWidth: 'full'\n  }),\n  dateTime: buildFormatLongFn({\n    formats: dateTimeFormats,\n    defaultWidth: 'full'\n  })\n};\nexport default formatLong;","var formatRelativeLocale = {\n  lastWeek: \"'last' eeee 'at' p\",\n  yesterday: \"'yesterday at' p\",\n  today: \"'today at' p\",\n  tomorrow: \"'tomorrow at' p\",\n  nextWeek: \"eeee 'at' p\",\n  other: 'P'\n};\nexport default function formatRelative(token, _date, _baseDate, _options) {\n  return formatRelativeLocale[token];\n}","export default function buildLocalizeFn(args) {\n  return function (dirtyIndex, dirtyOptions) {\n    var options = dirtyOptions || {};\n    var context = options.context ? String(options.context) : 'standalone';\n    var valuesArray;\n\n    if (context === 'formatting' && args.formattingValues) {\n      var defaultWidth = args.defaultFormattingWidth || args.defaultWidth;\n      var width = options.width ? String(options.width) : defaultWidth;\n      valuesArray = args.formattingValues[width] || args.formattingValues[defaultWidth];\n    } else {\n      var _defaultWidth = args.defaultWidth;\n\n      var _width = options.width ? String(options.width) : args.defaultWidth;\n\n      valuesArray = args.values[_width] || args.values[_defaultWidth];\n    }\n\n    var index = args.argumentCallback ? args.argumentCallback(dirtyIndex) : dirtyIndex;\n    return valuesArray[index];\n  };\n}","export default function buildMatchFn(args) {\n  return function (dirtyString, dirtyOptions) {\n    var string = String(dirtyString);\n    var options = dirtyOptions || {};\n    var width = options.width;\n    var matchPattern = width && args.matchPatterns[width] || args.matchPatterns[args.defaultMatchWidth];\n    var matchResult = string.match(matchPattern);\n\n    if (!matchResult) {\n      return null;\n    }\n\n    var matchedString = matchResult[0];\n    var parsePatterns = width && args.parsePatterns[width] || args.parsePatterns[args.defaultParseWidth];\n    var value;\n\n    if (Object.prototype.toString.call(parsePatterns) === '[object Array]') {\n      value = findIndex(parsePatterns, function (pattern) {\n        return pattern.test(string);\n      });\n    } else {\n      value = findKey(parsePatterns, function (pattern) {\n        return pattern.test(string);\n      });\n    }\n\n    value = args.valueCallback ? args.valueCallback(value) : value;\n    value = options.valueCallback ? options.valueCallback(value) : value;\n    return {\n      value: value,\n      rest: string.slice(matchedString.length)\n    };\n  };\n}\n\nfunction findKey(object, predicate) {\n  for (var key in object) {\n    if (object.hasOwnProperty(key) && predicate(object[key])) {\n      return key;\n    }\n  }\n}\n\nfunction findIndex(array, predicate) {\n  for (var key = 0; key < array.length; key++) {\n    if (predicate(array[key])) {\n      return key;\n    }\n  }\n}","import buildMatchPatternFn from '../../../_lib/buildMatchPatternFn/index.js';\nimport buildMatchFn from '../../../_lib/buildMatchFn/index.js';\nvar matchOrdinalNumberPattern = /^(\\d+)(th|st|nd|rd)?/i;\nvar parseOrdinalNumberPattern = /\\d+/i;\nvar matchEraPatterns = {\n  narrow: /^(b|a)/i,\n  abbreviated: /^(b\\.?\\s?c\\.?|b\\.?\\s?c\\.?\\s?e\\.?|a\\.?\\s?d\\.?|c\\.?\\s?e\\.?)/i,\n  wide: /^(before christ|before common era|anno domini|common era)/i\n};\nvar parseEraPatterns = {\n  any: [/^b/i, /^(a|c)/i]\n};\nvar matchQuarterPatterns = {\n  narrow: /^[1234]/i,\n  abbreviated: /^q[1234]/i,\n  wide: /^[1234](th|st|nd|rd)? quarter/i\n};\nvar parseQuarterPatterns = {\n  any: [/1/i, /2/i, /3/i, /4/i]\n};\nvar matchMonthPatterns = {\n  narrow: /^[jfmasond]/i,\n  abbreviated: /^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,\n  wide: /^(january|february|march|april|may|june|july|august|september|october|november|december)/i\n};\nvar parseMonthPatterns = {\n  narrow: [/^j/i, /^f/i, /^m/i, /^a/i, /^m/i, /^j/i, /^j/i, /^a/i, /^s/i, /^o/i, /^n/i, /^d/i],\n  any: [/^ja/i, /^f/i, /^mar/i, /^ap/i, /^may/i, /^jun/i, /^jul/i, /^au/i, /^s/i, /^o/i, /^n/i, /^d/i]\n};\nvar matchDayPatterns = {\n  narrow: /^[smtwf]/i,\n  short: /^(su|mo|tu|we|th|fr|sa)/i,\n  abbreviated: /^(sun|mon|tue|wed|thu|fri|sat)/i,\n  wide: /^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i\n};\nvar parseDayPatterns = {\n  narrow: [/^s/i, /^m/i, /^t/i, /^w/i, /^t/i, /^f/i, /^s/i],\n  any: [/^su/i, /^m/i, /^tu/i, /^w/i, /^th/i, /^f/i, /^sa/i]\n};\nvar matchDayPeriodPatterns = {\n  narrow: /^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,\n  any: /^([ap]\\.?\\s?m\\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i\n};\nvar parseDayPeriodPatterns = {\n  any: {\n    am: /^a/i,\n    pm: /^p/i,\n    midnight: /^mi/i,\n    noon: /^no/i,\n    morning: /morning/i,\n    afternoon: /afternoon/i,\n    evening: /evening/i,\n    night: /night/i\n  }\n};\nvar match = {\n  ordinalNumber: buildMatchPatternFn({\n    matchPattern: matchOrdinalNumberPattern,\n    parsePattern: parseOrdinalNumberPattern,\n    valueCallback: function (value) {\n      return parseInt(value, 10);\n    }\n  }),\n  era: buildMatchFn({\n    matchPatterns: matchEraPatterns,\n    defaultMatchWidth: 'wide',\n    parsePatterns: parseEraPatterns,\n    defaultParseWidth: 'any'\n  }),\n  quarter: buildMatchFn({\n    matchPatterns: matchQuarterPatterns,\n    defaultMatchWidth: 'wide',\n    parsePatterns: parseQuarterPatterns,\n    defaultParseWidth: 'any',\n    valueCallback: function (index) {\n      return index + 1;\n    }\n  }),\n  month: buildMatchFn({\n    matchPatterns: matchMonthPatterns,\n    defaultMatchWidth: 'wide',\n    parsePatterns: parseMonthPatterns,\n    defaultParseWidth: 'any'\n  }),\n  day: buildMatchFn({\n    matchPatterns: matchDayPatterns,\n    defaultMatchWidth: 'wide',\n    parsePatterns: parseDayPatterns,\n    defaultParseWidth: 'any'\n  }),\n  dayPeriod: buildMatchFn({\n    matchPatterns: matchDayPeriodPatterns,\n    defaultMatchWidth: 'any',\n    parsePatterns: parseDayPeriodPatterns,\n    defaultParseWidth: 'any'\n  })\n};\nexport default match;","export default function buildMatchPatternFn(args) {\n  return function (dirtyString, dirtyOptions) {\n    var string = String(dirtyString);\n    var options = dirtyOptions || {};\n    var matchResult = string.match(args.matchPattern);\n\n    if (!matchResult) {\n      return null;\n    }\n\n    var matchedString = matchResult[0];\n    var parseResult = string.match(args.parsePattern);\n\n    if (!parseResult) {\n      return null;\n    }\n\n    var value = args.valueCallback ? args.valueCallback(parseResult[0]) : parseResult[0];\n    value = options.valueCallback ? options.valueCallback(value) : value;\n    return {\n      value: value,\n      rest: string.slice(matchedString.length)\n    };\n  };\n}","import formatDistance from './_lib/formatDistance/index.js';\nimport formatLong from './_lib/formatLong/index.js';\nimport formatRelative from './_lib/formatRelative/index.js';\nimport localize from './_lib/localize/index.js';\nimport match from './_lib/match/index.js';\n/**\n * @type {Locale}\n * @category Locales\n * @summary English locale (United States).\n * @language English\n * @iso-639-2 eng\n * @author Sasha Koss [@kossnocorp]{@link https://github.com/kossnocorp}\n * @author Lesha Koss [@leshakoss]{@link https://github.com/leshakoss}\n */\n\nvar locale = {\n  code: 'en-US',\n  formatDistance: formatDistance,\n  formatLong: formatLong,\n  formatRelative: formatRelative,\n  localize: localize,\n  match: match,\n  options: {\n    weekStartsOn: 0\n    /* Sunday */\n    ,\n    firstWeekContainsDate: 1\n  }\n};\nexport default locale;","import buildLocalizeFn from '../../../_lib/buildLocalizeFn/index.js';\nvar eraValues = {\n  narrow: ['B', 'A'],\n  abbreviated: ['BC', 'AD'],\n  wide: ['Before Christ', 'Anno Domini']\n};\nvar quarterValues = {\n  narrow: ['1', '2', '3', '4'],\n  abbreviated: ['Q1', 'Q2', 'Q3', 'Q4'],\n  wide: ['1st quarter', '2nd quarter', '3rd quarter', '4th quarter'] // Note: in English, the names of days of the week and months are capitalized.\n  // If you are making a new locale based on this one, check if the same is true for the language you're working on.\n  // Generally, formatted dates should look like they are in the middle of a sentence,\n  // e.g. in Spanish language the weekdays and months should be in the lowercase.\n\n};\nvar monthValues = {\n  narrow: ['J', 'F', 'M', 'A', 'M', 'J', 'J', 'A', 'S', 'O', 'N', 'D'],\n  abbreviated: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],\n  wide: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December']\n};\nvar dayValues = {\n  narrow: ['S', 'M', 'T', 'W', 'T', 'F', 'S'],\n  short: ['Su', 'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa'],\n  abbreviated: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],\n  wide: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday']\n};\nvar dayPeriodValues = {\n  narrow: {\n    am: 'a',\n    pm: 'p',\n    midnight: 'mi',\n    noon: 'n',\n    morning: 'morning',\n    afternoon: 'afternoon',\n    evening: 'evening',\n    night: 'night'\n  },\n  abbreviated: {\n    am: 'AM',\n    pm: 'PM',\n    midnight: 'midnight',\n    noon: 'noon',\n    morning: 'morning',\n    afternoon: 'afternoon',\n    evening: 'evening',\n    night: 'night'\n  },\n  wide: {\n    am: 'a.m.',\n    pm: 'p.m.',\n    midnight: 'midnight',\n    noon: 'noon',\n    morning: 'morning',\n    afternoon: 'afternoon',\n    evening: 'evening',\n    night: 'night'\n  }\n};\nvar formattingDayPeriodValues = {\n  narrow: {\n    am: 'a',\n    pm: 'p',\n    midnight: 'mi',\n    noon: 'n',\n    morning: 'in the morning',\n    afternoon: 'in the afternoon',\n    evening: 'in the evening',\n    night: 'at night'\n  },\n  abbreviated: {\n    am: 'AM',\n    pm: 'PM',\n    midnight: 'midnight',\n    noon: 'noon',\n    morning: 'in the morning',\n    afternoon: 'in the afternoon',\n    evening: 'in the evening',\n    night: 'at night'\n  },\n  wide: {\n    am: 'a.m.',\n    pm: 'p.m.',\n    midnight: 'midnight',\n    noon: 'noon',\n    morning: 'in the morning',\n    afternoon: 'in the afternoon',\n    evening: 'in the evening',\n    night: 'at night'\n  }\n};\n\nfunction ordinalNumber(dirtyNumber, _dirtyOptions) {\n  var number = Number(dirtyNumber); // If ordinal numbers depend on context, for example,\n  // if they are different for different grammatical genders,\n  // use `options.unit`:\n  //\n  //   var options = dirtyOptions || {}\n  //   var unit = String(options.unit)\n  //\n  // where `unit` can be 'year', 'quarter', 'month', 'week', 'date', 'dayOfYear',\n  // 'day', 'hour', 'minute', 'second'\n\n  var rem100 = number % 100;\n\n  if (rem100 > 20 || rem100 < 10) {\n    switch (rem100 % 10) {\n      case 1:\n        return number + 'st';\n\n      case 2:\n        return number + 'nd';\n\n      case 3:\n        return number + 'rd';\n    }\n  }\n\n  return number + 'th';\n}\n\nvar localize = {\n  ordinalNumber: ordinalNumber,\n  era: buildLocalizeFn({\n    values: eraValues,\n    defaultWidth: 'wide'\n  }),\n  quarter: buildLocalizeFn({\n    values: quarterValues,\n    defaultWidth: 'wide',\n    argumentCallback: function (quarter) {\n      return Number(quarter) - 1;\n    }\n  }),\n  month: buildLocalizeFn({\n    values: monthValues,\n    defaultWidth: 'wide'\n  }),\n  day: buildLocalizeFn({\n    values: dayValues,\n    defaultWidth: 'wide'\n  }),\n  dayPeriod: buildLocalizeFn({\n    values: dayPeriodValues,\n    defaultWidth: 'wide',\n    formattingValues: formattingDayPeriodValues,\n    defaultFormattingWidth: 'wide'\n  })\n};\nexport default localize;","export default function toInteger(dirtyNumber) {\n  if (dirtyNumber === null || dirtyNumber === true || dirtyNumber === false) {\n    return NaN;\n  }\n\n  var number = Number(dirtyNumber);\n\n  if (isNaN(number)) {\n    return number;\n  }\n\n  return number < 0 ? Math.ceil(number) : Math.floor(number);\n}","/**\n * @name toDate\n * @category Common Helpers\n * @summary Convert the given argument to an instance of Date.\n *\n * @description\n * Convert the given argument to an instance of Date.\n *\n * If the argument is an instance of Date, the function returns its clone.\n *\n * If the argument is a number, it is treated as a timestamp.\n *\n * If the argument is none of the above, the function returns Invalid Date.\n *\n * **Note**: *all* Date arguments passed to any *date-fns* function is processed by `toDate`.\n *\n * @param {Date|Number} argument - the value to convert\n * @returns {Date} the parsed date in the local time zone\n * @throws {TypeError} 1 argument required\n *\n * @example\n * // Clone the date:\n * const result = toDate(new Date(2014, 1, 11, 11, 30, 30))\n * //=> Tue Feb 11 2014 11:30:30\n *\n * @example\n * // Convert the timestamp to date:\n * const result = toDate(1392098430000)\n * //=> Tue Feb 11 2014 11:30:30\n */\nexport default function toDate(argument) {\n  if (arguments.length < 1) {\n    throw new TypeError('1 argument required, but only ' + arguments.length + ' present');\n  }\n\n  var argStr = Object.prototype.toString.call(argument); // Clone the date\n\n  if (argument instanceof Date || typeof argument === 'object' && argStr === '[object Date]') {\n    // Prevent the date to lose the milliseconds when passed to new Date() in IE10\n    return new Date(argument.getTime());\n  } else if (typeof argument === 'number' || argStr === '[object Number]') {\n    return new Date(argument);\n  } else {\n    if ((typeof argument === 'string' || argStr === '[object String]') && typeof console !== 'undefined') {\n      // eslint-disable-next-line no-console\n      console.warn(\"Starting with v2.0.0-beta.1 date-fns doesn't accept strings as arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule\"); // eslint-disable-next-line no-console\n\n      console.warn(new Error().stack);\n    }\n\n    return new Date(NaN);\n  }\n}","import toInteger from '../_lib/toInteger/index.js';\nimport addMilliseconds from '../addMilliseconds/index.js';\n/**\n * @name subMilliseconds\n * @category Millisecond Helpers\n * @summary Subtract the specified number of milliseconds from the given date.\n *\n * @description\n * Subtract the specified number of milliseconds from the given date.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the date to be changed\n * @param {Number} amount - the amount of milliseconds to be subtracted\n * @returns {Date} the new date with the milliseconds subtracted\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // Subtract 750 milliseconds from 10 July 2014 12:45:30.000:\n * var result = subMilliseconds(new Date(2014, 6, 10, 12, 45, 30, 0), 750)\n * //=> Thu Jul 10 2014 12:45:29.250\n */\n\nexport default function subMilliseconds(dirtyDate, dirtyAmount) {\n  if (arguments.length < 2) {\n    throw new TypeError('2 arguments required, but only ' + arguments.length + ' present');\n  }\n\n  var amount = toInteger(dirtyAmount);\n  return addMilliseconds(dirtyDate, -amount);\n}","import toInteger from '../_lib/toInteger/index.js';\nimport toDate from '../toDate/index.js';\n/**\n * @name addMilliseconds\n * @category Millisecond Helpers\n * @summary Add the specified number of milliseconds to the given date.\n *\n * @description\n * Add the specified number of milliseconds to the given date.\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * @param {Date|Number} date - the date to be changed\n * @param {Number} amount - the amount of milliseconds to be added\n * @returns {Date} the new date with the milliseconds added\n * @throws {TypeError} 2 arguments required\n *\n * @example\n * // Add 750 milliseconds to 10 July 2014 12:45:30.000:\n * var result = addMilliseconds(new Date(2014, 6, 10, 12, 45, 30, 0), 750)\n * //=> Thu Jul 10 2014 12:45:30.750\n */\n\nexport default function addMilliseconds(dirtyDate, dirtyAmount) {\n  if (arguments.length < 2) {\n    throw new TypeError('2 arguments required, but only ' + arguments.length + ' present');\n  }\n\n  var timestamp = toDate(dirtyDate).getTime();\n  var amount = toInteger(dirtyAmount);\n  return new Date(timestamp + amount);\n}","export default function assign(target, dirtyObject) {\n  if (target == null) {\n    throw new TypeError('assign requires that input parameter not be null or undefined');\n  }\n\n  dirtyObject = dirtyObject || {};\n\n  for (var property in dirtyObject) {\n    if (dirtyObject.hasOwnProperty(property)) {\n      target[property] = dirtyObject[property];\n    }\n  }\n\n  return target;\n}","function dateLongFormatter(pattern, formatLong) {\n  switch (pattern) {\n    case 'P':\n      return formatLong.date({\n        width: 'short'\n      });\n\n    case 'PP':\n      return formatLong.date({\n        width: 'medium'\n      });\n\n    case 'PPP':\n      return formatLong.date({\n        width: 'long'\n      });\n\n    case 'PPPP':\n    default:\n      return formatLong.date({\n        width: 'full'\n      });\n  }\n}\n\nfunction timeLongFormatter(pattern, formatLong) {\n  switch (pattern) {\n    case 'p':\n      return formatLong.time({\n        width: 'short'\n      });\n\n    case 'pp':\n      return formatLong.time({\n        width: 'medium'\n      });\n\n    case 'ppp':\n      return formatLong.time({\n        width: 'long'\n      });\n\n    case 'pppp':\n    default:\n      return formatLong.time({\n        width: 'full'\n      });\n  }\n}\n\nfunction dateTimeLongFormatter(pattern, formatLong) {\n  var matchResult = pattern.match(/(P+)(p+)?/);\n  var datePattern = matchResult[1];\n  var timePattern = matchResult[2];\n\n  if (!timePattern) {\n    return dateLongFormatter(pattern, formatLong);\n  }\n\n  var dateTimeFormat;\n\n  switch (datePattern) {\n    case 'P':\n      dateTimeFormat = formatLong.dateTime({\n        width: 'short'\n      });\n      break;\n\n    case 'PP':\n      dateTimeFormat = formatLong.dateTime({\n        width: 'medium'\n      });\n      break;\n\n    case 'PPP':\n      dateTimeFormat = formatLong.dateTime({\n        width: 'long'\n      });\n      break;\n\n    case 'PPPP':\n    default:\n      dateTimeFormat = formatLong.dateTime({\n        width: 'full'\n      });\n      break;\n  }\n\n  return dateTimeFormat.replace('{{date}}', dateLongFormatter(datePattern, formatLong)).replace('{{time}}', timeLongFormatter(timePattern, formatLong));\n}\n\nvar longFormatters = {\n  p: timeLongFormatter,\n  P: dateTimeLongFormatter\n};\nexport default longFormatters;","var MILLISECONDS_IN_MINUTE = 60000;\n/**\n * Google Chrome as of 67.0.3396.87 introduced timezones with offset that includes seconds.\n * They usually appear for dates that denote time before the timezones were introduced\n * (e.g. for 'Europe/Prague' timezone the offset is GMT+00:57:44 before 1 October 1891\n * and GMT+01:00:00 after that date)\n *\n * Date#getTimezoneOffset returns the offset in minutes and would return 57 for the example above,\n * which would lead to incorrect calculations.\n *\n * This function returns the timezone offset in milliseconds that takes seconds in account.\n */\n\nexport default function getTimezoneOffsetInMilliseconds(dirtyDate) {\n  var date = new Date(dirtyDate.getTime());\n  var baseTimezoneOffset = Math.ceil(date.getTimezoneOffset());\n  date.setSeconds(0, 0);\n  var millisecondsPartOfTimezoneOffset = date.getTime() % MILLISECONDS_IN_MINUTE;\n  return baseTimezoneOffset * MILLISECONDS_IN_MINUTE + millisecondsPartOfTimezoneOffset;\n}","var protectedDayOfYearTokens = ['D', 'DD'];\nvar protectedWeekYearTokens = ['YY', 'YYYY'];\nexport function isProtectedDayOfYearToken(token) {\n  return protectedDayOfYearTokens.indexOf(token) !== -1;\n}\nexport function isProtectedWeekYearToken(token) {\n  return protectedWeekYearTokens.indexOf(token) !== -1;\n}\nexport function throwProtectedError(token) {\n  if (token === 'YYYY') {\n    throw new RangeError('Use `yyyy` instead of `YYYY` for formatting years; see: https://git.io/fxCyr');\n  } else if (token === 'YY') {\n    throw new RangeError('Use `yy` instead of `YY` for formatting years; see: https://git.io/fxCyr');\n  } else if (token === 'D') {\n    throw new RangeError('Use `d` instead of `D` for formatting days of the month; see: https://git.io/fxCyr');\n  } else if (token === 'DD') {\n    throw new RangeError('Use `dd` instead of `DD` for formatting days of the month; see: https://git.io/fxCyr');\n  }\n}","import toInteger from '../toInteger/index.js';\nimport toDate from '../../toDate/index.js'; // This function will be a part of public API when UTC function will be implemented.\n// See issue: https://github.com/date-fns/date-fns/issues/376\n\nexport default function startOfUTCWeek(dirtyDate, dirtyOptions) {\n  if (arguments.length < 1) {\n    throw new TypeError('1 argument required, but only ' + arguments.length + ' present');\n  }\n\n  var options = dirtyOptions || {};\n  var locale = options.locale;\n  var localeWeekStartsOn = locale && locale.options && locale.options.weekStartsOn;\n  var defaultWeekStartsOn = localeWeekStartsOn == null ? 0 : toInteger(localeWeekStartsOn);\n  var weekStartsOn = options.weekStartsOn == null ? defaultWeekStartsOn : toInteger(options.weekStartsOn); // Test if weekStartsOn is between 0 and 6 _and_ is not NaN\n\n  if (!(weekStartsOn >= 0 && weekStartsOn <= 6)) {\n    throw new RangeError('weekStartsOn must be between 0 and 6 inclusively');\n  }\n\n  var date = toDate(dirtyDate);\n  var day = date.getUTCDay();\n  var diff = (day < weekStartsOn ? 7 : 0) + day - weekStartsOn;\n  date.setUTCDate(date.getUTCDate() - diff);\n  date.setUTCHours(0, 0, 0, 0);\n  return date;\n}","import toInteger from '../toInteger/index.js';\nimport toDate from '../../toDate/index.js';\nimport startOfUTCWeek from '../startOfUTCWeek/index.js'; // This function will be a part of public API when UTC function will be implemented.\n// See issue: https://github.com/date-fns/date-fns/issues/376\n\nexport default function getUTCWeekYear(dirtyDate, dirtyOptions) {\n  if (arguments.length < 1) {\n    throw new TypeError('1 argument required, but only ' + arguments.length + ' present');\n  }\n\n  var date = toDate(dirtyDate, dirtyOptions);\n  var year = date.getUTCFullYear();\n  var options = dirtyOptions || {};\n  var locale = options.locale;\n  var localeFirstWeekContainsDate = locale && locale.options && locale.options.firstWeekContainsDate;\n  var defaultFirstWeekContainsDate = localeFirstWeekContainsDate == null ? 1 : toInteger(localeFirstWeekContainsDate);\n  var firstWeekContainsDate = options.firstWeekContainsDate == null ? defaultFirstWeekContainsDate : toInteger(options.firstWeekContainsDate); // Test if weekStartsOn is between 1 and 7 _and_ is not NaN\n\n  if (!(firstWeekContainsDate >= 1 && firstWeekContainsDate <= 7)) {\n    throw new RangeError('firstWeekContainsDate must be between 1 and 7 inclusively');\n  }\n\n  var firstWeekOfNextYear = new Date(0);\n  firstWeekOfNextYear.setUTCFullYear(year + 1, 0, firstWeekContainsDate);\n  firstWeekOfNextYear.setUTCHours(0, 0, 0, 0);\n  var startOfNextYear = startOfUTCWeek(firstWeekOfNextYear, dirtyOptions);\n  var firstWeekOfThisYear = new Date(0);\n  firstWeekOfThisYear.setUTCFullYear(year, 0, firstWeekContainsDate);\n  firstWeekOfThisYear.setUTCHours(0, 0, 0, 0);\n  var startOfThisYear = startOfUTCWeek(firstWeekOfThisYear, dirtyOptions);\n\n  if (date.getTime() >= startOfNextYear.getTime()) {\n    return year + 1;\n  } else if (date.getTime() >= startOfThisYear.getTime()) {\n    return year;\n  } else {\n    return year - 1;\n  }\n}","import toInteger from '../toInteger/index.js';\nimport toDate from '../../toDate/index.js'; // This function will be a part of public API when UTC function will be implemented.\n// See issue: https://github.com/date-fns/date-fns/issues/376\n\nexport default function setUTCDay(dirtyDate, dirtyDay, dirtyOptions) {\n  if (arguments.length < 2) {\n    throw new TypeError('2 arguments required, but only ' + arguments.length + ' present');\n  }\n\n  var options = dirtyOptions || {};\n  var locale = options.locale;\n  var localeWeekStartsOn = locale && locale.options && locale.options.weekStartsOn;\n  var defaultWeekStartsOn = localeWeekStartsOn == null ? 0 : toInteger(localeWeekStartsOn);\n  var weekStartsOn = options.weekStartsOn == null ? defaultWeekStartsOn : toInteger(options.weekStartsOn); // Test if weekStartsOn is between 0 and 6 _and_ is not NaN\n\n  if (!(weekStartsOn >= 0 && weekStartsOn <= 6)) {\n    throw new RangeError('weekStartsOn must be between 0 and 6 inclusively');\n  }\n\n  var date = toDate(dirtyDate);\n  var day = toInteger(dirtyDay);\n  var currentDay = date.getUTCDay();\n  var remainder = day % 7;\n  var dayIndex = (remainder + 7) % 7;\n  var diff = (dayIndex < weekStartsOn ? 7 : 0) + day - currentDay;\n  date.setUTCDate(date.getUTCDate() + diff);\n  return date;\n}","import toDate from '../../toDate/index.js'; // This function will be a part of public API when UTC function will be implemented.\n// See issue: https://github.com/date-fns/date-fns/issues/376\n\nexport default function startOfUTCISOWeek(dirtyDate) {\n  if (arguments.length < 1) {\n    throw new TypeError('1 argument required, but only ' + arguments.length + ' present');\n  }\n\n  var weekStartsOn = 1;\n  var date = toDate(dirtyDate);\n  var day = date.getUTCDay();\n  var diff = (day < weekStartsOn ? 7 : 0) + day - weekStartsOn;\n  date.setUTCDate(date.getUTCDate() - diff);\n  date.setUTCHours(0, 0, 0, 0);\n  return date;\n}","import toDate from '../../toDate/index.js';\nimport startOfUTCISOWeek from '../startOfUTCISOWeek/index.js'; // This function will be a part of public API when UTC function will be implemented.\n// See issue: https://github.com/date-fns/date-fns/issues/376\n\nexport default function getUTCISOWeekYear(dirtyDate) {\n  if (arguments.length < 1) {\n    throw new TypeError('1 argument required, but only ' + arguments.length + ' present');\n  }\n\n  var date = toDate(dirtyDate);\n  var year = date.getUTCFullYear();\n  var fourthOfJanuaryOfNextYear = new Date(0);\n  fourthOfJanuaryOfNextYear.setUTCFullYear(year + 1, 0, 4);\n  fourthOfJanuaryOfNextYear.setUTCHours(0, 0, 0, 0);\n  var startOfNextYear = startOfUTCISOWeek(fourthOfJanuaryOfNextYear);\n  var fourthOfJanuaryOfThisYear = new Date(0);\n  fourthOfJanuaryOfThisYear.setUTCFullYear(year, 0, 4);\n  fourthOfJanuaryOfThisYear.setUTCHours(0, 0, 0, 0);\n  var startOfThisYear = startOfUTCISOWeek(fourthOfJanuaryOfThisYear);\n\n  if (date.getTime() >= startOfNextYear.getTime()) {\n    return year + 1;\n  } else if (date.getTime() >= startOfThisYear.getTime()) {\n    return year;\n  } else {\n    return year - 1;\n  }\n}","import toDate from '../../toDate/index.js';\nimport startOfUTCISOWeek from '../startOfUTCISOWeek/index.js';\nimport startOfUTCISOWeekYear from '../startOfUTCISOWeekYear/index.js';\nvar MILLISECONDS_IN_WEEK = 604800000; // This function will be a part of public API when UTC function will be implemented.\n// See issue: https://github.com/date-fns/date-fns/issues/376\n\nexport default function getUTCISOWeek(dirtyDate) {\n  if (arguments.length < 1) {\n    throw new TypeError('1 argument required, but only ' + arguments.length + ' present');\n  }\n\n  var date = toDate(dirtyDate);\n  var diff = startOfUTCISOWeek(date).getTime() - startOfUTCISOWeekYear(date).getTime(); // Round the number of days to the nearest integer\n  // because the number of milliseconds in a week is not constant\n  // (e.g. it's different in the week of the daylight saving time clock shift)\n\n  return Math.round(diff / MILLISECONDS_IN_WEEK) + 1;\n}","import getUTCISOWeekYear from '../getUTCISOWeekYear/index.js';\nimport startOfUTCISOWeek from '../startOfUTCISOWeek/index.js'; // This function will be a part of public API when UTC function will be implemented.\n// See issue: https://github.com/date-fns/date-fns/issues/376\n\nexport default function startOfUTCISOWeekYear(dirtyDate) {\n  if (arguments.length < 1) {\n    throw new TypeError('1 argument required, but only ' + arguments.length + ' present');\n  }\n\n  var year = getUTCISOWeekYear(dirtyDate);\n  var fourthOfJanuary = new Date(0);\n  fourthOfJanuary.setUTCFullYear(year, 0, 4);\n  fourthOfJanuary.setUTCHours(0, 0, 0, 0);\n  var date = startOfUTCISOWeek(fourthOfJanuary);\n  return date;\n}","import toDate from '../../toDate/index.js';\nimport startOfUTCWeek from '../startOfUTCWeek/index.js';\nimport startOfUTCWeekYear from '../startOfUTCWeekYear/index.js';\nvar MILLISECONDS_IN_WEEK = 604800000; // This function will be a part of public API when UTC function will be implemented.\n// See issue: https://github.com/date-fns/date-fns/issues/376\n\nexport default function getUTCWeek(dirtyDate, options) {\n  if (arguments.length < 1) {\n    throw new TypeError('1 argument required, but only ' + arguments.length + ' present');\n  }\n\n  var date = toDate(dirtyDate);\n  var diff = startOfUTCWeek(date, options).getTime() - startOfUTCWeekYear(date, options).getTime(); // Round the number of days to the nearest integer\n  // because the number of milliseconds in a week is not constant\n  // (e.g. it's different in the week of the daylight saving time clock shift)\n\n  return Math.round(diff / MILLISECONDS_IN_WEEK) + 1;\n}","import toInteger from '../toInteger/index.js';\nimport getUTCWeekYear from '../getUTCWeekYear/index.js';\nimport startOfUTCWeek from '../startOfUTCWeek/index.js'; // This function will be a part of public API when UTC function will be implemented.\n// See issue: https://github.com/date-fns/date-fns/issues/376\n\nexport default function startOfUTCWeekYear(dirtyDate, dirtyOptions) {\n  if (arguments.length < 1) {\n    throw new TypeError('1 argument required, but only ' + arguments.length + ' present');\n  }\n\n  var options = dirtyOptions || {};\n  var locale = options.locale;\n  var localeFirstWeekContainsDate = locale && locale.options && locale.options.firstWeekContainsDate;\n  var defaultFirstWeekContainsDate = localeFirstWeekContainsDate == null ? 1 : toInteger(localeFirstWeekContainsDate);\n  var firstWeekContainsDate = options.firstWeekContainsDate == null ? defaultFirstWeekContainsDate : toInteger(options.firstWeekContainsDate);\n  var year = getUTCWeekYear(dirtyDate, dirtyOptions);\n  var firstWeek = new Date(0);\n  firstWeek.setUTCFullYear(year, 0, firstWeekContainsDate);\n  firstWeek.setUTCHours(0, 0, 0, 0);\n  var date = startOfUTCWeek(firstWeek, dirtyOptions);\n  return date;\n}","import getUTCWeekYear from '../../../_lib/getUTCWeekYear/index.js';\nimport setUTCDay from '../../../_lib/setUTCDay/index.js';\nimport setUTCISODay from '../../../_lib/setUTCISODay/index.js';\nimport setUTCISOWeek from '../../../_lib/setUTCISOWeek/index.js';\nimport setUTCWeek from '../../../_lib/setUTCWeek/index.js';\nimport startOfUTCISOWeek from '../../../_lib/startOfUTCISOWeek/index.js';\nimport startOfUTCWeek from '../../../_lib/startOfUTCWeek/index.js';\nvar MILLISECONDS_IN_HOUR = 3600000;\nvar MILLISECONDS_IN_MINUTE = 60000;\nvar MILLISECONDS_IN_SECOND = 1000;\nvar numericPatterns = {\n  month: /^(1[0-2]|0?\\d)/,\n  // 0 to 12\n  date: /^(3[0-1]|[0-2]?\\d)/,\n  // 0 to 31\n  dayOfYear: /^(36[0-6]|3[0-5]\\d|[0-2]?\\d?\\d)/,\n  // 0 to 366\n  week: /^(5[0-3]|[0-4]?\\d)/,\n  // 0 to 53\n  hour23h: /^(2[0-3]|[0-1]?\\d)/,\n  // 0 to 23\n  hour24h: /^(2[0-4]|[0-1]?\\d)/,\n  // 0 to 24\n  hour11h: /^(1[0-1]|0?\\d)/,\n  // 0 to 11\n  hour12h: /^(1[0-2]|0?\\d)/,\n  // 0 to 12\n  minute: /^[0-5]?\\d/,\n  // 0 to 59\n  second: /^[0-5]?\\d/,\n  // 0 to 59\n  singleDigit: /^\\d/,\n  // 0 to 9\n  twoDigits: /^\\d{1,2}/,\n  // 0 to 99\n  threeDigits: /^\\d{1,3}/,\n  // 0 to 999\n  fourDigits: /^\\d{1,4}/,\n  // 0 to 9999\n  anyDigitsSigned: /^-?\\d+/,\n  singleDigitSigned: /^-?\\d/,\n  // 0 to 9, -0 to -9\n  twoDigitsSigned: /^-?\\d{1,2}/,\n  // 0 to 99, -0 to -99\n  threeDigitsSigned: /^-?\\d{1,3}/,\n  // 0 to 999, -0 to -999\n  fourDigitsSigned: /^-?\\d{1,4}/ // 0 to 9999, -0 to -9999\n\n};\nvar timezonePatterns = {\n  basicOptionalMinutes: /^([+-])(\\d{2})(\\d{2})?|Z/,\n  basic: /^([+-])(\\d{2})(\\d{2})|Z/,\n  basicOptionalSeconds: /^([+-])(\\d{2})(\\d{2})((\\d{2}))?|Z/,\n  extended: /^([+-])(\\d{2}):(\\d{2})|Z/,\n  extendedOptionalSeconds: /^([+-])(\\d{2}):(\\d{2})(:(\\d{2}))?|Z/\n};\n\nfunction parseNumericPattern(pattern, string, valueCallback) {\n  var matchResult = string.match(pattern);\n\n  if (!matchResult) {\n    return null;\n  }\n\n  var value = parseInt(matchResult[0], 10);\n  return {\n    value: valueCallback ? valueCallback(value) : value,\n    rest: string.slice(matchResult[0].length)\n  };\n}\n\nfunction parseTimezonePattern(pattern, string) {\n  var matchResult = string.match(pattern);\n\n  if (!matchResult) {\n    return null;\n  } // Input is 'Z'\n\n\n  if (matchResult[0] === 'Z') {\n    return {\n      value: 0,\n      rest: string.slice(1)\n    };\n  }\n\n  var sign = matchResult[1] === '+' ? 1 : -1;\n  var hours = matchResult[2] ? parseInt(matchResult[2], 10) : 0;\n  var minutes = matchResult[3] ? parseInt(matchResult[3], 10) : 0;\n  var seconds = matchResult[5] ? parseInt(matchResult[5], 10) : 0;\n  return {\n    value: sign * (hours * MILLISECONDS_IN_HOUR + minutes * MILLISECONDS_IN_MINUTE + seconds * MILLISECONDS_IN_SECOND),\n    rest: string.slice(matchResult[0].length)\n  };\n}\n\nfunction parseAnyDigitsSigned(string, valueCallback) {\n  return parseNumericPattern(numericPatterns.anyDigitsSigned, string, valueCallback);\n}\n\nfunction parseNDigits(n, string, valueCallback) {\n  switch (n) {\n    case 1:\n      return parseNumericPattern(numericPatterns.singleDigit, string, valueCallback);\n\n    case 2:\n      return parseNumericPattern(numericPatterns.twoDigits, string, valueCallback);\n\n    case 3:\n      return parseNumericPattern(numericPatterns.threeDigits, string, valueCallback);\n\n    case 4:\n      return parseNumericPattern(numericPatterns.fourDigits, string, valueCallback);\n\n    default:\n      return parseNumericPattern(new RegExp('^\\\\d{1,' + n + '}'), string, valueCallback);\n  }\n}\n\nfunction parseNDigitsSigned(n, string, valueCallback) {\n  switch (n) {\n    case 1:\n      return parseNumericPattern(numericPatterns.singleDigitSigned, string, valueCallback);\n\n    case 2:\n      return parseNumericPattern(numericPatterns.twoDigitsSigned, string, valueCallback);\n\n    case 3:\n      return parseNumericPattern(numericPatterns.threeDigitsSigned, string, valueCallback);\n\n    case 4:\n      return parseNumericPattern(numericPatterns.fourDigitsSigned, string, valueCallback);\n\n    default:\n      return parseNumericPattern(new RegExp('^-?\\\\d{1,' + n + '}'), string, valueCallback);\n  }\n}\n\nfunction dayPeriodEnumToHours(enumValue) {\n  switch (enumValue) {\n    case 'morning':\n      return 4;\n\n    case 'evening':\n      return 17;\n\n    case 'pm':\n    case 'noon':\n    case 'afternoon':\n      return 12;\n\n    case 'am':\n    case 'midnight':\n    case 'night':\n    default:\n      return 0;\n  }\n}\n\nfunction normalizeTwoDigitYear(twoDigitYear, currentYear) {\n  var isCommonEra = currentYear > 0; // Absolute number of the current year:\n  // 1 -> 1 AC\n  // 0 -> 1 BC\n  // -1 -> 2 BC\n\n  var absCurrentYear = isCommonEra ? currentYear : 1 - currentYear;\n  var result;\n\n  if (absCurrentYear <= 50) {\n    result = twoDigitYear || 100;\n  } else {\n    var rangeEnd = absCurrentYear + 50;\n    var rangeEndCentury = Math.floor(rangeEnd / 100) * 100;\n    var isPreviousCentury = twoDigitYear >= rangeEnd % 100;\n    result = twoDigitYear + rangeEndCentury - (isPreviousCentury ? 100 : 0);\n  }\n\n  return isCommonEra ? result : 1 - result;\n}\n\nvar DAYS_IN_MONTH = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];\nvar DAYS_IN_MONTH_LEAP_YEAR = [31, 29, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31]; // User for validation\n\nfunction isLeapYearIndex(year) {\n  return year % 400 === 0 || year % 4 === 0 && year % 100 !== 0;\n}\n/*\n * |     | Unit                           |     | Unit                           |\n * |-----|--------------------------------|-----|--------------------------------|\n * |  a  | AM, PM                         |  A* | Milliseconds in day            |\n * |  b  | AM, PM, noon, midnight         |  B  | Flexible day period            |\n * |  c  | Stand-alone local day of week  |  C* | Localized hour w/ day period   |\n * |  d  | Day of month                   |  D  | Day of year                    |\n * |  e  | Local day of week              |  E  | Day of week                    |\n * |  f  |                                |  F* | Day of week in month           |\n * |  g* | Modified Julian day            |  G  | Era                            |\n * |  h  | Hour [1-12]                    |  H  | Hour [0-23]                    |\n * |  i! | ISO day of week                |  I! | ISO week of year               |\n * |  j* | Localized hour w/ day period   |  J* | Localized hour w/o day period  |\n * |  k  | Hour [1-24]                    |  K  | Hour [0-11]                    |\n * |  l* | (deprecated)                   |  L  | Stand-alone month              |\n * |  m  | Minute                         |  M  | Month                          |\n * |  n  |                                |  N  |                                |\n * |  o! | Ordinal number modifier        |  O* | Timezone (GMT)                 |\n * |  p  |                                |  P  |                                |\n * |  q  | Stand-alone quarter            |  Q  | Quarter                        |\n * |  r* | Related Gregorian year         |  R! | ISO week-numbering year        |\n * |  s  | Second                         |  S  | Fraction of second             |\n * |  t! | Seconds timestamp              |  T! | Milliseconds timestamp         |\n * |  u  | Extended year                  |  U* | Cyclic year                    |\n * |  v* | Timezone (generic non-locat.)  |  V* | Timezone (location)            |\n * |  w  | Local week of year             |  W* | Week of month                  |\n * |  x  | Timezone (ISO-8601 w/o Z)      |  X  | Timezone (ISO-8601)            |\n * |  y  | Year (abs)                     |  Y  | Local week-numbering year      |\n * |  z* | Timezone (specific non-locat.) |  Z* | Timezone (aliases)             |\n *\n * Letters marked by * are not implemented but reserved by Unicode standard.\n *\n * Letters marked by ! are non-standard, but implemented by date-fns:\n * - `o` modifies the previous token to turn it into an ordinal (see `parse` docs)\n * - `i` is ISO day of week. For `i` and `ii` is returns numeric ISO week days,\n *   i.e. 7 for Sunday, 1 for Monday, etc.\n * - `I` is ISO week of year, as opposed to `w` which is local week of year.\n * - `R` is ISO week-numbering year, as opposed to `Y` which is local week-numbering year.\n *   `R` is supposed to be used in conjunction with `I` and `i`\n *   for universal ISO week-numbering date, whereas\n *   `Y` is supposed to be used in conjunction with `w` and `e`\n *   for week-numbering date specific to the locale.\n */\n\n\nvar parsers = {\n  // Era\n  G: {\n    priority: 140,\n    parse: function (string, token, match, _options) {\n      switch (token) {\n        // AD, BC\n        case 'G':\n        case 'GG':\n        case 'GGG':\n          return match.era(string, {\n            width: 'abbreviated'\n          }) || match.era(string, {\n            width: 'narrow'\n          });\n        // A, B\n\n        case 'GGGGG':\n          return match.era(string, {\n            width: 'narrow'\n          });\n        // Anno Domini, Before Christ\n\n        case 'GGGG':\n        default:\n          return match.era(string, {\n            width: 'wide'\n          }) || match.era(string, {\n            width: 'abbreviated'\n          }) || match.era(string, {\n            width: 'narrow'\n          });\n      }\n    },\n    set: function (date, flags, value, _options) {\n      flags.era = value;\n      date.setUTCFullYear(value, 0, 1);\n      date.setUTCHours(0, 0, 0, 0);\n      return date;\n    },\n    incompatibleTokens: ['R', 'u', 't', 'T']\n  },\n  // Year\n  y: {\n    // From http://www.unicode.org/reports/tr35/tr35-31/tr35-dates.html#Date_Format_Patterns\n    // | Year     |     y | yy |   yyy |  yyyy | yyyyy |\n    // |----------|-------|----|-------|-------|-------|\n    // | AD 1     |     1 | 01 |   001 |  0001 | 00001 |\n    // | AD 12    |    12 | 12 |   012 |  0012 | 00012 |\n    // | AD 123   |   123 | 23 |   123 |  0123 | 00123 |\n    // | AD 1234  |  1234 | 34 |  1234 |  1234 | 01234 |\n    // | AD 12345 | 12345 | 45 | 12345 | 12345 | 12345 |\n    priority: 130,\n    parse: function (string, token, match, _options) {\n      var valueCallback = function (year) {\n        return {\n          year: year,\n          isTwoDigitYear: token === 'yy'\n        };\n      };\n\n      switch (token) {\n        case 'y':\n          return parseNDigits(4, string, valueCallback);\n\n        case 'yo':\n          return match.ordinalNumber(string, {\n            unit: 'year',\n            valueCallback: valueCallback\n          });\n\n        default:\n          return parseNDigits(token.length, string, valueCallback);\n      }\n    },\n    validate: function (_date, value, _options) {\n      return value.isTwoDigitYear || value.year > 0;\n    },\n    set: function (date, flags, value, _options) {\n      var currentYear = date.getUTCFullYear();\n\n      if (value.isTwoDigitYear) {\n        var normalizedTwoDigitYear = normalizeTwoDigitYear(value.year, currentYear);\n        date.setUTCFullYear(normalizedTwoDigitYear, 0, 1);\n        date.setUTCHours(0, 0, 0, 0);\n        return date;\n      }\n\n      var year = !('era' in flags) || flags.era === 1 ? value.year : 1 - value.year;\n      date.setUTCFullYear(year, 0, 1);\n      date.setUTCHours(0, 0, 0, 0);\n      return date;\n    },\n    incompatibleTokens: ['Y', 'R', 'u', 'w', 'I', 'i', 'e', 'c', 't', 'T']\n  },\n  // Local week-numbering year\n  Y: {\n    priority: 130,\n    parse: function (string, token, match, _options) {\n      var valueCallback = function (year) {\n        return {\n          year: year,\n          isTwoDigitYear: token === 'YY'\n        };\n      };\n\n      switch (token) {\n        case 'Y':\n          return parseNDigits(4, string, valueCallback);\n\n        case 'Yo':\n          return match.ordinalNumber(string, {\n            unit: 'year',\n            valueCallback: valueCallback\n          });\n\n        default:\n          return parseNDigits(token.length, string, valueCallback);\n      }\n    },\n    validate: function (_date, value, _options) {\n      return value.isTwoDigitYear || value.year > 0;\n    },\n    set: function (date, flags, value, options) {\n      var currentYear = getUTCWeekYear(date, options);\n\n      if (value.isTwoDigitYear) {\n        var normalizedTwoDigitYear = normalizeTwoDigitYear(value.year, currentYear);\n        date.setUTCFullYear(normalizedTwoDigitYear, 0, options.firstWeekContainsDate);\n        date.setUTCHours(0, 0, 0, 0);\n        return startOfUTCWeek(date, options);\n      }\n\n      var year = !('era' in flags) || flags.era === 1 ? value.year : 1 - value.year;\n      date.setUTCFullYear(year, 0, options.firstWeekContainsDate);\n      date.setUTCHours(0, 0, 0, 0);\n      return startOfUTCWeek(date, options);\n    },\n    incompatibleTokens: ['y', 'R', 'u', 'Q', 'q', 'M', 'L', 'I', 'd', 'D', 'i', 't', 'T']\n  },\n  // ISO week-numbering year\n  R: {\n    priority: 130,\n    parse: function (string, token, _match, _options) {\n      if (token === 'R') {\n        return parseNDigitsSigned(4, string);\n      }\n\n      return parseNDigitsSigned(token.length, string);\n    },\n    set: function (_date, _flags, value, _options) {\n      var firstWeekOfYear = new Date(0);\n      firstWeekOfYear.setUTCFullYear(value, 0, 4);\n      firstWeekOfYear.setUTCHours(0, 0, 0, 0);\n      return startOfUTCISOWeek(firstWeekOfYear);\n    },\n    incompatibleTokens: ['G', 'y', 'Y', 'u', 'Q', 'q', 'M', 'L', 'w', 'd', 'D', 'e', 'c', 't', 'T']\n  },\n  // Extended year\n  u: {\n    priority: 130,\n    parse: function (string, token, _match, _options) {\n      if (token === 'u') {\n        return parseNDigitsSigned(4, string);\n      }\n\n      return parseNDigitsSigned(token.length, string);\n    },\n    set: function (date, _flags, value, _options) {\n      date.setUTCFullYear(value, 0, 1);\n      date.setUTCHours(0, 0, 0, 0);\n      return date;\n    },\n    incompatibleTokens: ['G', 'y', 'Y', 'R', 'w', 'I', 'i', 'e', 'c', 't', 'T']\n  },\n  // Quarter\n  Q: {\n    priority: 120,\n    parse: function (string, token, match, _options) {\n      switch (token) {\n        // 1, 2, 3, 4\n        case 'Q':\n        case 'QQ':\n          // 01, 02, 03, 04\n          return parseNDigits(token.length, string);\n        // 1st, 2nd, 3rd, 4th\n\n        case 'Qo':\n          return match.ordinalNumber(string, {\n            unit: 'quarter'\n          });\n        // Q1, Q2, Q3, Q4\n\n        case 'QQQ':\n          return match.quarter(string, {\n            width: 'abbreviated',\n            context: 'formatting'\n          }) || match.quarter(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n        // 1, 2, 3, 4 (narrow quarter; could be not numerical)\n\n        case 'QQQQQ':\n          return match.quarter(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n        // 1st quarter, 2nd quarter, ...\n\n        case 'QQQQ':\n        default:\n          return match.quarter(string, {\n            width: 'wide',\n            context: 'formatting'\n          }) || match.quarter(string, {\n            width: 'abbreviated',\n            context: 'formatting'\n          }) || match.quarter(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n      }\n    },\n    validate: function (_date, value, _options) {\n      return value >= 1 && value <= 4;\n    },\n    set: function (date, _flags, value, _options) {\n      date.setUTCMonth((value - 1) * 3, 1);\n      date.setUTCHours(0, 0, 0, 0);\n      return date;\n    },\n    incompatibleTokens: ['Y', 'R', 'q', 'M', 'L', 'w', 'I', 'd', 'D', 'i', 'e', 'c', 't', 'T']\n  },\n  // Stand-alone quarter\n  q: {\n    priority: 120,\n    parse: function (string, token, match, _options) {\n      switch (token) {\n        // 1, 2, 3, 4\n        case 'q':\n        case 'qq':\n          // 01, 02, 03, 04\n          return parseNDigits(token.length, string);\n        // 1st, 2nd, 3rd, 4th\n\n        case 'qo':\n          return match.ordinalNumber(string, {\n            unit: 'quarter'\n          });\n        // Q1, Q2, Q3, Q4\n\n        case 'qqq':\n          return match.quarter(string, {\n            width: 'abbreviated',\n            context: 'standalone'\n          }) || match.quarter(string, {\n            width: 'narrow',\n            context: 'standalone'\n          });\n        // 1, 2, 3, 4 (narrow quarter; could be not numerical)\n\n        case 'qqqqq':\n          return match.quarter(string, {\n            width: 'narrow',\n            context: 'standalone'\n          });\n        // 1st quarter, 2nd quarter, ...\n\n        case 'qqqq':\n        default:\n          return match.quarter(string, {\n            width: 'wide',\n            context: 'standalone'\n          }) || match.quarter(string, {\n            width: 'abbreviated',\n            context: 'standalone'\n          }) || match.quarter(string, {\n            width: 'narrow',\n            context: 'standalone'\n          });\n      }\n    },\n    validate: function (_date, value, _options) {\n      return value >= 1 && value <= 4;\n    },\n    set: function (date, _flags, value, _options) {\n      date.setUTCMonth((value - 1) * 3, 1);\n      date.setUTCHours(0, 0, 0, 0);\n      return date;\n    },\n    incompatibleTokens: ['Y', 'R', 'Q', 'M', 'L', 'w', 'I', 'd', 'D', 'i', 'e', 'c', 't', 'T']\n  },\n  // Month\n  M: {\n    priority: 110,\n    parse: function (string, token, match, _options) {\n      var valueCallback = function (value) {\n        return value - 1;\n      };\n\n      switch (token) {\n        // 1, 2, ..., 12\n        case 'M':\n          return parseNumericPattern(numericPatterns.month, string, valueCallback);\n        // 01, 02, ..., 12\n\n        case 'MM':\n          return parseNDigits(2, string, valueCallback);\n        // 1st, 2nd, ..., 12th\n\n        case 'Mo':\n          return match.ordinalNumber(string, {\n            unit: 'month',\n            valueCallback: valueCallback\n          });\n        // Jan, Feb, ..., Dec\n\n        case 'MMM':\n          return match.month(string, {\n            width: 'abbreviated',\n            context: 'formatting'\n          }) || match.month(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n        // J, F, ..., D\n\n        case 'MMMMM':\n          return match.month(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n        // January, February, ..., December\n\n        case 'MMMM':\n        default:\n          return match.month(string, {\n            width: 'wide',\n            context: 'formatting'\n          }) || match.month(string, {\n            width: 'abbreviated',\n            context: 'formatting'\n          }) || match.month(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n      }\n    },\n    validate: function (_date, value, _options) {\n      return value >= 0 && value <= 11;\n    },\n    set: function (date, _flags, value, _options) {\n      date.setUTCMonth(value, 1);\n      date.setUTCHours(0, 0, 0, 0);\n      return date;\n    },\n    incompatibleTokens: ['Y', 'R', 'q', 'Q', 'L', 'w', 'I', 'D', 'i', 'e', 'c', 't', 'T']\n  },\n  // Stand-alone month\n  L: {\n    priority: 110,\n    parse: function (string, token, match, _options) {\n      var valueCallback = function (value) {\n        return value - 1;\n      };\n\n      switch (token) {\n        // 1, 2, ..., 12\n        case 'L':\n          return parseNumericPattern(numericPatterns.month, string, valueCallback);\n        // 01, 02, ..., 12\n\n        case 'LL':\n          return parseNDigits(2, string, valueCallback);\n        // 1st, 2nd, ..., 12th\n\n        case 'Lo':\n          return match.ordinalNumber(string, {\n            unit: 'month',\n            valueCallback: valueCallback\n          });\n        // Jan, Feb, ..., Dec\n\n        case 'LLL':\n          return match.month(string, {\n            width: 'abbreviated',\n            context: 'standalone'\n          }) || match.month(string, {\n            width: 'narrow',\n            context: 'standalone'\n          });\n        // J, F, ..., D\n\n        case 'LLLLL':\n          return match.month(string, {\n            width: 'narrow',\n            context: 'standalone'\n          });\n        // January, February, ..., December\n\n        case 'LLLL':\n        default:\n          return match.month(string, {\n            width: 'wide',\n            context: 'standalone'\n          }) || match.month(string, {\n            width: 'abbreviated',\n            context: 'standalone'\n          }) || match.month(string, {\n            width: 'narrow',\n            context: 'standalone'\n          });\n      }\n    },\n    validate: function (_date, value, _options) {\n      return value >= 0 && value <= 11;\n    },\n    set: function (date, _flags, value, _options) {\n      date.setUTCMonth(value, 1);\n      date.setUTCHours(0, 0, 0, 0);\n      return date;\n    },\n    incompatibleTokens: ['Y', 'R', 'q', 'Q', 'M', 'w', 'I', 'D', 'i', 'e', 'c', 't', 'T']\n  },\n  // Local week of year\n  w: {\n    priority: 100,\n    parse: function (string, token, match, _options) {\n      switch (token) {\n        case 'w':\n          return parseNumericPattern(numericPatterns.week, string);\n\n        case 'wo':\n          return match.ordinalNumber(string, {\n            unit: 'week'\n          });\n\n        default:\n          return parseNDigits(token.length, string);\n      }\n    },\n    validate: function (_date, value, _options) {\n      return value >= 1 && value <= 53;\n    },\n    set: function (date, _flags, value, options) {\n      return startOfUTCWeek(setUTCWeek(date, value, options), options);\n    },\n    incompatibleTokens: ['y', 'R', 'u', 'q', 'Q', 'M', 'L', 'I', 'd', 'D', 'i', 't', 'T']\n  },\n  // ISO week of year\n  I: {\n    priority: 100,\n    parse: function (string, token, match, _options) {\n      switch (token) {\n        case 'I':\n          return parseNumericPattern(numericPatterns.week, string);\n\n        case 'Io':\n          return match.ordinalNumber(string, {\n            unit: 'week'\n          });\n\n        default:\n          return parseNDigits(token.length, string);\n      }\n    },\n    validate: function (_date, value, _options) {\n      return value >= 1 && value <= 53;\n    },\n    set: function (date, _flags, value, options) {\n      return startOfUTCISOWeek(setUTCISOWeek(date, value, options), options);\n    },\n    incompatibleTokens: ['y', 'Y', 'u', 'q', 'Q', 'M', 'L', 'w', 'd', 'D', 'e', 'c', 't', 'T']\n  },\n  // Day of the month\n  d: {\n    priority: 90,\n    parse: function (string, token, match, _options) {\n      switch (token) {\n        case 'd':\n          return parseNumericPattern(numericPatterns.date, string);\n\n        case 'do':\n          return match.ordinalNumber(string, {\n            unit: 'date'\n          });\n\n        default:\n          return parseNDigits(token.length, string);\n      }\n    },\n    validate: function (date, value, _options) {\n      var year = date.getUTCFullYear();\n      var isLeapYear = isLeapYearIndex(year);\n      var month = date.getUTCMonth();\n\n      if (isLeapYear) {\n        return value >= 1 && value <= DAYS_IN_MONTH_LEAP_YEAR[month];\n      } else {\n        return value >= 1 && value <= DAYS_IN_MONTH[month];\n      }\n    },\n    set: function (date, _flags, value, _options) {\n      date.setUTCDate(value);\n      date.setUTCHours(0, 0, 0, 0);\n      return date;\n    },\n    incompatibleTokens: ['Y', 'R', 'q', 'Q', 'w', 'I', 'D', 'i', 'e', 'c', 't', 'T']\n  },\n  // Day of year\n  D: {\n    priority: 90,\n    parse: function (string, token, match, _options) {\n      switch (token) {\n        case 'D':\n        case 'DD':\n          return parseNumericPattern(numericPatterns.dayOfYear, string);\n\n        case 'Do':\n          return match.ordinalNumber(string, {\n            unit: 'date'\n          });\n\n        default:\n          return parseNDigits(token.length, string);\n      }\n    },\n    validate: function (date, value, _options) {\n      var year = date.getUTCFullYear();\n      var isLeapYear = isLeapYearIndex(year);\n\n      if (isLeapYear) {\n        return value >= 1 && value <= 366;\n      } else {\n        return value >= 1 && value <= 365;\n      }\n    },\n    set: function (date, _flags, value, _options) {\n      date.setUTCMonth(0, value);\n      date.setUTCHours(0, 0, 0, 0);\n      return date;\n    },\n    incompatibleTokens: ['Y', 'R', 'q', 'Q', 'M', 'L', 'w', 'I', 'd', 'E', 'i', 'e', 'c', 't', 'T']\n  },\n  // Day of week\n  E: {\n    priority: 90,\n    parse: function (string, token, match, _options) {\n      switch (token) {\n        // Tue\n        case 'E':\n        case 'EE':\n        case 'EEE':\n          return match.day(string, {\n            width: 'abbreviated',\n            context: 'formatting'\n          }) || match.day(string, {\n            width: 'short',\n            context: 'formatting'\n          }) || match.day(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n        // T\n\n        case 'EEEEE':\n          return match.day(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n        // Tu\n\n        case 'EEEEEE':\n          return match.day(string, {\n            width: 'short',\n            context: 'formatting'\n          }) || match.day(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n        // Tuesday\n\n        case 'EEEE':\n        default:\n          return match.day(string, {\n            width: 'wide',\n            context: 'formatting'\n          }) || match.day(string, {\n            width: 'abbreviated',\n            context: 'formatting'\n          }) || match.day(string, {\n            width: 'short',\n            context: 'formatting'\n          }) || match.day(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n      }\n    },\n    validate: function (_date, value, _options) {\n      return value >= 0 && value <= 6;\n    },\n    set: function (date, _flags, value, options) {\n      date = setUTCDay(date, value, options);\n      date.setUTCHours(0, 0, 0, 0);\n      return date;\n    },\n    incompatibleTokens: ['D', 'i', 'e', 'c', 't', 'T']\n  },\n  // Local day of week\n  e: {\n    priority: 90,\n    parse: function (string, token, match, options) {\n      var valueCallback = function (value) {\n        var wholeWeekDays = Math.floor((value - 1) / 7) * 7;\n        return (value + options.weekStartsOn + 6) % 7 + wholeWeekDays;\n      };\n\n      switch (token) {\n        // 3\n        case 'e':\n        case 'ee':\n          // 03\n          return parseNDigits(token.length, string, valueCallback);\n        // 3rd\n\n        case 'eo':\n          return match.ordinalNumber(string, {\n            unit: 'day',\n            valueCallback: valueCallback\n          });\n        // Tue\n\n        case 'eee':\n          return match.day(string, {\n            width: 'abbreviated',\n            context: 'formatting'\n          }) || match.day(string, {\n            width: 'short',\n            context: 'formatting'\n          }) || match.day(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n        // T\n\n        case 'eeeee':\n          return match.day(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n        // Tu\n\n        case 'eeeeee':\n          return match.day(string, {\n            width: 'short',\n            context: 'formatting'\n          }) || match.day(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n        // Tuesday\n\n        case 'eeee':\n        default:\n          return match.day(string, {\n            width: 'wide',\n            context: 'formatting'\n          }) || match.day(string, {\n            width: 'abbreviated',\n            context: 'formatting'\n          }) || match.day(string, {\n            width: 'short',\n            context: 'formatting'\n          }) || match.day(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n      }\n    },\n    validate: function (_date, value, _options) {\n      return value >= 0 && value <= 6;\n    },\n    set: function (date, _flags, value, options) {\n      date = setUTCDay(date, value, options);\n      date.setUTCHours(0, 0, 0, 0);\n      return date;\n    },\n    incompatibleTokens: ['y', 'R', 'u', 'q', 'Q', 'M', 'L', 'I', 'd', 'D', 'E', 'i', 'c', 't', 'T']\n  },\n  // Stand-alone local day of week\n  c: {\n    priority: 90,\n    parse: function (string, token, match, options) {\n      var valueCallback = function (value) {\n        var wholeWeekDays = Math.floor((value - 1) / 7) * 7;\n        return (value + options.weekStartsOn + 6) % 7 + wholeWeekDays;\n      };\n\n      switch (token) {\n        // 3\n        case 'c':\n        case 'cc':\n          // 03\n          return parseNDigits(token.length, string, valueCallback);\n        // 3rd\n\n        case 'co':\n          return match.ordinalNumber(string, {\n            unit: 'day',\n            valueCallback: valueCallback\n          });\n        // Tue\n\n        case 'ccc':\n          return match.day(string, {\n            width: 'abbreviated',\n            context: 'standalone'\n          }) || match.day(string, {\n            width: 'short',\n            context: 'standalone'\n          }) || match.day(string, {\n            width: 'narrow',\n            context: 'standalone'\n          });\n        // T\n\n        case 'ccccc':\n          return match.day(string, {\n            width: 'narrow',\n            context: 'standalone'\n          });\n        // Tu\n\n        case 'cccccc':\n          return match.day(string, {\n            width: 'short',\n            context: 'standalone'\n          }) || match.day(string, {\n            width: 'narrow',\n            context: 'standalone'\n          });\n        // Tuesday\n\n        case 'cccc':\n        default:\n          return match.day(string, {\n            width: 'wide',\n            context: 'standalone'\n          }) || match.day(string, {\n            width: 'abbreviated',\n            context: 'standalone'\n          }) || match.day(string, {\n            width: 'short',\n            context: 'standalone'\n          }) || match.day(string, {\n            width: 'narrow',\n            context: 'standalone'\n          });\n      }\n    },\n    validate: function (_date, value, _options) {\n      return value >= 0 && value <= 6;\n    },\n    set: function (date, _flags, value, options) {\n      date = setUTCDay(date, value, options);\n      date.setUTCHours(0, 0, 0, 0);\n      return date;\n    },\n    incompatibleTokens: ['y', 'R', 'u', 'q', 'Q', 'M', 'L', 'I', 'd', 'D', 'E', 'i', 'e', 't', 'T']\n  },\n  // ISO day of week\n  i: {\n    priority: 90,\n    parse: function (string, token, match, _options) {\n      var valueCallback = function (value) {\n        if (value === 0) {\n          return 7;\n        }\n\n        return value;\n      };\n\n      switch (token) {\n        // 2\n        case 'i':\n        case 'ii':\n          // 02\n          return parseNDigits(token.length, string);\n        // 2nd\n\n        case 'io':\n          return match.ordinalNumber(string, {\n            unit: 'day'\n          });\n        // Tue\n\n        case 'iii':\n          return match.day(string, {\n            width: 'abbreviated',\n            context: 'formatting',\n            valueCallback: valueCallback\n          }) || match.day(string, {\n            width: 'short',\n            context: 'formatting',\n            valueCallback: valueCallback\n          }) || match.day(string, {\n            width: 'narrow',\n            context: 'formatting',\n            valueCallback: valueCallback\n          });\n        // T\n\n        case 'iiiii':\n          return match.day(string, {\n            width: 'narrow',\n            context: 'formatting',\n            valueCallback: valueCallback\n          });\n        // Tu\n\n        case 'iiiiii':\n          return match.day(string, {\n            width: 'short',\n            context: 'formatting',\n            valueCallback: valueCallback\n          }) || match.day(string, {\n            width: 'narrow',\n            context: 'formatting',\n            valueCallback: valueCallback\n          });\n        // Tuesday\n\n        case 'iiii':\n        default:\n          return match.day(string, {\n            width: 'wide',\n            context: 'formatting',\n            valueCallback: valueCallback\n          }) || match.day(string, {\n            width: 'abbreviated',\n            context: 'formatting',\n            valueCallback: valueCallback\n          }) || match.day(string, {\n            width: 'short',\n            context: 'formatting',\n            valueCallback: valueCallback\n          }) || match.day(string, {\n            width: 'narrow',\n            context: 'formatting',\n            valueCallback: valueCallback\n          });\n      }\n    },\n    validate: function (_date, value, _options) {\n      return value >= 1 && value <= 7;\n    },\n    set: function (date, _flags, value, options) {\n      date = setUTCISODay(date, value, options);\n      date.setUTCHours(0, 0, 0, 0);\n      return date;\n    },\n    incompatibleTokens: ['y', 'Y', 'u', 'q', 'Q', 'M', 'L', 'w', 'd', 'D', 'E', 'e', 'c', 't', 'T']\n  },\n  // AM or PM\n  a: {\n    priority: 80,\n    parse: function (string, token, match, _options) {\n      switch (token) {\n        case 'a':\n        case 'aa':\n        case 'aaa':\n          return match.dayPeriod(string, {\n            width: 'abbreviated',\n            context: 'formatting'\n          }) || match.dayPeriod(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n\n        case 'aaaaa':\n          return match.dayPeriod(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n\n        case 'aaaa':\n        default:\n          return match.dayPeriod(string, {\n            width: 'wide',\n            context: 'formatting'\n          }) || match.dayPeriod(string, {\n            width: 'abbreviated',\n            context: 'formatting'\n          }) || match.dayPeriod(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n      }\n    },\n    set: function (date, _flags, value, _options) {\n      date.setUTCHours(dayPeriodEnumToHours(value), 0, 0, 0);\n      return date;\n    },\n    incompatibleTokens: ['b', 'B', 'H', 'K', 'k', 't', 'T']\n  },\n  // AM, PM, midnight\n  b: {\n    priority: 80,\n    parse: function (string, token, match, _options) {\n      switch (token) {\n        case 'b':\n        case 'bb':\n        case 'bbb':\n          return match.dayPeriod(string, {\n            width: 'abbreviated',\n            context: 'formatting'\n          }) || match.dayPeriod(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n\n        case 'bbbbb':\n          return match.dayPeriod(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n\n        case 'bbbb':\n        default:\n          return match.dayPeriod(string, {\n            width: 'wide',\n            context: 'formatting'\n          }) || match.dayPeriod(string, {\n            width: 'abbreviated',\n            context: 'formatting'\n          }) || match.dayPeriod(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n      }\n    },\n    set: function (date, _flags, value, _options) {\n      date.setUTCHours(dayPeriodEnumToHours(value), 0, 0, 0);\n      return date;\n    },\n    incompatibleTokens: ['a', 'B', 'H', 'K', 'k', 't', 'T']\n  },\n  // in the morning, in the afternoon, in the evening, at night\n  B: {\n    priority: 80,\n    parse: function (string, token, match, _options) {\n      switch (token) {\n        case 'B':\n        case 'BB':\n        case 'BBB':\n          return match.dayPeriod(string, {\n            width: 'abbreviated',\n            context: 'formatting'\n          }) || match.dayPeriod(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n\n        case 'BBBBB':\n          return match.dayPeriod(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n\n        case 'BBBB':\n        default:\n          return match.dayPeriod(string, {\n            width: 'wide',\n            context: 'formatting'\n          }) || match.dayPeriod(string, {\n            width: 'abbreviated',\n            context: 'formatting'\n          }) || match.dayPeriod(string, {\n            width: 'narrow',\n            context: 'formatting'\n          });\n      }\n    },\n    set: function (date, _flags, value, _options) {\n      date.setUTCHours(dayPeriodEnumToHours(value), 0, 0, 0);\n      return date;\n    },\n    incompatibleTokens: ['a', 'b', 't', 'T']\n  },\n  // Hour [1-12]\n  h: {\n    priority: 70,\n    parse: function (string, token, match, _options) {\n      switch (token) {\n        case 'h':\n          return parseNumericPattern(numericPatterns.hour12h, string);\n\n        case 'ho':\n          return match.ordinalNumber(string, {\n            unit: 'hour'\n          });\n\n        default:\n          return parseNDigits(token.length, string);\n      }\n    },\n    validate: function (_date, value, _options) {\n      return value >= 1 && value <= 12;\n    },\n    set: function (date, _flags, value, _options) {\n      var isPM = date.getUTCHours() >= 12;\n\n      if (isPM && value < 12) {\n        date.setUTCHours(value + 12, 0, 0, 0);\n      } else if (!isPM && value === 12) {\n        date.setUTCHours(0, 0, 0, 0);\n      } else {\n        date.setUTCHours(value, 0, 0, 0);\n      }\n\n      return date;\n    },\n    incompatibleTokens: ['H', 'K', 'k', 't', 'T']\n  },\n  // Hour [0-23]\n  H: {\n    priority: 70,\n    parse: function (string, token, match, _options) {\n      switch (token) {\n        case 'H':\n          return parseNumericPattern(numericPatterns.hour23h, string);\n\n        case 'Ho':\n          return match.ordinalNumber(string, {\n            unit: 'hour'\n          });\n\n        default:\n          return parseNDigits(token.length, string);\n      }\n    },\n    validate: function (_date, value, _options) {\n      return value >= 0 && value <= 23;\n    },\n    set: function (date, _flags, value, _options) {\n      date.setUTCHours(value, 0, 0, 0);\n      return date;\n    },\n    incompatibleTokens: ['a', 'b', 'h', 'K', 'k', 't', 'T']\n  },\n  // Hour [0-11]\n  K: {\n    priority: 70,\n    parse: function (string, token, match, _options) {\n      switch (token) {\n        case 'K':\n          return parseNumericPattern(numericPatterns.hour11h, string);\n\n        case 'Ko':\n          return match.ordinalNumber(string, {\n            unit: 'hour'\n          });\n\n        default:\n          return parseNDigits(token.length, string);\n      }\n    },\n    validate: function (_date, value, _options) {\n      return value >= 0 && value <= 11;\n    },\n    set: function (date, _flags, value, _options) {\n      var isPM = date.getUTCHours() >= 12;\n\n      if (isPM && value < 12) {\n        date.setUTCHours(value + 12, 0, 0, 0);\n      } else {\n        date.setUTCHours(value, 0, 0, 0);\n      }\n\n      return date;\n    },\n    incompatibleTokens: ['a', 'b', 'h', 'H', 'k', 't', 'T']\n  },\n  // Hour [1-24]\n  k: {\n    priority: 70,\n    parse: function (string, token, match, _options) {\n      switch (token) {\n        case 'k':\n          return parseNumericPattern(numericPatterns.hour24h, string);\n\n        case 'ko':\n          return match.ordinalNumber(string, {\n            unit: 'hour'\n          });\n\n        default:\n          return parseNDigits(token.length, string);\n      }\n    },\n    validate: function (_date, value, _options) {\n      return value >= 1 && value <= 24;\n    },\n    set: function (date, _flags, value, _options) {\n      var hours = value <= 24 ? value % 24 : value;\n      date.setUTCHours(hours, 0, 0, 0);\n      return date;\n    },\n    incompatibleTokens: ['a', 'b', 'h', 'H', 'K', 't', 'T']\n  },\n  // Minute\n  m: {\n    priority: 60,\n    parse: function (string, token, match, _options) {\n      switch (token) {\n        case 'm':\n          return parseNumericPattern(numericPatterns.minute, string);\n\n        case 'mo':\n          return match.ordinalNumber(string, {\n            unit: 'minute'\n          });\n\n        default:\n          return parseNDigits(token.length, string);\n      }\n    },\n    validate: function (_date, value, _options) {\n      return value >= 0 && value <= 59;\n    },\n    set: function (date, _flags, value, _options) {\n      date.setUTCMinutes(value, 0, 0);\n      return date;\n    },\n    incompatibleTokens: ['t', 'T']\n  },\n  // Second\n  s: {\n    priority: 50,\n    parse: function (string, token, match, _options) {\n      switch (token) {\n        case 's':\n          return parseNumericPattern(numericPatterns.second, string);\n\n        case 'so':\n          return match.ordinalNumber(string, {\n            unit: 'second'\n          });\n\n        default:\n          return parseNDigits(token.length, string);\n      }\n    },\n    validate: function (_date, value, _options) {\n      return value >= 0 && value <= 59;\n    },\n    set: function (date, _flags, value, _options) {\n      date.setUTCSeconds(value, 0);\n      return date;\n    },\n    incompatibleTokens: ['t', 'T']\n  },\n  // Fraction of second\n  S: {\n    priority: 30,\n    parse: function (string, token, _match, _options) {\n      var valueCallback = function (value) {\n        return Math.floor(value * Math.pow(10, -token.length + 3));\n      };\n\n      return parseNDigits(token.length, string, valueCallback);\n    },\n    set: function (date, _flags, value, _options) {\n      date.setUTCMilliseconds(value);\n      return date;\n    },\n    incompatibleTokens: ['t', 'T']\n  },\n  // Timezone (ISO-8601. +00:00 is `'Z'`)\n  X: {\n    priority: 10,\n    parse: function (string, token, _match, _options) {\n      switch (token) {\n        case 'X':\n          return parseTimezonePattern(timezonePatterns.basicOptionalMinutes, string);\n\n        case 'XX':\n          return parseTimezonePattern(timezonePatterns.basic, string);\n\n        case 'XXXX':\n          return parseTimezonePattern(timezonePatterns.basicOptionalSeconds, string);\n\n        case 'XXXXX':\n          return parseTimezonePattern(timezonePatterns.extendedOptionalSeconds, string);\n\n        case 'XXX':\n        default:\n          return parseTimezonePattern(timezonePatterns.extended, string);\n      }\n    },\n    set: function (date, flags, value, _options) {\n      if (flags.timestampIsSet) {\n        return date;\n      }\n\n      return new Date(date.getTime() - value);\n    },\n    incompatibleTokens: ['t', 'T', 'x']\n  },\n  // Timezone (ISO-8601)\n  x: {\n    priority: 10,\n    parse: function (string, token, _match, _options) {\n      switch (token) {\n        case 'x':\n          return parseTimezonePattern(timezonePatterns.basicOptionalMinutes, string);\n\n        case 'xx':\n          return parseTimezonePattern(timezonePatterns.basic, string);\n\n        case 'xxxx':\n          return parseTimezonePattern(timezonePatterns.basicOptionalSeconds, string);\n\n        case 'xxxxx':\n          return parseTimezonePattern(timezonePatterns.extendedOptionalSeconds, string);\n\n        case 'xxx':\n        default:\n          return parseTimezonePattern(timezonePatterns.extended, string);\n      }\n    },\n    set: function (date, flags, value, _options) {\n      if (flags.timestampIsSet) {\n        return date;\n      }\n\n      return new Date(date.getTime() - value);\n    },\n    incompatibleTokens: ['t', 'T', 'X']\n  },\n  // Seconds timestamp\n  t: {\n    priority: 40,\n    parse: function (string, _token, _match, _options) {\n      return parseAnyDigitsSigned(string);\n    },\n    set: function (_date, _flags, value, _options) {\n      return [new Date(value * 1000), {\n        timestampIsSet: true\n      }];\n    },\n    incompatibleTokens: '*'\n  },\n  // Milliseconds timestamp\n  T: {\n    priority: 20,\n    parse: function (string, _token, _match, _options) {\n      return parseAnyDigitsSigned(string);\n    },\n    set: function (_date, _flags, value, _options) {\n      return [new Date(value), {\n        timestampIsSet: true\n      }];\n    },\n    incompatibleTokens: '*'\n  }\n};\nexport default parsers;","import toInteger from '../toInteger/index.js';\nimport toDate from '../../toDate/index.js';\nimport getUTCWeek from '../getUTCWeek/index.js'; // This function will be a part of public API when UTC function will be implemented.\n// See issue: https://github.com/date-fns/date-fns/issues/376\n\nexport default function setUTCWeek(dirtyDate, dirtyWeek, options) {\n  if (arguments.length < 2) {\n    throw new TypeError('2 arguments required, but only ' + arguments.length + ' present');\n  }\n\n  var date = toDate(dirtyDate);\n  var week = toInteger(dirtyWeek);\n  var diff = getUTCWeek(date, options) - week;\n  date.setUTCDate(date.getUTCDate() - diff * 7);\n  return date;\n}","import toInteger from '../toInteger/index.js';\nimport toDate from '../../toDate/index.js';\nimport getUTCISOWeek from '../getUTCISOWeek/index.js'; // This function will be a part of public API when UTC function will be implemented.\n// See issue: https://github.com/date-fns/date-fns/issues/376\n\nexport default function setUTCISOWeek(dirtyDate, dirtyISOWeek) {\n  if (arguments.length < 2) {\n    throw new TypeError('2 arguments required, but only ' + arguments.length + ' present');\n  }\n\n  var date = toDate(dirtyDate);\n  var isoWeek = toInteger(dirtyISOWeek);\n  var diff = getUTCISOWeek(date) - isoWeek;\n  date.setUTCDate(date.getUTCDate() - diff * 7);\n  return date;\n}","import toInteger from '../toInteger/index.js';\nimport toDate from '../../toDate/index.js'; // This function will be a part of public API when UTC function will be implemented.\n// See issue: https://github.com/date-fns/date-fns/issues/376\n\nexport default function setUTCISODay(dirtyDate, dirtyDay) {\n  if (arguments.length < 2) {\n    throw new TypeError('2 arguments required, but only ' + arguments.length + ' present');\n  }\n\n  var day = toInteger(dirtyDay);\n\n  if (day % 7 === 0) {\n    day = day - 7;\n  }\n\n  var weekStartsOn = 1;\n  var date = toDate(dirtyDate);\n  var currentDay = date.getUTCDay();\n  var remainder = day % 7;\n  var dayIndex = (remainder + 7) % 7;\n  var diff = (dayIndex < weekStartsOn ? 7 : 0) + day - currentDay;\n  date.setUTCDate(date.getUTCDate() + diff);\n  return date;\n}","import defaultLocale from '../locale/en-US/index.js';\nimport subMilliseconds from '../subMilliseconds/index.js';\nimport toDate from '../toDate/index.js';\nimport assign from '../_lib/assign/index.js';\nimport longFormatters from '../_lib/format/longFormatters/index.js';\nimport getTimezoneOffsetInMilliseconds from '../_lib/getTimezoneOffsetInMilliseconds/index.js';\nimport { isProtectedDayOfYearToken, isProtectedWeekYearToken, throwProtectedError } from '../_lib/protectedTokens/index.js';\nimport toInteger from '../_lib/toInteger/index.js';\nimport parsers from './_lib/parsers/index.js';\nvar TIMEZONE_UNIT_PRIORITY = 10; // This RegExp consists of three parts separated by `|`:\n// - [yYQqMLwIdDecihHKkms]o matches any available ordinal number token\n//   (one of the certain letters followed by `o`)\n// - (\\w)\\1* matches any sequences of the same letter\n// - '' matches two quote characters in a row\n// - '(''|[^'])+('|$) matches anything surrounded by two quote characters ('),\n//   except a single quote symbol, which ends the sequence.\n//   Two quote characters do not end the sequence.\n//   If there is no matching single quote\n//   then the sequence will continue until the end of the string.\n// - . matches any single character unmatched by previous parts of the RegExps\n\nvar formattingTokensRegExp = /[yYQqMLwIdDecihHKkms]o|(\\w)\\1*|''|'(''|[^'])+('|$)|./g; // This RegExp catches symbols escaped by quotes, and also\n// sequences of symbols P, p, and the combinations like `PPPPPPPppppp`\n\nvar longFormattingTokensRegExp = /P+p+|P+|p+|''|'(''|[^'])+('|$)|./g;\nvar escapedStringRegExp = /^'([^]*?)'?$/;\nvar doubleQuoteRegExp = /''/g;\nvar notWhitespaceRegExp = /\\S/;\nvar unescapedLatinCharacterRegExp = /[a-zA-Z]/;\n/**\n * @name parse\n * @category Common Helpers\n * @summary Parse the date.\n *\n * @description\n * Return the date parsed from string using the given format string.\n *\n * > ⚠️ Please note that the `format` tokens differ from Moment.js and other libraries.\n * > See: https://git.io/fxCyr\n *\n * The characters in the format string wrapped between two single quotes characters (') are escaped.\n * Two single quotes in a row, whether inside or outside a quoted sequence, represent a 'real' single quote.\n *\n * Format of the format string is based on Unicode Technical Standard #35:\n * https://www.unicode.org/reports/tr35/tr35-dates.html#Date_Field_Symbol_Table\n * with a few additions (see note 5 below the table).\n *\n * Not all tokens are compatible. Combinations that don't make sense or could lead to bugs are prohibited\n * and will throw `RangeError`. For example usage of 24-hour format token with AM/PM token will throw an exception:\n *\n * ```javascript\n * parse('23 AM', 'HH a', new Date())\n * //=> RangeError: The format string mustn't contain `HH` and `a` at the same time\n * ```\n *\n * See the compatibility table: https://docs.google.com/spreadsheets/d/e/2PACX-1vQOPU3xUhplll6dyoMmVUXHKl_8CRDs6_ueLmex3SoqwhuolkuN3O05l4rqx5h1dKX8eb46Ul-CCSrq/pubhtml?gid=0&single=true\n *\n * Accepted format string patterns:\n * | Unit                            |Prior| Pattern | Result examples                   | Notes |\n * |---------------------------------|-----|---------|-----------------------------------|-------|\n * | Era                             | 140 | G..GGG  | AD, BC                            |       |\n * |                                 |     | GGGG    | Anno Domini, Before Christ        | 2     |\n * |                                 |     | GGGGG   | A, B                              |       |\n * | Calendar year                   | 130 | y       | 44, 1, 1900, 2017, 9999           | 4     |\n * |                                 |     | yo      | 44th, 1st, 1900th, 9999999th      | 4,5   |\n * |                                 |     | yy      | 44, 01, 00, 17                    | 4     |\n * |                                 |     | yyy     | 044, 001, 123, 999                | 4     |\n * |                                 |     | yyyy    | 0044, 0001, 1900, 2017            | 4     |\n * |                                 |     | yyyyy   | ...                               | 2,4   |\n * | Local week-numbering year       | 130 | Y       | 44, 1, 1900, 2017, 9000           | 4     |\n * |                                 |     | Yo      | 44th, 1st, 1900th, 9999999th      | 4,5   |\n * |                                 |     | YY      | 44, 01, 00, 17                    | 4,6   |\n * |                                 |     | YYY     | 044, 001, 123, 999                | 4     |\n * |                                 |     | YYYY    | 0044, 0001, 1900, 2017            | 4,6   |\n * |                                 |     | YYYYY   | ...                               | 2,4   |\n * | ISO week-numbering year         | 130 | R       | -43, 1, 1900, 2017, 9999, -9999   | 4,5   |\n * |                                 |     | RR      | -43, 01, 00, 17                   | 4,5   |\n * |                                 |     | RRR     | -043, 001, 123, 999, -999         | 4,5   |\n * |                                 |     | RRRR    | -0043, 0001, 2017, 9999, -9999    | 4,5   |\n * |                                 |     | RRRRR   | ...                               | 2,4,5 |\n * | Extended year                   | 130 | u       | -43, 1, 1900, 2017, 9999, -999    | 4     |\n * |                                 |     | uu      | -43, 01, 99, -99                  | 4     |\n * |                                 |     | uuu     | -043, 001, 123, 999, -999         | 4     |\n * |                                 |     | uuuu    | -0043, 0001, 2017, 9999, -9999    | 4     |\n * |                                 |     | uuuuu   | ...                               | 2,4   |\n * | Quarter (formatting)            | 120 | Q       | 1, 2, 3, 4                        |       |\n * |                                 |     | Qo      | 1st, 2nd, 3rd, 4th                | 5     |\n * |                                 |     | QQ      | 01, 02, 03, 04                    |       |\n * |                                 |     | QQQ     | Q1, Q2, Q3, Q4                    |       |\n * |                                 |     | QQQQ    | 1st quarter, 2nd quarter, ...     | 2     |\n * |                                 |     | QQQQQ   | 1, 2, 3, 4                        | 4     |\n * | Quarter (stand-alone)           | 120 | q       | 1, 2, 3, 4                        |       |\n * |                                 |     | qo      | 1st, 2nd, 3rd, 4th                | 5     |\n * |                                 |     | qq      | 01, 02, 03, 04                    |       |\n * |                                 |     | qqq     | Q1, Q2, Q3, Q4                    |       |\n * |                                 |     | qqqq    | 1st quarter, 2nd quarter, ...     | 2     |\n * |                                 |     | qqqqq   | 1, 2, 3, 4                        | 3     |\n * | Month (formatting)              | 110 | M       | 1, 2, ..., 12                     |       |\n * |                                 |     | Mo      | 1st, 2nd, ..., 12th               | 5     |\n * |                                 |     | MM      | 01, 02, ..., 12                   |       |\n * |                                 |     | MMM     | Jan, Feb, ..., Dec                |       |\n * |                                 |     | MMMM    | January, February, ..., December  | 2     |\n * |                                 |     | MMMMM   | J, F, ..., D                      |       |\n * | Month (stand-alone)             | 110 | L       | 1, 2, ..., 12                     |       |\n * |                                 |     | Lo      | 1st, 2nd, ..., 12th               | 5     |\n * |                                 |     | LL      | 01, 02, ..., 12                   |       |\n * |                                 |     | LLL     | Jan, Feb, ..., Dec                |       |\n * |                                 |     | LLLL    | January, February, ..., December  | 2     |\n * |                                 |     | LLLLL   | J, F, ..., D                      |       |\n * | Local week of year              | 100 | w       | 1, 2, ..., 53                     |       |\n * |                                 |     | wo      | 1st, 2nd, ..., 53th               | 5     |\n * |                                 |     | ww      | 01, 02, ..., 53                   |       |\n * | ISO week of year                | 100 | I       | 1, 2, ..., 53                     | 5     |\n * |                                 |     | Io      | 1st, 2nd, ..., 53th               | 5     |\n * |                                 |     | II      | 01, 02, ..., 53                   | 5     |\n * | Day of month                    |  90 | d       | 1, 2, ..., 31                     |       |\n * |                                 |     | do      | 1st, 2nd, ..., 31st               | 5     |\n * |                                 |     | dd      | 01, 02, ..., 31                   |       |\n * | Day of year                     |  90 | D       | 1, 2, ..., 365, 366               | 7     |\n * |                                 |     | Do      | 1st, 2nd, ..., 365th, 366th       | 5     |\n * |                                 |     | DD      | 01, 02, ..., 365, 366             | 7     |\n * |                                 |     | DDD     | 001, 002, ..., 365, 366           |       |\n * |                                 |     | DDDD    | ...                               | 2     |\n * | Day of week (formatting)        |  90 | E..EEE  | Mon, Tue, Wed, ..., Su            |       |\n * |                                 |     | EEEE    | Monday, Tuesday, ..., Sunday      | 2     |\n * |                                 |     | EEEEE   | M, T, W, T, F, S, S               |       |\n * |                                 |     | EEEEEE  | Mo, Tu, We, Th, Fr, Su, Sa        |       |\n * | ISO day of week (formatting)    |  90 | i       | 1, 2, 3, ..., 7                   | 5     |\n * |                                 |     | io      | 1st, 2nd, ..., 7th                | 5     |\n * |                                 |     | ii      | 01, 02, ..., 07                   | 5     |\n * |                                 |     | iii     | Mon, Tue, Wed, ..., Su            | 5     |\n * |                                 |     | iiii    | Monday, Tuesday, ..., Sunday      | 2,5   |\n * |                                 |     | iiiii   | M, T, W, T, F, S, S               | 5     |\n * |                                 |     | iiiiii  | Mo, Tu, We, Th, Fr, Su, Sa        | 5     |\n * | Local day of week (formatting)  |  90 | e       | 2, 3, 4, ..., 1                   |       |\n * |                                 |     | eo      | 2nd, 3rd, ..., 1st                | 5     |\n * |                                 |     | ee      | 02, 03, ..., 01                   |       |\n * |                                 |     | eee     | Mon, Tue, Wed, ..., Su            |       |\n * |                                 |     | eeee    | Monday, Tuesday, ..., Sunday      | 2     |\n * |                                 |     | eeeee   | M, T, W, T, F, S, S               |       |\n * |                                 |     | eeeeee  | Mo, Tu, We, Th, Fr, Su, Sa        |       |\n * | Local day of week (stand-alone) |  90 | c       | 2, 3, 4, ..., 1                   |       |\n * |                                 |     | co      | 2nd, 3rd, ..., 1st                | 5     |\n * |                                 |     | cc      | 02, 03, ..., 01                   |       |\n * |                                 |     | ccc     | Mon, Tue, Wed, ..., Su            |       |\n * |                                 |     | cccc    | Monday, Tuesday, ..., Sunday      | 2     |\n * |                                 |     | ccccc   | M, T, W, T, F, S, S               |       |\n * |                                 |     | cccccc  | Mo, Tu, We, Th, Fr, Su, Sa        |       |\n * | AM, PM                          |  80 | a..aaa  | AM, PM                            |       |\n * |                                 |     | aaaa    | a.m., p.m.                        | 2     |\n * |                                 |     | aaaaa   | a, p                              |       |\n * | AM, PM, noon, midnight          |  80 | b..bbb  | AM, PM, noon, midnight            |       |\n * |                                 |     | bbbb    | a.m., p.m., noon, midnight        | 2     |\n * |                                 |     | bbbbb   | a, p, n, mi                       |       |\n * | Flexible day period             |  80 | B..BBB  | at night, in the morning, ...     |       |\n * |                                 |     | BBBB    | at night, in the morning, ...     | 2     |\n * |                                 |     | BBBBB   | at night, in the morning, ...     |       |\n * | Hour [1-12]                     |  70 | h       | 1, 2, ..., 11, 12                 |       |\n * |                                 |     | ho      | 1st, 2nd, ..., 11th, 12th         | 5     |\n * |                                 |     | hh      | 01, 02, ..., 11, 12               |       |\n * | Hour [0-23]                     |  70 | H       | 0, 1, 2, ..., 23                  |       |\n * |                                 |     | Ho      | 0th, 1st, 2nd, ..., 23rd          | 5     |\n * |                                 |     | HH      | 00, 01, 02, ..., 23               |       |\n * | Hour [0-11]                     |  70 | K       | 1, 2, ..., 11, 0                  |       |\n * |                                 |     | Ko      | 1st, 2nd, ..., 11th, 0th          | 5     |\n * |                                 |     | KK      | 1, 2, ..., 11, 0                  |       |\n * | Hour [1-24]                     |  70 | k       | 24, 1, 2, ..., 23                 |       |\n * |                                 |     | ko      | 24th, 1st, 2nd, ..., 23rd         | 5     |\n * |                                 |     | kk      | 24, 01, 02, ..., 23               |       |\n * | Minute                          |  60 | m       | 0, 1, ..., 59                     |       |\n * |                                 |     | mo      | 0th, 1st, ..., 59th               | 5     |\n * |                                 |     | mm      | 00, 01, ..., 59                   |       |\n * | Second                          |  50 | s       | 0, 1, ..., 59                     |       |\n * |                                 |     | so      | 0th, 1st, ..., 59th               | 5     |\n * |                                 |     | ss      | 00, 01, ..., 59                   |       |\n * | Seconds timestamp               |  40 | t       | 512969520                         |       |\n * |                                 |     | tt      | ...                               | 2     |\n * | Fraction of second              |  30 | S       | 0, 1, ..., 9                      |       |\n * |                                 |     | SS      | 00, 01, ..., 99                   |       |\n * |                                 |     | SSS     | 000, 0001, ..., 999               |       |\n * |                                 |     | SSSS    | ...                               | 2     |\n * | Milliseconds timestamp          |  20 | T       | 512969520900                      |       |\n * |                                 |     | TT      | ...                               | 2     |\n * | Timezone (ISO-8601 w/ Z)        |  10 | X       | -08, +0530, Z                     |       |\n * |                                 |     | XX      | -0800, +0530, Z                   |       |\n * |                                 |     | XXX     | -08:00, +05:30, Z                 |       |\n * |                                 |     | XXXX    | -0800, +0530, Z, +123456          | 2     |\n * |                                 |     | XXXXX   | -08:00, +05:30, Z, +12:34:56      |       |\n * | Timezone (ISO-8601 w/o Z)       |  10 | x       | -08, +0530, +00                   |       |\n * |                                 |     | xx      | -0800, +0530, +0000               |       |\n * |                                 |     | xxx     | -08:00, +05:30, +00:00            | 2     |\n * |                                 |     | xxxx    | -0800, +0530, +0000, +123456      |       |\n * |                                 |     | xxxxx   | -08:00, +05:30, +00:00, +12:34:56 |       |\n * | Long localized date             |  NA | P       | 05/29/1453                        | 5,8   |\n * |                                 |     | PP      | May 29, 1453                      |       |\n * |                                 |     | PPP     | May 29th, 1453                    |       |\n * |                                 |     | PPPP    | Sunday, May 29th, 1453            | 2,5,8 |\n * | Long localized time             |  NA | p       | 12:00 AM                          | 5,8   |\n * |                                 |     | pp      | 12:00:00 AM                       |       |\n * | Combination of date and time    |  NA | Pp      | 05/29/1453, 12:00 AM              |       |\n * |                                 |     | PPpp    | May 29, 1453, 12:00:00 AM         |       |\n * |                                 |     | PPPpp   | May 29th, 1453 at ...             |       |\n * |                                 |     | PPPPpp  | Sunday, May 29th, 1453 at ...     | 2,5,8 |\n * Notes:\n * 1. \"Formatting\" units (e.g. formatting quarter) in the default en-US locale\n *    are the same as \"stand-alone\" units, but are different in some languages.\n *    \"Formatting\" units are declined according to the rules of the language\n *    in the context of a date. \"Stand-alone\" units are always nominative singular.\n *    In `format` function, they will produce different result:\n *\n *    `format(new Date(2017, 10, 6), 'do LLLL', {locale: cs}) //=> '6. listopad'`\n *\n *    `format(new Date(2017, 10, 6), 'do MMMM', {locale: cs}) //=> '6. listopadu'`\n *\n *    `parse` will try to match both formatting and stand-alone units interchangably.\n *\n * 2. Any sequence of the identical letters is a pattern, unless it is escaped by\n *    the single quote characters (see below).\n *    If the sequence is longer than listed in table:\n *    - for numerical units (`yyyyyyyy`) `parse` will try to match a number\n *      as wide as the sequence\n *    - for text units (`MMMMMMMM`) `parse` will try to match the widest variation of the unit.\n *      These variations are marked with \"2\" in the last column of the table.\n *\n * 3. `QQQQQ` and `qqqqq` could be not strictly numerical in some locales.\n *    These tokens represent the shortest form of the quarter.\n *\n * 4. The main difference between `y` and `u` patterns are B.C. years:\n *\n *    | Year | `y` | `u` |\n *    |------|-----|-----|\n *    | AC 1 |   1 |   1 |\n *    | BC 1 |   1 |   0 |\n *    | BC 2 |   2 |  -1 |\n *\n *    Also `yy` will try to guess the century of two digit year by proximity with `backupDate`:\n *\n *    `parse('50', 'yy', new Date(2018, 0, 1)) //=> Sat Jan 01 2050 00:00:00`\n *\n *    `parse('75', 'yy', new Date(2018, 0, 1)) //=> Wed Jan 01 1975 00:00:00`\n *\n *    while `uu` will just assign the year as is:\n *\n *    `parse('50', 'uu', new Date(2018, 0, 1)) //=> Sat Jan 01 0050 00:00:00`\n *\n *    `parse('75', 'uu', new Date(2018, 0, 1)) //=> Tue Jan 01 0075 00:00:00`\n *\n *    The same difference is true for local and ISO week-numbering years (`Y` and `R`),\n *    except local week-numbering years are dependent on `options.weekStartsOn`\n *    and `options.firstWeekContainsDate` (compare [setISOWeekYear]{@link https://date-fns.org/docs/setISOWeekYear}\n *    and [setWeekYear]{@link https://date-fns.org/docs/setWeekYear}).\n *\n * 5. These patterns are not in the Unicode Technical Standard #35:\n *    - `i`: ISO day of week\n *    - `I`: ISO week of year\n *    - `R`: ISO week-numbering year\n *    - `o`: ordinal number modifier\n *    - `P`: long localized date\n *    - `p`: long localized time\n *\n * 6. `YY` and `YYYY` tokens represent week-numbering years but they are often confused with years.\n *    You should enable `options.useAdditionalWeekYearTokens` to use them. See: https://git.io/fxCyr\n *\n * 7. `D` and `DD` tokens represent days of the year but they are ofthen confused with days of the month.\n *    You should enable `options.useAdditionalDayOfYearTokens` to use them. See: https://git.io/fxCyr\n *\n * 8. `P+` tokens do not have a defined priority since they are merely aliases to other tokens based\n *    on the given locale.\n *\n *    using `en-US` locale: `P` => `MM/dd/yyyy`\n *    using `en-US` locale: `p` => `hh:mm a`\n *    using `pt-BR` locale: `P` => `dd/MM/yyyy`\n *    using `pt-BR` locale: `p` => `HH:mm`\n *\n * Values will be assigned to the date in the descending order of its unit's priority.\n * Units of an equal priority overwrite each other in the order of appearance.\n *\n * If no values of higher priority are parsed (e.g. when parsing string 'January 1st' without a year),\n * the values will be taken from 3rd argument `backupDate` which works as a context of parsing.\n *\n * `backupDate` must be passed for correct work of the function.\n * If you're not sure which `backupDate` to supply, create a new instance of Date:\n * `parse('02/11/2014', 'MM/dd/yyyy', new Date())`\n * In this case parsing will be done in the context of the current date.\n * If `backupDate` is `Invalid Date` or a value not convertible to valid `Date`,\n * then `Invalid Date` will be returned.\n *\n * The result may vary by locale.\n *\n * If `formatString` matches with `dateString` but does not provides tokens, `backupDate` will be returned.\n *\n * If parsing failed, `Invalid Date` will be returned.\n * Invalid Date is a Date, whose time value is NaN.\n * Time value of Date: http://es5.github.io/#x15.9.1.1\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * - Old `parse` was renamed to `toDate`.\n *   Now `parse` is a new function which parses a string using a provided format.\n *\n *   ```javascript\n *   // Before v2.0.0\n *   parse('2016-01-01')\n *\n *   // v2.0.0 onward\n *   toDate('2016-01-01')\n *   parse('2016-01-01', 'yyyy-MM-dd', new Date())\n *   ```\n *\n * @param {String} dateString - the string to parse\n * @param {String} formatString - the string of tokens\n * @param {Date|Number} backupDate - defines values missing from the parsed dateString\n * @param {Object} [options] - an object with options.\n * @param {Locale} [options.locale=defaultLocale] - the locale object. See [Locale]{@link https://date-fns.org/docs/Locale}\n * @param {0|1|2|3|4|5|6} [options.weekStartsOn=0] - the index of the first day of the week (0 - Sunday)\n * @param {1|2|3|4|5|6|7} [options.firstWeekContainsDate=1] - the day of January, which is always in the first week of the year\n * @param {Boolean} [options.useAdditionalWeekYearTokens=false] - if true, allows usage of the week-numbering year tokens `YY` and `YYYY`;\n *   see: https://git.io/fxCyr\n * @param {Boolean} [options.useAdditionalDayOfYearTokens=false] - if true, allows usage of the day of year tokens `D` and `DD`;\n *   see: https://git.io/fxCyr\n * @returns {Date} the parsed date\n * @throws {TypeError} 3 arguments required\n * @throws {RangeError} `options.weekStartsOn` must be between 0 and 6\n * @throws {RangeError} `options.firstWeekContainsDate` must be between 1 and 7\n * @throws {RangeError} `options.locale` must contain `match` property\n * @throws {RangeError} use `yyyy` instead of `YYYY` for formatting years; see: https://git.io/fxCyr\n * @throws {RangeError} use `yy` instead of `YY` for formatting years; see: https://git.io/fxCyr\n * @throws {RangeError} use `d` instead of `D` for formatting days of the month; see: https://git.io/fxCyr\n * @throws {RangeError} use `dd` instead of `DD` for formatting days of the month; see: https://git.io/fxCyr\n * @throws {RangeError} format string contains an unescaped latin alphabet character\n *\n * @example\n * // Parse 11 February 2014 from middle-endian format:\n * var result = parse('02/11/2014', 'MM/dd/yyyy', new Date())\n * //=> Tue Feb 11 2014 00:00:00\n *\n * @example\n * // Parse 28th of February in Esperanto locale in the context of 2010 year:\n * import eo from 'date-fns/locale/eo'\n * var result = parse('28-a de februaro', \"do 'de' MMMM\", new Date(2010, 0, 1), {\n *   locale: eo\n * })\n * //=> Sun Feb 28 2010 00:00:00\n */\n\nexport default function parse(dirtyDateString, dirtyFormatString, dirtyBackupDate, dirtyOptions) {\n  if (arguments.length < 3) {\n    throw new TypeError('3 arguments required, but only ' + arguments.length + ' present');\n  }\n\n  var dateString = String(dirtyDateString);\n  var formatString = String(dirtyFormatString);\n  var options = dirtyOptions || {};\n  var locale = options.locale || defaultLocale;\n\n  if (!locale.match) {\n    throw new RangeError('locale must contain match property');\n  }\n\n  var localeFirstWeekContainsDate = locale.options && locale.options.firstWeekContainsDate;\n  var defaultFirstWeekContainsDate = localeFirstWeekContainsDate == null ? 1 : toInteger(localeFirstWeekContainsDate);\n  var firstWeekContainsDate = options.firstWeekContainsDate == null ? defaultFirstWeekContainsDate : toInteger(options.firstWeekContainsDate); // Test if weekStartsOn is between 1 and 7 _and_ is not NaN\n\n  if (!(firstWeekContainsDate >= 1 && firstWeekContainsDate <= 7)) {\n    throw new RangeError('firstWeekContainsDate must be between 1 and 7 inclusively');\n  }\n\n  var localeWeekStartsOn = locale.options && locale.options.weekStartsOn;\n  var defaultWeekStartsOn = localeWeekStartsOn == null ? 0 : toInteger(localeWeekStartsOn);\n  var weekStartsOn = options.weekStartsOn == null ? defaultWeekStartsOn : toInteger(options.weekStartsOn); // Test if weekStartsOn is between 0 and 6 _and_ is not NaN\n\n  if (!(weekStartsOn >= 0 && weekStartsOn <= 6)) {\n    throw new RangeError('weekStartsOn must be between 0 and 6 inclusively');\n  }\n\n  if (formatString === '') {\n    if (dateString === '') {\n      return toDate(dirtyBackupDate);\n    } else {\n      return new Date(NaN);\n    }\n  }\n\n  var subFnOptions = {\n    firstWeekContainsDate: firstWeekContainsDate,\n    weekStartsOn: weekStartsOn,\n    locale: locale // If timezone isn't specified, it will be set to the system timezone\n\n  };\n  var setters = [{\n    priority: TIMEZONE_UNIT_PRIORITY,\n    set: dateToSystemTimezone,\n    index: 0\n  }];\n  var i;\n  var tokens = formatString.match(longFormattingTokensRegExp).map(function (substring) {\n    var firstCharacter = substring[0];\n\n    if (firstCharacter === 'p' || firstCharacter === 'P') {\n      var longFormatter = longFormatters[firstCharacter];\n      return longFormatter(substring, locale.formatLong, subFnOptions);\n    }\n\n    return substring;\n  }).join('').match(formattingTokensRegExp);\n  var usedTokens = [];\n\n  for (i = 0; i < tokens.length; i++) {\n    var token = tokens[i];\n\n    if (!options.useAdditionalWeekYearTokens && isProtectedWeekYearToken(token)) {\n      throwProtectedError(token);\n    }\n\n    if (!options.useAdditionalDayOfYearTokens && isProtectedDayOfYearToken(token)) {\n      throwProtectedError(token);\n    }\n\n    var firstCharacter = token[0];\n    var parser = parsers[firstCharacter];\n\n    if (parser) {\n      var incompatibleTokens = parser.incompatibleTokens;\n\n      if (Array.isArray(incompatibleTokens)) {\n        var incompatibleToken = void 0;\n\n        for (var _i = 0; _i < usedTokens.length; _i++) {\n          var usedToken = usedTokens[_i].token;\n\n          if (incompatibleTokens.indexOf(usedToken) !== -1 || usedToken === firstCharacter) {\n            incompatibleToken = usedTokens[_i];\n            break;\n          }\n        }\n\n        if (incompatibleToken) {\n          throw new RangeError(\"The format string mustn't contain `\".concat(incompatibleToken.fullToken, \"` and `\").concat(token, \"` at the same time\"));\n        }\n      } else if (parser.incompatibleTokens === '*' && usedTokens.length) {\n        throw new RangeError(\"The format string mustn't contain `\".concat(token, \"` and any other token at the same time\"));\n      }\n\n      usedTokens.push({\n        token: firstCharacter,\n        fullToken: token\n      });\n      var parseResult = parser.parse(dateString, token, locale.match, subFnOptions);\n\n      if (!parseResult) {\n        return new Date(NaN);\n      }\n\n      setters.push({\n        priority: parser.priority,\n        set: parser.set,\n        validate: parser.validate,\n        value: parseResult.value,\n        index: setters.length\n      });\n      dateString = parseResult.rest;\n    } else {\n      if (firstCharacter.match(unescapedLatinCharacterRegExp)) {\n        throw new RangeError('Format string contains an unescaped latin alphabet character `' + firstCharacter + '`');\n      } // Replace two single quote characters with one single quote character\n\n\n      if (token === \"''\") {\n        token = \"'\";\n      } else if (firstCharacter === \"'\") {\n        token = cleanEscapedString(token);\n      } // Cut token from string, or, if string doesn't match the token, return Invalid Date\n\n\n      if (dateString.indexOf(token) === 0) {\n        dateString = dateString.slice(token.length);\n      } else {\n        return new Date(NaN);\n      }\n    }\n  } // Check if the remaining input contains something other than whitespace\n\n\n  if (dateString.length > 0 && notWhitespaceRegExp.test(dateString)) {\n    return new Date(NaN);\n  }\n\n  var uniquePrioritySetters = setters.map(function (setter) {\n    return setter.priority;\n  }).sort(function (a, b) {\n    return b - a;\n  }).filter(function (priority, index, array) {\n    return array.indexOf(priority) === index;\n  }).map(function (priority) {\n    return setters.filter(function (setter) {\n      return setter.priority === priority;\n    }).reverse();\n  }).map(function (setterArray) {\n    return setterArray[0];\n  });\n  var date = toDate(dirtyBackupDate);\n\n  if (isNaN(date)) {\n    return new Date(NaN);\n  } // Convert the date in system timezone to the same date in UTC+00:00 timezone.\n  // This ensures that when UTC functions will be implemented, locales will be compatible with them.\n  // See an issue about UTC functions: https://github.com/date-fns/date-fns/issues/37\n\n\n  var utcDate = subMilliseconds(date, getTimezoneOffsetInMilliseconds(date));\n  var flags = {};\n\n  for (i = 0; i < uniquePrioritySetters.length; i++) {\n    var setter = uniquePrioritySetters[i];\n\n    if (setter.validate && !setter.validate(utcDate, setter.value, subFnOptions)) {\n      return new Date(NaN);\n    }\n\n    var result = setter.set(utcDate, flags, setter.value, subFnOptions); // Result is tuple (date, flags)\n\n    if (result[0]) {\n      utcDate = result[0];\n      assign(flags, result[1]); // Result is date\n    } else {\n      utcDate = result;\n    }\n  }\n\n  return utcDate;\n}\n\nfunction dateToSystemTimezone(date, flags) {\n  if (flags.timestampIsSet) {\n    return date;\n  }\n\n  var convertedDate = new Date(0);\n  convertedDate.setFullYear(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate());\n  convertedDate.setHours(date.getUTCHours(), date.getUTCMinutes(), date.getUTCSeconds(), date.getUTCMilliseconds());\n  return convertedDate;\n}\n\nfunction cleanEscapedString(input) {\n  return input.match(escapedStringRegExp)[1].replace(doubleQuoteRegExp, \"'\");\n}","export default function addLeadingZeros(number, targetLength) {\n  var sign = number < 0 ? '-' : '';\n  var output = Math.abs(number).toString();\n\n  while (output.length < targetLength) {\n    output = '0' + output;\n  }\n\n  return sign + output;\n}","import addLeadingZeros from '../../addLeadingZeros/index.js';\n/*\n * |     | Unit                           |     | Unit                           |\n * |-----|--------------------------------|-----|--------------------------------|\n * |  a  | AM, PM                         |  A* |                                |\n * |  d  | Day of month                   |  D  |                                |\n * |  h  | Hour [1-12]                    |  H  | Hour [0-23]                    |\n * |  m  | Minute                         |  M  | Month                          |\n * |  s  | Second                         |  S  | Fraction of second             |\n * |  y  | Year (abs)                     |  Y  |                                |\n *\n * Letters marked by * are not implemented but reserved by Unicode standard.\n */\n\nvar formatters = {\n  // Year\n  y: function (date, token) {\n    // From http://www.unicode.org/reports/tr35/tr35-31/tr35-dates.html#Date_Format_tokens\n    // | Year     |     y | yy |   yyy |  yyyy | yyyyy |\n    // |----------|-------|----|-------|-------|-------|\n    // | AD 1     |     1 | 01 |   001 |  0001 | 00001 |\n    // | AD 12    |    12 | 12 |   012 |  0012 | 00012 |\n    // | AD 123   |   123 | 23 |   123 |  0123 | 00123 |\n    // | AD 1234  |  1234 | 34 |  1234 |  1234 | 01234 |\n    // | AD 12345 | 12345 | 45 | 12345 | 12345 | 12345 |\n    var signedYear = date.getUTCFullYear(); // Returns 1 for 1 BC (which is year 0 in JavaScript)\n\n    var year = signedYear > 0 ? signedYear : 1 - signedYear;\n    return addLeadingZeros(token === 'yy' ? year % 100 : year, token.length);\n  },\n  // Month\n  M: function (date, token) {\n    var month = date.getUTCMonth();\n    return token === 'M' ? String(month + 1) : addLeadingZeros(month + 1, 2);\n  },\n  // Day of the month\n  d: function (date, token) {\n    return addLeadingZeros(date.getUTCDate(), token.length);\n  },\n  // AM or PM\n  a: function (date, token) {\n    var dayPeriodEnumValue = date.getUTCHours() / 12 >= 1 ? 'pm' : 'am';\n\n    switch (token) {\n      case 'a':\n      case 'aa':\n      case 'aaa':\n        return dayPeriodEnumValue.toUpperCase();\n\n      case 'aaaaa':\n        return dayPeriodEnumValue[0];\n\n      case 'aaaa':\n      default:\n        return dayPeriodEnumValue === 'am' ? 'a.m.' : 'p.m.';\n    }\n  },\n  // Hour [1-12]\n  h: function (date, token) {\n    return addLeadingZeros(date.getUTCHours() % 12 || 12, token.length);\n  },\n  // Hour [0-23]\n  H: function (date, token) {\n    return addLeadingZeros(date.getUTCHours(), token.length);\n  },\n  // Minute\n  m: function (date, token) {\n    return addLeadingZeros(date.getUTCMinutes(), token.length);\n  },\n  // Second\n  s: function (date, token) {\n    return addLeadingZeros(date.getUTCSeconds(), token.length);\n  },\n  // Fraction of second\n  S: function (date, token) {\n    var numberOfDigits = token.length;\n    var milliseconds = date.getUTCMilliseconds();\n    var fractionalSeconds = Math.floor(milliseconds * Math.pow(10, numberOfDigits - 3));\n    return addLeadingZeros(fractionalSeconds, token.length);\n  }\n};\nexport default formatters;","import toDate from '../../toDate/index.js';\nvar MILLISECONDS_IN_DAY = 86400000; // This function will be a part of public API when UTC function will be implemented.\n// See issue: https://github.com/date-fns/date-fns/issues/376\n\nexport default function getUTCDayOfYear(dirtyDate) {\n  if (arguments.length < 1) {\n    throw new TypeError('1 argument required, but only ' + arguments.length + ' present');\n  }\n\n  var date = toDate(dirtyDate);\n  var timestamp = date.getTime();\n  date.setUTCMonth(0, 1);\n  date.setUTCHours(0, 0, 0, 0);\n  var startOfYearTimestamp = date.getTime();\n  var difference = timestamp - startOfYearTimestamp;\n  return Math.floor(difference / MILLISECONDS_IN_DAY) + 1;\n}","import lightFormatters from '../lightFormatters/index.js';\nimport getUTCDayOfYear from '../../../_lib/getUTCDayOfYear/index.js';\nimport getUTCISOWeek from '../../../_lib/getUTCISOWeek/index.js';\nimport getUTCISOWeekYear from '../../../_lib/getUTCISOWeekYear/index.js';\nimport getUTCWeek from '../../../_lib/getUTCWeek/index.js';\nimport getUTCWeekYear from '../../../_lib/getUTCWeekYear/index.js';\nimport addLeadingZeros from '../../addLeadingZeros/index.js';\nvar dayPeriodEnum = {\n  am: 'am',\n  pm: 'pm',\n  midnight: 'midnight',\n  noon: 'noon',\n  morning: 'morning',\n  afternoon: 'afternoon',\n  evening: 'evening',\n  night: 'night'\n  /*\n   * |     | Unit                           |     | Unit                           |\n   * |-----|--------------------------------|-----|--------------------------------|\n   * |  a  | AM, PM                         |  A* | Milliseconds in day            |\n   * |  b  | AM, PM, noon, midnight         |  B  | Flexible day period            |\n   * |  c  | Stand-alone local day of week  |  C* | Localized hour w/ day period   |\n   * |  d  | Day of month                   |  D  | Day of year                    |\n   * |  e  | Local day of week              |  E  | Day of week                    |\n   * |  f  |                                |  F* | Day of week in month           |\n   * |  g* | Modified Julian day            |  G  | Era                            |\n   * |  h  | Hour [1-12]                    |  H  | Hour [0-23]                    |\n   * |  i! | ISO day of week                |  I! | ISO week of year               |\n   * |  j* | Localized hour w/ day period   |  J* | Localized hour w/o day period  |\n   * |  k  | Hour [1-24]                    |  K  | Hour [0-11]                    |\n   * |  l* | (deprecated)                   |  L  | Stand-alone month              |\n   * |  m  | Minute                         |  M  | Month                          |\n   * |  n  |                                |  N  |                                |\n   * |  o! | Ordinal number modifier        |  O  | Timezone (GMT)                 |\n   * |  p! | Long localized time            |  P! | Long localized date            |\n   * |  q  | Stand-alone quarter            |  Q  | Quarter                        |\n   * |  r* | Related Gregorian year         |  R! | ISO week-numbering year        |\n   * |  s  | Second                         |  S  | Fraction of second             |\n   * |  t! | Seconds timestamp              |  T! | Milliseconds timestamp         |\n   * |  u  | Extended year                  |  U* | Cyclic year                    |\n   * |  v* | Timezone (generic non-locat.)  |  V* | Timezone (location)            |\n   * |  w  | Local week of year             |  W* | Week of month                  |\n   * |  x  | Timezone (ISO-8601 w/o Z)      |  X  | Timezone (ISO-8601)            |\n   * |  y  | Year (abs)                     |  Y  | Local week-numbering year      |\n   * |  z  | Timezone (specific non-locat.) |  Z* | Timezone (aliases)             |\n   *\n   * Letters marked by * are not implemented but reserved by Unicode standard.\n   *\n   * Letters marked by ! are non-standard, but implemented by date-fns:\n   * - `o` modifies the previous token to turn it into an ordinal (see `format` docs)\n   * - `i` is ISO day of week. For `i` and `ii` is returns numeric ISO week days,\n   *   i.e. 7 for Sunday, 1 for Monday, etc.\n   * - `I` is ISO week of year, as opposed to `w` which is local week of year.\n   * - `R` is ISO week-numbering year, as opposed to `Y` which is local week-numbering year.\n   *   `R` is supposed to be used in conjunction with `I` and `i`\n   *   for universal ISO week-numbering date, whereas\n   *   `Y` is supposed to be used in conjunction with `w` and `e`\n   *   for week-numbering date specific to the locale.\n   * - `P` is long localized date format\n   * - `p` is long localized time format\n   */\n\n};\nvar formatters = {\n  // Era\n  G: function (date, token, localize) {\n    var era = date.getUTCFullYear() > 0 ? 1 : 0;\n\n    switch (token) {\n      // AD, BC\n      case 'G':\n      case 'GG':\n      case 'GGG':\n        return localize.era(era, {\n          width: 'abbreviated'\n        });\n      // A, B\n\n      case 'GGGGG':\n        return localize.era(era, {\n          width: 'narrow'\n        });\n      // Anno Domini, Before Christ\n\n      case 'GGGG':\n      default:\n        return localize.era(era, {\n          width: 'wide'\n        });\n    }\n  },\n  // Year\n  y: function (date, token, localize) {\n    // Ordinal number\n    if (token === 'yo') {\n      var signedYear = date.getUTCFullYear(); // Returns 1 for 1 BC (which is year 0 in JavaScript)\n\n      var year = signedYear > 0 ? signedYear : 1 - signedYear;\n      return localize.ordinalNumber(year, {\n        unit: 'year'\n      });\n    }\n\n    return lightFormatters.y(date, token);\n  },\n  // Local week-numbering year\n  Y: function (date, token, localize, options) {\n    var signedWeekYear = getUTCWeekYear(date, options); // Returns 1 for 1 BC (which is year 0 in JavaScript)\n\n    var weekYear = signedWeekYear > 0 ? signedWeekYear : 1 - signedWeekYear; // Two digit year\n\n    if (token === 'YY') {\n      var twoDigitYear = weekYear % 100;\n      return addLeadingZeros(twoDigitYear, 2);\n    } // Ordinal number\n\n\n    if (token === 'Yo') {\n      return localize.ordinalNumber(weekYear, {\n        unit: 'year'\n      });\n    } // Padding\n\n\n    return addLeadingZeros(weekYear, token.length);\n  },\n  // ISO week-numbering year\n  R: function (date, token) {\n    var isoWeekYear = getUTCISOWeekYear(date); // Padding\n\n    return addLeadingZeros(isoWeekYear, token.length);\n  },\n  // Extended year. This is a single number designating the year of this calendar system.\n  // The main difference between `y` and `u` localizers are B.C. years:\n  // | Year | `y` | `u` |\n  // |------|-----|-----|\n  // | AC 1 |   1 |   1 |\n  // | BC 1 |   1 |   0 |\n  // | BC 2 |   2 |  -1 |\n  // Also `yy` always returns the last two digits of a year,\n  // while `uu` pads single digit years to 2 characters and returns other years unchanged.\n  u: function (date, token) {\n    var year = date.getUTCFullYear();\n    return addLeadingZeros(year, token.length);\n  },\n  // Quarter\n  Q: function (date, token, localize) {\n    var quarter = Math.ceil((date.getUTCMonth() + 1) / 3);\n\n    switch (token) {\n      // 1, 2, 3, 4\n      case 'Q':\n        return String(quarter);\n      // 01, 02, 03, 04\n\n      case 'QQ':\n        return addLeadingZeros(quarter, 2);\n      // 1st, 2nd, 3rd, 4th\n\n      case 'Qo':\n        return localize.ordinalNumber(quarter, {\n          unit: 'quarter'\n        });\n      // Q1, Q2, Q3, Q4\n\n      case 'QQQ':\n        return localize.quarter(quarter, {\n          width: 'abbreviated',\n          context: 'formatting'\n        });\n      // 1, 2, 3, 4 (narrow quarter; could be not numerical)\n\n      case 'QQQQQ':\n        return localize.quarter(quarter, {\n          width: 'narrow',\n          context: 'formatting'\n        });\n      // 1st quarter, 2nd quarter, ...\n\n      case 'QQQQ':\n      default:\n        return localize.quarter(quarter, {\n          width: 'wide',\n          context: 'formatting'\n        });\n    }\n  },\n  // Stand-alone quarter\n  q: function (date, token, localize) {\n    var quarter = Math.ceil((date.getUTCMonth() + 1) / 3);\n\n    switch (token) {\n      // 1, 2, 3, 4\n      case 'q':\n        return String(quarter);\n      // 01, 02, 03, 04\n\n      case 'qq':\n        return addLeadingZeros(quarter, 2);\n      // 1st, 2nd, 3rd, 4th\n\n      case 'qo':\n        return localize.ordinalNumber(quarter, {\n          unit: 'quarter'\n        });\n      // Q1, Q2, Q3, Q4\n\n      case 'qqq':\n        return localize.quarter(quarter, {\n          width: 'abbreviated',\n          context: 'standalone'\n        });\n      // 1, 2, 3, 4 (narrow quarter; could be not numerical)\n\n      case 'qqqqq':\n        return localize.quarter(quarter, {\n          width: 'narrow',\n          context: 'standalone'\n        });\n      // 1st quarter, 2nd quarter, ...\n\n      case 'qqqq':\n      default:\n        return localize.quarter(quarter, {\n          width: 'wide',\n          context: 'standalone'\n        });\n    }\n  },\n  // Month\n  M: function (date, token, localize) {\n    var month = date.getUTCMonth();\n\n    switch (token) {\n      case 'M':\n      case 'MM':\n        return lightFormatters.M(date, token);\n      // 1st, 2nd, ..., 12th\n\n      case 'Mo':\n        return localize.ordinalNumber(month + 1, {\n          unit: 'month'\n        });\n      // Jan, Feb, ..., Dec\n\n      case 'MMM':\n        return localize.month(month, {\n          width: 'abbreviated',\n          context: 'formatting'\n        });\n      // J, F, ..., D\n\n      case 'MMMMM':\n        return localize.month(month, {\n          width: 'narrow',\n          context: 'formatting'\n        });\n      // January, February, ..., December\n\n      case 'MMMM':\n      default:\n        return localize.month(month, {\n          width: 'wide',\n          context: 'formatting'\n        });\n    }\n  },\n  // Stand-alone month\n  L: function (date, token, localize) {\n    var month = date.getUTCMonth();\n\n    switch (token) {\n      // 1, 2, ..., 12\n      case 'L':\n        return String(month + 1);\n      // 01, 02, ..., 12\n\n      case 'LL':\n        return addLeadingZeros(month + 1, 2);\n      // 1st, 2nd, ..., 12th\n\n      case 'Lo':\n        return localize.ordinalNumber(month + 1, {\n          unit: 'month'\n        });\n      // Jan, Feb, ..., Dec\n\n      case 'LLL':\n        return localize.month(month, {\n          width: 'abbreviated',\n          context: 'standalone'\n        });\n      // J, F, ..., D\n\n      case 'LLLLL':\n        return localize.month(month, {\n          width: 'narrow',\n          context: 'standalone'\n        });\n      // January, February, ..., December\n\n      case 'LLLL':\n      default:\n        return localize.month(month, {\n          width: 'wide',\n          context: 'standalone'\n        });\n    }\n  },\n  // Local week of year\n  w: function (date, token, localize, options) {\n    var week = getUTCWeek(date, options);\n\n    if (token === 'wo') {\n      return localize.ordinalNumber(week, {\n        unit: 'week'\n      });\n    }\n\n    return addLeadingZeros(week, token.length);\n  },\n  // ISO week of year\n  I: function (date, token, localize) {\n    var isoWeek = getUTCISOWeek(date);\n\n    if (token === 'Io') {\n      return localize.ordinalNumber(isoWeek, {\n        unit: 'week'\n      });\n    }\n\n    return addLeadingZeros(isoWeek, token.length);\n  },\n  // Day of the month\n  d: function (date, token, localize) {\n    if (token === 'do') {\n      return localize.ordinalNumber(date.getUTCDate(), {\n        unit: 'date'\n      });\n    }\n\n    return lightFormatters.d(date, token);\n  },\n  // Day of year\n  D: function (date, token, localize) {\n    var dayOfYear = getUTCDayOfYear(date);\n\n    if (token === 'Do') {\n      return localize.ordinalNumber(dayOfYear, {\n        unit: 'dayOfYear'\n      });\n    }\n\n    return addLeadingZeros(dayOfYear, token.length);\n  },\n  // Day of week\n  E: function (date, token, localize) {\n    var dayOfWeek = date.getUTCDay();\n\n    switch (token) {\n      // Tue\n      case 'E':\n      case 'EE':\n      case 'EEE':\n        return localize.day(dayOfWeek, {\n          width: 'abbreviated',\n          context: 'formatting'\n        });\n      // T\n\n      case 'EEEEE':\n        return localize.day(dayOfWeek, {\n          width: 'narrow',\n          context: 'formatting'\n        });\n      // Tu\n\n      case 'EEEEEE':\n        return localize.day(dayOfWeek, {\n          width: 'short',\n          context: 'formatting'\n        });\n      // Tuesday\n\n      case 'EEEE':\n      default:\n        return localize.day(dayOfWeek, {\n          width: 'wide',\n          context: 'formatting'\n        });\n    }\n  },\n  // Local day of week\n  e: function (date, token, localize, options) {\n    var dayOfWeek = date.getUTCDay();\n    var localDayOfWeek = (dayOfWeek - options.weekStartsOn + 8) % 7 || 7;\n\n    switch (token) {\n      // Numerical value (Nth day of week with current locale or weekStartsOn)\n      case 'e':\n        return String(localDayOfWeek);\n      // Padded numerical value\n\n      case 'ee':\n        return addLeadingZeros(localDayOfWeek, 2);\n      // 1st, 2nd, ..., 7th\n\n      case 'eo':\n        return localize.ordinalNumber(localDayOfWeek, {\n          unit: 'day'\n        });\n\n      case 'eee':\n        return localize.day(dayOfWeek, {\n          width: 'abbreviated',\n          context: 'formatting'\n        });\n      // T\n\n      case 'eeeee':\n        return localize.day(dayOfWeek, {\n          width: 'narrow',\n          context: 'formatting'\n        });\n      // Tu\n\n      case 'eeeeee':\n        return localize.day(dayOfWeek, {\n          width: 'short',\n          context: 'formatting'\n        });\n      // Tuesday\n\n      case 'eeee':\n      default:\n        return localize.day(dayOfWeek, {\n          width: 'wide',\n          context: 'formatting'\n        });\n    }\n  },\n  // Stand-alone local day of week\n  c: function (date, token, localize, options) {\n    var dayOfWeek = date.getUTCDay();\n    var localDayOfWeek = (dayOfWeek - options.weekStartsOn + 8) % 7 || 7;\n\n    switch (token) {\n      // Numerical value (same as in `e`)\n      case 'c':\n        return String(localDayOfWeek);\n      // Padded numerical value\n\n      case 'cc':\n        return addLeadingZeros(localDayOfWeek, token.length);\n      // 1st, 2nd, ..., 7th\n\n      case 'co':\n        return localize.ordinalNumber(localDayOfWeek, {\n          unit: 'day'\n        });\n\n      case 'ccc':\n        return localize.day(dayOfWeek, {\n          width: 'abbreviated',\n          context: 'standalone'\n        });\n      // T\n\n      case 'ccccc':\n        return localize.day(dayOfWeek, {\n          width: 'narrow',\n          context: 'standalone'\n        });\n      // Tu\n\n      case 'cccccc':\n        return localize.day(dayOfWeek, {\n          width: 'short',\n          context: 'standalone'\n        });\n      // Tuesday\n\n      case 'cccc':\n      default:\n        return localize.day(dayOfWeek, {\n          width: 'wide',\n          context: 'standalone'\n        });\n    }\n  },\n  // ISO day of week\n  i: function (date, token, localize) {\n    var dayOfWeek = date.getUTCDay();\n    var isoDayOfWeek = dayOfWeek === 0 ? 7 : dayOfWeek;\n\n    switch (token) {\n      // 2\n      case 'i':\n        return String(isoDayOfWeek);\n      // 02\n\n      case 'ii':\n        return addLeadingZeros(isoDayOfWeek, token.length);\n      // 2nd\n\n      case 'io':\n        return localize.ordinalNumber(isoDayOfWeek, {\n          unit: 'day'\n        });\n      // Tue\n\n      case 'iii':\n        return localize.day(dayOfWeek, {\n          width: 'abbreviated',\n          context: 'formatting'\n        });\n      // T\n\n      case 'iiiii':\n        return localize.day(dayOfWeek, {\n          width: 'narrow',\n          context: 'formatting'\n        });\n      // Tu\n\n      case 'iiiiii':\n        return localize.day(dayOfWeek, {\n          width: 'short',\n          context: 'formatting'\n        });\n      // Tuesday\n\n      case 'iiii':\n      default:\n        return localize.day(dayOfWeek, {\n          width: 'wide',\n          context: 'formatting'\n        });\n    }\n  },\n  // AM or PM\n  a: function (date, token, localize) {\n    var hours = date.getUTCHours();\n    var dayPeriodEnumValue = hours / 12 >= 1 ? 'pm' : 'am';\n\n    switch (token) {\n      case 'a':\n      case 'aa':\n      case 'aaa':\n        return localize.dayPeriod(dayPeriodEnumValue, {\n          width: 'abbreviated',\n          context: 'formatting'\n        });\n\n      case 'aaaaa':\n        return localize.dayPeriod(dayPeriodEnumValue, {\n          width: 'narrow',\n          context: 'formatting'\n        });\n\n      case 'aaaa':\n      default:\n        return localize.dayPeriod(dayPeriodEnumValue, {\n          width: 'wide',\n          context: 'formatting'\n        });\n    }\n  },\n  // AM, PM, midnight, noon\n  b: function (date, token, localize) {\n    var hours = date.getUTCHours();\n    var dayPeriodEnumValue;\n\n    if (hours === 12) {\n      dayPeriodEnumValue = dayPeriodEnum.noon;\n    } else if (hours === 0) {\n      dayPeriodEnumValue = dayPeriodEnum.midnight;\n    } else {\n      dayPeriodEnumValue = hours / 12 >= 1 ? 'pm' : 'am';\n    }\n\n    switch (token) {\n      case 'b':\n      case 'bb':\n      case 'bbb':\n        return localize.dayPeriod(dayPeriodEnumValue, {\n          width: 'abbreviated',\n          context: 'formatting'\n        });\n\n      case 'bbbbb':\n        return localize.dayPeriod(dayPeriodEnumValue, {\n          width: 'narrow',\n          context: 'formatting'\n        });\n\n      case 'bbbb':\n      default:\n        return localize.dayPeriod(dayPeriodEnumValue, {\n          width: 'wide',\n          context: 'formatting'\n        });\n    }\n  },\n  // in the morning, in the afternoon, in the evening, at night\n  B: function (date, token, localize) {\n    var hours = date.getUTCHours();\n    var dayPeriodEnumValue;\n\n    if (hours >= 17) {\n      dayPeriodEnumValue = dayPeriodEnum.evening;\n    } else if (hours >= 12) {\n      dayPeriodEnumValue = dayPeriodEnum.afternoon;\n    } else if (hours >= 4) {\n      dayPeriodEnumValue = dayPeriodEnum.morning;\n    } else {\n      dayPeriodEnumValue = dayPeriodEnum.night;\n    }\n\n    switch (token) {\n      case 'B':\n      case 'BB':\n      case 'BBB':\n        return localize.dayPeriod(dayPeriodEnumValue, {\n          width: 'abbreviated',\n          context: 'formatting'\n        });\n\n      case 'BBBBB':\n        return localize.dayPeriod(dayPeriodEnumValue, {\n          width: 'narrow',\n          context: 'formatting'\n        });\n\n      case 'BBBB':\n      default:\n        return localize.dayPeriod(dayPeriodEnumValue, {\n          width: 'wide',\n          context: 'formatting'\n        });\n    }\n  },\n  // Hour [1-12]\n  h: function (date, token, localize) {\n    if (token === 'ho') {\n      var hours = date.getUTCHours() % 12;\n      if (hours === 0) hours = 12;\n      return localize.ordinalNumber(hours, {\n        unit: 'hour'\n      });\n    }\n\n    return lightFormatters.h(date, token);\n  },\n  // Hour [0-23]\n  H: function (date, token, localize) {\n    if (token === 'Ho') {\n      return localize.ordinalNumber(date.getUTCHours(), {\n        unit: 'hour'\n      });\n    }\n\n    return lightFormatters.H(date, token);\n  },\n  // Hour [0-11]\n  K: function (date, token, localize) {\n    var hours = date.getUTCHours() % 12;\n\n    if (token === 'Ko') {\n      return localize.ordinalNumber(hours, {\n        unit: 'hour'\n      });\n    }\n\n    return addLeadingZeros(hours, token.length);\n  },\n  // Hour [1-24]\n  k: function (date, token, localize) {\n    var hours = date.getUTCHours();\n    if (hours === 0) hours = 24;\n\n    if (token === 'ko') {\n      return localize.ordinalNumber(hours, {\n        unit: 'hour'\n      });\n    }\n\n    return addLeadingZeros(hours, token.length);\n  },\n  // Minute\n  m: function (date, token, localize) {\n    if (token === 'mo') {\n      return localize.ordinalNumber(date.getUTCMinutes(), {\n        unit: 'minute'\n      });\n    }\n\n    return lightFormatters.m(date, token);\n  },\n  // Second\n  s: function (date, token, localize) {\n    if (token === 'so') {\n      return localize.ordinalNumber(date.getUTCSeconds(), {\n        unit: 'second'\n      });\n    }\n\n    return lightFormatters.s(date, token);\n  },\n  // Fraction of second\n  S: function (date, token) {\n    return lightFormatters.S(date, token);\n  },\n  // Timezone (ISO-8601. If offset is 0, output is always `'Z'`)\n  X: function (date, token, _localize, options) {\n    var originalDate = options._originalDate || date;\n    var timezoneOffset = originalDate.getTimezoneOffset();\n\n    if (timezoneOffset === 0) {\n      return 'Z';\n    }\n\n    switch (token) {\n      // Hours and optional minutes\n      case 'X':\n        return formatTimezoneWithOptionalMinutes(timezoneOffset);\n      // Hours, minutes and optional seconds without `:` delimiter\n      // Note: neither ISO-8601 nor JavaScript supports seconds in timezone offsets\n      // so this token always has the same output as `XX`\n\n      case 'XXXX':\n      case 'XX':\n        // Hours and minutes without `:` delimiter\n        return formatTimezone(timezoneOffset);\n      // Hours, minutes and optional seconds with `:` delimiter\n      // Note: neither ISO-8601 nor JavaScript supports seconds in timezone offsets\n      // so this token always has the same output as `XXX`\n\n      case 'XXXXX':\n      case 'XXX': // Hours and minutes with `:` delimiter\n\n      default:\n        return formatTimezone(timezoneOffset, ':');\n    }\n  },\n  // Timezone (ISO-8601. If offset is 0, output is `'+00:00'` or equivalent)\n  x: function (date, token, _localize, options) {\n    var originalDate = options._originalDate || date;\n    var timezoneOffset = originalDate.getTimezoneOffset();\n\n    switch (token) {\n      // Hours and optional minutes\n      case 'x':\n        return formatTimezoneWithOptionalMinutes(timezoneOffset);\n      // Hours, minutes and optional seconds without `:` delimiter\n      // Note: neither ISO-8601 nor JavaScript supports seconds in timezone offsets\n      // so this token always has the same output as `xx`\n\n      case 'xxxx':\n      case 'xx':\n        // Hours and minutes without `:` delimiter\n        return formatTimezone(timezoneOffset);\n      // Hours, minutes and optional seconds with `:` delimiter\n      // Note: neither ISO-8601 nor JavaScript supports seconds in timezone offsets\n      // so this token always has the same output as `xxx`\n\n      case 'xxxxx':\n      case 'xxx': // Hours and minutes with `:` delimiter\n\n      default:\n        return formatTimezone(timezoneOffset, ':');\n    }\n  },\n  // Timezone (GMT)\n  O: function (date, token, _localize, options) {\n    var originalDate = options._originalDate || date;\n    var timezoneOffset = originalDate.getTimezoneOffset();\n\n    switch (token) {\n      // Short\n      case 'O':\n      case 'OO':\n      case 'OOO':\n        return 'GMT' + formatTimezoneShort(timezoneOffset, ':');\n      // Long\n\n      case 'OOOO':\n      default:\n        return 'GMT' + formatTimezone(timezoneOffset, ':');\n    }\n  },\n  // Timezone (specific non-location)\n  z: function (date, token, _localize, options) {\n    var originalDate = options._originalDate || date;\n    var timezoneOffset = originalDate.getTimezoneOffset();\n\n    switch (token) {\n      // Short\n      case 'z':\n      case 'zz':\n      case 'zzz':\n        return 'GMT' + formatTimezoneShort(timezoneOffset, ':');\n      // Long\n\n      case 'zzzz':\n      default:\n        return 'GMT' + formatTimezone(timezoneOffset, ':');\n    }\n  },\n  // Seconds timestamp\n  t: function (date, token, _localize, options) {\n    var originalDate = options._originalDate || date;\n    var timestamp = Math.floor(originalDate.getTime() / 1000);\n    return addLeadingZeros(timestamp, token.length);\n  },\n  // Milliseconds timestamp\n  T: function (date, token, _localize, options) {\n    var originalDate = options._originalDate || date;\n    var timestamp = originalDate.getTime();\n    return addLeadingZeros(timestamp, token.length);\n  }\n};\n\nfunction formatTimezoneShort(offset, dirtyDelimiter) {\n  var sign = offset > 0 ? '-' : '+';\n  var absOffset = Math.abs(offset);\n  var hours = Math.floor(absOffset / 60);\n  var minutes = absOffset % 60;\n\n  if (minutes === 0) {\n    return sign + String(hours);\n  }\n\n  var delimiter = dirtyDelimiter || '';\n  return sign + String(hours) + delimiter + addLeadingZeros(minutes, 2);\n}\n\nfunction formatTimezoneWithOptionalMinutes(offset, dirtyDelimiter) {\n  if (offset % 60 === 0) {\n    var sign = offset > 0 ? '-' : '+';\n    return sign + addLeadingZeros(Math.abs(offset) / 60, 2);\n  }\n\n  return formatTimezone(offset, dirtyDelimiter);\n}\n\nfunction formatTimezone(offset, dirtyDelimiter) {\n  var delimiter = dirtyDelimiter || '';\n  var sign = offset > 0 ? '-' : '+';\n  var absOffset = Math.abs(offset);\n  var hours = addLeadingZeros(Math.floor(absOffset / 60), 2);\n  var minutes = addLeadingZeros(absOffset % 60, 2);\n  return sign + hours + delimiter + minutes;\n}\n\nexport default formatters;","import isValid from '../isValid/index.js';\nimport defaultLocale from '../locale/en-US/index.js';\nimport subMilliseconds from '../subMilliseconds/index.js';\nimport toDate from '../toDate/index.js';\nimport formatters from '../_lib/format/formatters/index.js';\nimport longFormatters from '../_lib/format/longFormatters/index.js';\nimport getTimezoneOffsetInMilliseconds from '../_lib/getTimezoneOffsetInMilliseconds/index.js';\nimport { isProtectedDayOfYearToken, isProtectedWeekYearToken, throwProtectedError } from '../_lib/protectedTokens/index.js';\nimport toInteger from '../_lib/toInteger/index.js'; // This RegExp consists of three parts separated by `|`:\n// - [yYQqMLwIdDecihHKkms]o matches any available ordinal number token\n//   (one of the certain letters followed by `o`)\n// - (\\w)\\1* matches any sequences of the same letter\n// - '' matches two quote characters in a row\n// - '(''|[^'])+('|$) matches anything surrounded by two quote characters ('),\n//   except a single quote symbol, which ends the sequence.\n//   Two quote characters do not end the sequence.\n//   If there is no matching single quote\n//   then the sequence will continue until the end of the string.\n// - . matches any single character unmatched by previous parts of the RegExps\n\nvar formattingTokensRegExp = /[yYQqMLwIdDecihHKkms]o|(\\w)\\1*|''|'(''|[^'])+('|$)|./g; // This RegExp catches symbols escaped by quotes, and also\n// sequences of symbols P, p, and the combinations like `PPPPPPPppppp`\n\nvar longFormattingTokensRegExp = /P+p+|P+|p+|''|'(''|[^'])+('|$)|./g;\nvar escapedStringRegExp = /^'([^]*?)'?$/;\nvar doubleQuoteRegExp = /''/g;\nvar unescapedLatinCharacterRegExp = /[a-zA-Z]/;\n/**\n * @name format\n * @category Common Helpers\n * @summary Format the date.\n *\n * @description\n * Return the formatted date string in the given format. The result may vary by locale.\n *\n * > ⚠️ Please note that the `format` tokens differ from Moment.js and other libraries.\n * > See: https://git.io/fxCyr\n *\n * The characters wrapped between two single quotes characters (') are escaped.\n * Two single quotes in a row, whether inside or outside a quoted sequence, represent a 'real' single quote.\n * (see the last example)\n *\n * Format of the string is based on Unicode Technical Standard #35:\n * https://www.unicode.org/reports/tr35/tr35-dates.html#Date_Field_Symbol_Table\n * with a few additions (see note 7 below the table).\n *\n * Accepted patterns:\n * | Unit                            | Pattern | Result examples                   | Notes |\n * |---------------------------------|---------|-----------------------------------|-------|\n * | Era                             | G..GGG  | AD, BC                            |       |\n * |                                 | GGGG    | Anno Domini, Before Christ        | 2     |\n * |                                 | GGGGG   | A, B                              |       |\n * | Calendar year                   | y       | 44, 1, 1900, 2017                 | 5     |\n * |                                 | yo      | 44th, 1st, 0th, 17th              | 5,7   |\n * |                                 | yy      | 44, 01, 00, 17                    | 5     |\n * |                                 | yyy     | 044, 001, 1900, 2017              | 5     |\n * |                                 | yyyy    | 0044, 0001, 1900, 2017            | 5     |\n * |                                 | yyyyy   | ...                               | 3,5   |\n * | Local week-numbering year       | Y       | 44, 1, 1900, 2017                 | 5     |\n * |                                 | Yo      | 44th, 1st, 1900th, 2017th         | 5,7   |\n * |                                 | YY      | 44, 01, 00, 17                    | 5,8   |\n * |                                 | YYY     | 044, 001, 1900, 2017              | 5     |\n * |                                 | YYYY    | 0044, 0001, 1900, 2017            | 5,8   |\n * |                                 | YYYYY   | ...                               | 3,5   |\n * | ISO week-numbering year         | R       | -43, 0, 1, 1900, 2017             | 5,7   |\n * |                                 | RR      | -43, 00, 01, 1900, 2017           | 5,7   |\n * |                                 | RRR     | -043, 000, 001, 1900, 2017        | 5,7   |\n * |                                 | RRRR    | -0043, 0000, 0001, 1900, 2017     | 5,7   |\n * |                                 | RRRRR   | ...                               | 3,5,7 |\n * | Extended year                   | u       | -43, 0, 1, 1900, 2017             | 5     |\n * |                                 | uu      | -43, 01, 1900, 2017               | 5     |\n * |                                 | uuu     | -043, 001, 1900, 2017             | 5     |\n * |                                 | uuuu    | -0043, 0001, 1900, 2017           | 5     |\n * |                                 | uuuuu   | ...                               | 3,5   |\n * | Quarter (formatting)            | Q       | 1, 2, 3, 4                        |       |\n * |                                 | Qo      | 1st, 2nd, 3rd, 4th                | 7     |\n * |                                 | QQ      | 01, 02, 03, 04                    |       |\n * |                                 | QQQ     | Q1, Q2, Q3, Q4                    |       |\n * |                                 | QQQQ    | 1st quarter, 2nd quarter, ...     | 2     |\n * |                                 | QQQQQ   | 1, 2, 3, 4                        | 4     |\n * | Quarter (stand-alone)           | q       | 1, 2, 3, 4                        |       |\n * |                                 | qo      | 1st, 2nd, 3rd, 4th                | 7     |\n * |                                 | qq      | 01, 02, 03, 04                    |       |\n * |                                 | qqq     | Q1, Q2, Q3, Q4                    |       |\n * |                                 | qqqq    | 1st quarter, 2nd quarter, ...     | 2     |\n * |                                 | qqqqq   | 1, 2, 3, 4                        | 4     |\n * | Month (formatting)              | M       | 1, 2, ..., 12                     |       |\n * |                                 | Mo      | 1st, 2nd, ..., 12th               | 7     |\n * |                                 | MM      | 01, 02, ..., 12                   |       |\n * |                                 | MMM     | Jan, Feb, ..., Dec                |       |\n * |                                 | MMMM    | January, February, ..., December  | 2     |\n * |                                 | MMMMM   | J, F, ..., D                      |       |\n * | Month (stand-alone)             | L       | 1, 2, ..., 12                     |       |\n * |                                 | Lo      | 1st, 2nd, ..., 12th               | 7     |\n * |                                 | LL      | 01, 02, ..., 12                   |       |\n * |                                 | LLL     | Jan, Feb, ..., Dec                |       |\n * |                                 | LLLL    | January, February, ..., December  | 2     |\n * |                                 | LLLLL   | J, F, ..., D                      |       |\n * | Local week of year              | w       | 1, 2, ..., 53                     |       |\n * |                                 | wo      | 1st, 2nd, ..., 53th               | 7     |\n * |                                 | ww      | 01, 02, ..., 53                   |       |\n * | ISO week of year                | I       | 1, 2, ..., 53                     | 7     |\n * |                                 | Io      | 1st, 2nd, ..., 53th               | 7     |\n * |                                 | II      | 01, 02, ..., 53                   | 7     |\n * | Day of month                    | d       | 1, 2, ..., 31                     |       |\n * |                                 | do      | 1st, 2nd, ..., 31st               | 7     |\n * |                                 | dd      | 01, 02, ..., 31                   |       |\n * | Day of year                     | D       | 1, 2, ..., 365, 366               | 9     |\n * |                                 | Do      | 1st, 2nd, ..., 365th, 366th       | 7     |\n * |                                 | DD      | 01, 02, ..., 365, 366             | 9     |\n * |                                 | DDD     | 001, 002, ..., 365, 366           |       |\n * |                                 | DDDD    | ...                               | 3     |\n * | Day of week (formatting)        | E..EEE  | Mon, Tue, Wed, ..., Su            |       |\n * |                                 | EEEE    | Monday, Tuesday, ..., Sunday      | 2     |\n * |                                 | EEEEE   | M, T, W, T, F, S, S               |       |\n * |                                 | EEEEEE  | Mo, Tu, We, Th, Fr, Su, Sa        |       |\n * | ISO day of week (formatting)    | i       | 1, 2, 3, ..., 7                   | 7     |\n * |                                 | io      | 1st, 2nd, ..., 7th                | 7     |\n * |                                 | ii      | 01, 02, ..., 07                   | 7     |\n * |                                 | iii     | Mon, Tue, Wed, ..., Su            | 7     |\n * |                                 | iiii    | Monday, Tuesday, ..., Sunday      | 2,7   |\n * |                                 | iiiii   | M, T, W, T, F, S, S               | 7     |\n * |                                 | iiiiii  | Mo, Tu, We, Th, Fr, Su, Sa        | 7     |\n * | Local day of week (formatting)  | e       | 2, 3, 4, ..., 1                   |       |\n * |                                 | eo      | 2nd, 3rd, ..., 1st                | 7     |\n * |                                 | ee      | 02, 03, ..., 01                   |       |\n * |                                 | eee     | Mon, Tue, Wed, ..., Su            |       |\n * |                                 | eeee    | Monday, Tuesday, ..., Sunday      | 2     |\n * |                                 | eeeee   | M, T, W, T, F, S, S               |       |\n * |                                 | eeeeee  | Mo, Tu, We, Th, Fr, Su, Sa        |       |\n * | Local day of week (stand-alone) | c       | 2, 3, 4, ..., 1                   |       |\n * |                                 | co      | 2nd, 3rd, ..., 1st                | 7     |\n * |                                 | cc      | 02, 03, ..., 01                   |       |\n * |                                 | ccc     | Mon, Tue, Wed, ..., Su            |       |\n * |                                 | cccc    | Monday, Tuesday, ..., Sunday      | 2     |\n * |                                 | ccccc   | M, T, W, T, F, S, S               |       |\n * |                                 | cccccc  | Mo, Tu, We, Th, Fr, Su, Sa        |       |\n * | AM, PM                          | a..aaa  | AM, PM                            |       |\n * |                                 | aaaa    | a.m., p.m.                        | 2     |\n * |                                 | aaaaa   | a, p                              |       |\n * | AM, PM, noon, midnight          | b..bbb  | AM, PM, noon, midnight            |       |\n * |                                 | bbbb    | a.m., p.m., noon, midnight        | 2     |\n * |                                 | bbbbb   | a, p, n, mi                       |       |\n * | Flexible day period             | B..BBB  | at night, in the morning, ...     |       |\n * |                                 | BBBB    | at night, in the morning, ...     | 2     |\n * |                                 | BBBBB   | at night, in the morning, ...     |       |\n * | Hour [1-12]                     | h       | 1, 2, ..., 11, 12                 |       |\n * |                                 | ho      | 1st, 2nd, ..., 11th, 12th         | 7     |\n * |                                 | hh      | 01, 02, ..., 11, 12               |       |\n * | Hour [0-23]                     | H       | 0, 1, 2, ..., 23                  |       |\n * |                                 | Ho      | 0th, 1st, 2nd, ..., 23rd          | 7     |\n * |                                 | HH      | 00, 01, 02, ..., 23               |       |\n * | Hour [0-11]                     | K       | 1, 2, ..., 11, 0                  |       |\n * |                                 | Ko      | 1st, 2nd, ..., 11th, 0th          | 7     |\n * |                                 | KK      | 1, 2, ..., 11, 0                  |       |\n * | Hour [1-24]                     | k       | 24, 1, 2, ..., 23                 |       |\n * |                                 | ko      | 24th, 1st, 2nd, ..., 23rd         | 7     |\n * |                                 | kk      | 24, 01, 02, ..., 23               |       |\n * | Minute                          | m       | 0, 1, ..., 59                     |       |\n * |                                 | mo      | 0th, 1st, ..., 59th               | 7     |\n * |                                 | mm      | 00, 01, ..., 59                   |       |\n * | Second                          | s       | 0, 1, ..., 59                     |       |\n * |                                 | so      | 0th, 1st, ..., 59th               | 7     |\n * |                                 | ss      | 00, 01, ..., 59                   |       |\n * | Fraction of second              | S       | 0, 1, ..., 9                      |       |\n * |                                 | SS      | 00, 01, ..., 99                   |       |\n * |                                 | SSS     | 000, 0001, ..., 999               |       |\n * |                                 | SSSS    | ...                               | 3     |\n * | Timezone (ISO-8601 w/ Z)        | X       | -08, +0530, Z                     |       |\n * |                                 | XX      | -0800, +0530, Z                   |       |\n * |                                 | XXX     | -08:00, +05:30, Z                 |       |\n * |                                 | XXXX    | -0800, +0530, Z, +123456          | 2     |\n * |                                 | XXXXX   | -08:00, +05:30, Z, +12:34:56      |       |\n * | Timezone (ISO-8601 w/o Z)       | x       | -08, +0530, +00                   |       |\n * |                                 | xx      | -0800, +0530, +0000               |       |\n * |                                 | xxx     | -08:00, +05:30, +00:00            | 2     |\n * |                                 | xxxx    | -0800, +0530, +0000, +123456      |       |\n * |                                 | xxxxx   | -08:00, +05:30, +00:00, +12:34:56 |       |\n * | Timezone (GMT)                  | O...OOO | GMT-8, GMT+5:30, GMT+0            |       |\n * |                                 | OOOO    | GMT-08:00, GMT+05:30, GMT+00:00   | 2     |\n * | Timezone (specific non-locat.)  | z...zzz | GMT-8, GMT+5:30, GMT+0            | 6     |\n * |                                 | zzzz    | GMT-08:00, GMT+05:30, GMT+00:00   | 2,6   |\n * | Seconds timestamp               | t       | 512969520                         | 7     |\n * |                                 | tt      | ...                               | 3,7   |\n * | Milliseconds timestamp          | T       | 512969520900                      | 7     |\n * |                                 | TT      | ...                               | 3,7   |\n * | Long localized date             | P       | 05/29/1453                        | 7     |\n * |                                 | PP      | May 29, 1453                      | 7     |\n * |                                 | PPP     | May 29th, 1453                    | 7     |\n * |                                 | PPPP    | Sunday, May 29th, 1453            | 2,7   |\n * | Long localized time             | p       | 12:00 AM                          | 7     |\n * |                                 | pp      | 12:00:00 AM                       | 7     |\n * |                                 | ppp     | 12:00:00 AM GMT+2                 | 7     |\n * |                                 | pppp    | 12:00:00 AM GMT+02:00             | 2,7   |\n * | Combination of date and time    | Pp      | 05/29/1453, 12:00 AM              | 7     |\n * |                                 | PPpp    | May 29, 1453, 12:00:00 AM         | 7     |\n * |                                 | PPPppp  | May 29th, 1453 at ...             | 7     |\n * |                                 | PPPPpppp| Sunday, May 29th, 1453 at ...     | 2,7   |\n * Notes:\n * 1. \"Formatting\" units (e.g. formatting quarter) in the default en-US locale\n *    are the same as \"stand-alone\" units, but are different in some languages.\n *    \"Formatting\" units are declined according to the rules of the language\n *    in the context of a date. \"Stand-alone\" units are always nominative singular:\n *\n *    `format(new Date(2017, 10, 6), 'do LLLL', {locale: cs}) //=> '6. listopad'`\n *\n *    `format(new Date(2017, 10, 6), 'do MMMM', {locale: cs}) //=> '6. listopadu'`\n *\n * 2. Any sequence of the identical letters is a pattern, unless it is escaped by\n *    the single quote characters (see below).\n *    If the sequence is longer than listed in table (e.g. `EEEEEEEEEEE`)\n *    the output will be the same as default pattern for this unit, usually\n *    the longest one (in case of ISO weekdays, `EEEE`). Default patterns for units\n *    are marked with \"2\" in the last column of the table.\n *\n *    `format(new Date(2017, 10, 6), 'MMM') //=> 'Nov'`\n *\n *    `format(new Date(2017, 10, 6), 'MMMM') //=> 'November'`\n *\n *    `format(new Date(2017, 10, 6), 'MMMMM') //=> 'N'`\n *\n *    `format(new Date(2017, 10, 6), 'MMMMMM') //=> 'November'`\n *\n *    `format(new Date(2017, 10, 6), 'MMMMMMM') //=> 'November'`\n *\n * 3. Some patterns could be unlimited length (such as `yyyyyyyy`).\n *    The output will be padded with zeros to match the length of the pattern.\n *\n *    `format(new Date(2017, 10, 6), 'yyyyyyyy') //=> '00002017'`\n *\n * 4. `QQQQQ` and `qqqqq` could be not strictly numerical in some locales.\n *    These tokens represent the shortest form of the quarter.\n *\n * 5. The main difference between `y` and `u` patterns are B.C. years:\n *\n *    | Year | `y` | `u` |\n *    |------|-----|-----|\n *    | AC 1 |   1 |   1 |\n *    | BC 1 |   1 |   0 |\n *    | BC 2 |   2 |  -1 |\n *\n *    Also `yy` always returns the last two digits of a year,\n *    while `uu` pads single digit years to 2 characters and returns other years unchanged:\n *\n *    | Year | `yy` | `uu` |\n *    |------|------|------|\n *    | 1    |   01 |   01 |\n *    | 14   |   14 |   14 |\n *    | 376  |   76 |  376 |\n *    | 1453 |   53 | 1453 |\n *\n *    The same difference is true for local and ISO week-numbering years (`Y` and `R`),\n *    except local week-numbering years are dependent on `options.weekStartsOn`\n *    and `options.firstWeekContainsDate` (compare [getISOWeekYear]{@link https://date-fns.org/docs/getISOWeekYear}\n *    and [getWeekYear]{@link https://date-fns.org/docs/getWeekYear}).\n *\n * 6. Specific non-location timezones are currently unavailable in `date-fns`,\n *    so right now these tokens fall back to GMT timezones.\n *\n * 7. These patterns are not in the Unicode Technical Standard #35:\n *    - `i`: ISO day of week\n *    - `I`: ISO week of year\n *    - `R`: ISO week-numbering year\n *    - `t`: seconds timestamp\n *    - `T`: milliseconds timestamp\n *    - `o`: ordinal number modifier\n *    - `P`: long localized date\n *    - `p`: long localized time\n *\n * 8. `YY` and `YYYY` tokens represent week-numbering years but they are often confused with years.\n *    You should enable `options.useAdditionalWeekYearTokens` to use them. See: https://git.io/fxCyr\n *\n * 9. `D` and `DD` tokens represent days of the year but they are ofthen confused with days of the month.\n *    You should enable `options.useAdditionalDayOfYearTokens` to use them. See: https://git.io/fxCyr\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * - The second argument is now required for the sake of explicitness.\n *\n *   ```javascript\n *   // Before v2.0.0\n *   format(new Date(2016, 0, 1))\n *\n *   // v2.0.0 onward\n *   format(new Date(2016, 0, 1), \"yyyy-MM-dd'T'HH:mm:ss.SSSxxx\")\n *   ```\n *\n * - New format string API for `format` function\n *   which is based on [Unicode Technical Standard #35](https://www.unicode.org/reports/tr35/tr35-dates.html#Date_Field_Symbol_Table).\n *   See [this post](https://blog.date-fns.org/post/unicode-tokens-in-date-fns-v2-sreatyki91jg) for more details.\n *\n * - Characters are now escaped using single quote symbols (`'`) instead of square brackets.\n *\n * @param {Date|Number} date - the original date\n * @param {String} format - the string of tokens\n * @param {Object} [options] - an object with options.\n * @param {Locale} [options.locale=defaultLocale] - the locale object. See [Locale]{@link https://date-fns.org/docs/Locale}\n * @param {0|1|2|3|4|5|6} [options.weekStartsOn=0] - the index of the first day of the week (0 - Sunday)\n * @param {Number} [options.firstWeekContainsDate=1] - the day of January, which is\n * @param {Boolean} [options.useAdditionalWeekYearTokens=false] - if true, allows usage of the week-numbering year tokens `YY` and `YYYY`;\n *   see: https://git.io/fxCyr\n * @param {Boolean} [options.useAdditionalDayOfYearTokens=false] - if true, allows usage of the day of year tokens `D` and `DD`;\n *   see: https://git.io/fxCyr\n * @returns {String} the formatted date string\n * @throws {TypeError} 2 arguments required\n * @throws {RangeError} `date` must not be Invalid Date\n * @throws {RangeError} `options.locale` must contain `localize` property\n * @throws {RangeError} `options.locale` must contain `formatLong` property\n * @throws {RangeError} `options.weekStartsOn` must be between 0 and 6\n * @throws {RangeError} `options.firstWeekContainsDate` must be between 1 and 7\n * @throws {RangeError} use `yyyy` instead of `YYYY` for formatting years; see: https://git.io/fxCyr\n * @throws {RangeError} use `yy` instead of `YY` for formatting years; see: https://git.io/fxCyr\n * @throws {RangeError} use `d` instead of `D` for formatting days of the month; see: https://git.io/fxCyr\n * @throws {RangeError} use `dd` instead of `DD` for formatting days of the month; see: https://git.io/fxCyr\n * @throws {RangeError} format string contains an unescaped latin alphabet character\n *\n * @example\n * // Represent 11 February 2014 in middle-endian format:\n * var result = format(new Date(2014, 1, 11), 'MM/dd/yyyy')\n * //=> '02/11/2014'\n *\n * @example\n * // Represent 2 July 2014 in Esperanto:\n * import { eoLocale } from 'date-fns/locale/eo'\n * var result = format(new Date(2014, 6, 2), \"do 'de' MMMM yyyy\", {\n *   locale: eoLocale\n * })\n * //=> '2-a de julio 2014'\n *\n * @example\n * // Escape string by single quote characters:\n * var result = format(new Date(2014, 6, 2, 15), \"h 'o''clock'\")\n * //=> \"3 o'clock\"\n */\n\nexport default function format(dirtyDate, dirtyFormatStr, dirtyOptions) {\n  if (arguments.length < 2) {\n    throw new TypeError('2 arguments required, but only ' + arguments.length + ' present');\n  }\n\n  var formatStr = String(dirtyFormatStr);\n  var options = dirtyOptions || {};\n  var locale = options.locale || defaultLocale;\n  var localeFirstWeekContainsDate = locale.options && locale.options.firstWeekContainsDate;\n  var defaultFirstWeekContainsDate = localeFirstWeekContainsDate == null ? 1 : toInteger(localeFirstWeekContainsDate);\n  var firstWeekContainsDate = options.firstWeekContainsDate == null ? defaultFirstWeekContainsDate : toInteger(options.firstWeekContainsDate); // Test if weekStartsOn is between 1 and 7 _and_ is not NaN\n\n  if (!(firstWeekContainsDate >= 1 && firstWeekContainsDate <= 7)) {\n    throw new RangeError('firstWeekContainsDate must be between 1 and 7 inclusively');\n  }\n\n  var localeWeekStartsOn = locale.options && locale.options.weekStartsOn;\n  var defaultWeekStartsOn = localeWeekStartsOn == null ? 0 : toInteger(localeWeekStartsOn);\n  var weekStartsOn = options.weekStartsOn == null ? defaultWeekStartsOn : toInteger(options.weekStartsOn); // Test if weekStartsOn is between 0 and 6 _and_ is not NaN\n\n  if (!(weekStartsOn >= 0 && weekStartsOn <= 6)) {\n    throw new RangeError('weekStartsOn must be between 0 and 6 inclusively');\n  }\n\n  if (!locale.localize) {\n    throw new RangeError('locale must contain localize property');\n  }\n\n  if (!locale.formatLong) {\n    throw new RangeError('locale must contain formatLong property');\n  }\n\n  var originalDate = toDate(dirtyDate);\n\n  if (!isValid(originalDate)) {\n    throw new RangeError('Invalid time value');\n  } // Convert the date in system timezone to the same date in UTC+00:00 timezone.\n  // This ensures that when UTC functions will be implemented, locales will be compatible with them.\n  // See an issue about UTC functions: https://github.com/date-fns/date-fns/issues/376\n\n\n  var timezoneOffset = getTimezoneOffsetInMilliseconds(originalDate);\n  var utcDate = subMilliseconds(originalDate, timezoneOffset);\n  var formatterOptions = {\n    firstWeekContainsDate: firstWeekContainsDate,\n    weekStartsOn: weekStartsOn,\n    locale: locale,\n    _originalDate: originalDate\n  };\n  var result = formatStr.match(longFormattingTokensRegExp).map(function (substring) {\n    var firstCharacter = substring[0];\n\n    if (firstCharacter === 'p' || firstCharacter === 'P') {\n      var longFormatter = longFormatters[firstCharacter];\n      return longFormatter(substring, locale.formatLong, formatterOptions);\n    }\n\n    return substring;\n  }).join('').match(formattingTokensRegExp).map(function (substring) {\n    // Replace two single quote characters with one single quote character\n    if (substring === \"''\") {\n      return \"'\";\n    }\n\n    var firstCharacter = substring[0];\n\n    if (firstCharacter === \"'\") {\n      return cleanEscapedString(substring);\n    }\n\n    var formatter = formatters[firstCharacter];\n\n    if (formatter) {\n      if (!options.useAdditionalWeekYearTokens && isProtectedWeekYearToken(substring)) {\n        throwProtectedError(substring);\n      }\n\n      if (!options.useAdditionalDayOfYearTokens && isProtectedDayOfYearToken(substring)) {\n        throwProtectedError(substring);\n      }\n\n      return formatter(utcDate, substring, locale.localize, formatterOptions);\n    }\n\n    if (firstCharacter.match(unescapedLatinCharacterRegExp)) {\n      throw new RangeError('Format string contains an unescaped latin alphabet character `' + firstCharacter + '`');\n    }\n\n    return substring;\n  }).join('');\n  return result;\n}\n\nfunction cleanEscapedString(input) {\n  return input.match(escapedStringRegExp)[1].replace(doubleQuoteRegExp, \"'\");\n}","import toDate from '../toDate/index.js';\n/**\n * @name isValid\n * @category Common Helpers\n * @summary Is the given date valid?\n *\n * @description\n * Returns false if argument is Invalid Date and true otherwise.\n * Argument is converted to Date using `toDate`. See [toDate]{@link https://date-fns.org/docs/toDate}\n * Invalid Date is a Date, whose time value is NaN.\n *\n * Time value of Date: http://es5.github.io/#x15.9.1.1\n *\n * ### v2.0.0 breaking changes:\n *\n * - [Changes that are common for the whole library](https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#Common-Changes).\n *\n * - Now `isValid` doesn't throw an exception\n *   if the first argument is not an instance of Date.\n *   Instead, argument is converted beforehand using `toDate`.\n *\n *   Examples:\n *\n *   | `isValid` argument        | Before v2.0.0 | v2.0.0 onward |\n *   |---------------------------|---------------|---------------|\n *   | `new Date()`              | `true`        | `true`        |\n *   | `new Date('2016-01-01')`  | `true`        | `true`        |\n *   | `new Date('')`            | `false`       | `false`       |\n *   | `new Date(1488370835081)` | `true`        | `true`        |\n *   | `new Date(NaN)`           | `false`       | `false`       |\n *   | `'2016-01-01'`            | `TypeError`   | `false`       |\n *   | `''`                      | `TypeError`   | `false`       |\n *   | `1488370835081`           | `TypeError`   | `true`        |\n *   | `NaN`                     | `TypeError`   | `false`       |\n *\n *   We introduce this change to make *date-fns* consistent with ECMAScript behavior\n *   that try to coerce arguments to the expected type\n *   (which is also the case with other *date-fns* functions).\n *\n * @param {*} date - the date to check\n * @returns {Boolean} the date is valid\n * @throws {TypeError} 1 argument required\n *\n * @example\n * // For the valid date:\n * var result = isValid(new Date(2014, 1, 31))\n * //=> true\n *\n * @example\n * // For the value, convertable into a date:\n * var result = isValid(1393804800000)\n * //=> true\n *\n * @example\n * // For the invalid date:\n * var result = isValid(new Date(''))\n * //=> false\n */\n\nexport default function isValid(dirtyDate) {\n  if (arguments.length < 1) {\n    throw new TypeError('1 argument required, but only ' + arguments.length + ' present');\n  }\n\n  var date = toDate(dirtyDate);\n  return !isNaN(date);\n}","import formatPN from './formatPN';\nimport formatDA from './formatDA';\nimport formatTM from './formatTM';\nimport formatNumberPrecision from './formatNumberPrecision';\nimport isValidNumber from './isValidNumber';\nimport uuidv4 from './uuidv4.js';\n\nconst helpers = {\n  formatPN,\n  formatDA,\n  formatTM,\n  formatNumberPrecision,\n  isValidNumber,\n};\n\nexport { helpers, uuidv4 };\n","/**\n * Formats a patient name for display purposes\n */\nexport default function formatPN(name) {\n  if (!name) {\n    return;\n  }\n\n  // Convert the first ^ to a ', '. String.replace() only affects\n  // the first appearance of the character.\n  const commaBetweenFirstAndLast = name.replace('^', ', ');\n\n  // Replace any remaining '^' characters with spaces\n  const cleaned = commaBetweenFirstAndLast.replace(/\\^/g, ' ');\n\n  // Trim any extraneous whitespace\n  return cleaned.trim();\n}\n","import { parse, format } from 'date-fns';\n\nexport default function formatDA(date, strFormat = 'MMM D, YYYY') {\n  if (!date) {\n    return;\n  }\n\n  try {\n    const parsedDateTime = parse(date, 'yyyyMMdd', new Date());\n    const formattedDateTime = format(parsedDateTime, strFormat);\n\n    return formattedDateTime;\n  } catch (err) {\n    // swallow?\n  }\n}\n","import { parse, format } from 'date-fns';\n\nexport default function formatTM(time, strFormat = 'HH:mm:ss') {\n  if (!time) {\n    return;\n  }\n\n  try {\n    const inputFormat = 'HHmmss.SSS';\n    const strTime = time.toString().substring(0, inputFormat.length);\n    const parsedDateTime = parse(strTime, 'HHmmss.SSS', new Date(0));\n    const formattedDateTime = format(parsedDateTime, strFormat);\n\n    return formattedDateTime;\n  } catch (err) {\n    // swallow?\n  }\n\n  return format(parsedDateTime, strFormat);\n}\n","import { PureComponent } from 'react';\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { helpers } from '../helpers/index.js';\nimport './ViewportOverlay.css';\n\nconst {\n  formatPN,\n  formatDA,\n  formatNumberPrecision,\n  formatTM,\n  isValidNumber,\n} = helpers;\n\nclass ViewportOverlay extends PureComponent {\n  static propTypes = {\n    voi: PropTypes.object.isRequired,\n    rotation: PropTypes.object,\n    studyDate: PropTypes.string,\n    studyTime: PropTypes.string,\n    studyDescription: PropTypes.string,\n    patientName: PropTypes.string,\n    patientId: PropTypes.string,\n    seriesNumber: PropTypes.string,\n    seriesDescription: PropTypes.string,\n  };\n\n  static defaultProps = {\n    voi: {\n      windowWidth: 0,\n      windowCenter: 0,\n    },\n  };\n\n  render() {\n    const {\n      studyDate,\n      studyTime,\n      studyDescription,\n      patientName,\n      patientId,\n      seriesNumber,\n      seriesDescription,\n      voi,\n      rotation,\n    } = this.props;\n    const { windowWidth, windowCenter } = voi;\n    const wwwc = `W: ${windowWidth.toFixed(0)} L: ${windowCenter.toFixed(0)}`;\n    const rotationString = rotation\n      ? `\\u03B8: ${rotation.theta.toFixed(1)} \\u03D5: ${rotation.phi.toFixed(\n          1\n        )}`\n      : null;\n\n    return (\n      <div className=\"ViewportOverlay\">\n        <div className=\"top-left overlay-element\">\n          <div>{formatPN(patientName)}</div>\n          <div>{patientId}</div>\n        </div>\n        <div className=\"top-right overlay-element\">\n          <div>{studyDescription}</div>\n          <div>\n            {formatDA(studyDate)} {formatTM(studyTime)}\n          </div>\n        </div>\n        <div className=\"bottom-right overlay-element\">\n          <div>{wwwc}</div>\n          <div>{rotationString}</div>\n        </div>\n        <div className=\"bottom-left overlay-element\">\n          <div>{seriesNumber >= 0 ? `Ser: ${seriesNumber}` : ''}</div>\n          <div>\n            <div>{seriesDescription}</div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default ViewportOverlay;\n","export function createSub(sub) {\n  let s = sub;\n  const unsubscribe = () => {\n    if (s) {\n      s.unsubscribe();\n      s = null;\n    }\n  };\n  return {\n    sub(newSub) {\n      unsubscribe();\n      s = newSub;\n    },\n    unsubscribe,\n  };\n}\n","export const setGlobalOpacity = (labelmap, colorLUT, opacity) => {\n  if (colorLUT) {\n    // TODO -> It seems to crash if you set it higher than 256??\n    const numColors = Math.min(256, colorLUT.length);\n\n    for (let i = 0; i < numColors; i++) {\n      //for (let i = 0; i < colorLUT.length; i++) {\n      const color = colorLUT[i];\n      labelmap.cfun.addRGBPoint(\n        i,\n        color[0] / 255,\n        color[1] / 255,\n        color[2] / 255\n      );\n\n      // Set the opacity per label.\n      const segmentOpacity = (color[3] / 255) * opacity;\n      labelmap.ofun.addPointLong(i, segmentOpacity, 0.5, 1.0);\n    }\n  }\n};\n\nexport default setGlobalOpacity;\n","import vtkImageData from 'vtk.js/Sources/Common/DataModel/ImageData';\nimport vtkDataArray from 'vtk.js/Sources/Common/Core/DataArray';\nimport vtkVolume from 'vtk.js/Sources/Rendering/Core/Volume';\nimport vtkVolumeMapper from 'vtk.js/Sources/Rendering/Core/VolumeMapper';\nimport vtkColorTransferFunction from 'vtk.js/Sources/Rendering/Core/ColorTransferFunction';\nimport vtkPiecewiseFunction from 'vtk.js/Sources/Common/DataModel/PiecewiseFunction';\nimport setGlobalOpacity from './setGlobalOpacity';\n\nexport default function createLabelPipeline(\n  backgroundImageData,\n  paintFilterLabelMapImageData,\n  options,\n  useSampleDistance = false\n) {\n  let labelMapData;\n  let {\n    colorLUT,\n    globalOpacity,\n    visible,\n    renderOutline,\n    outlineThickness,\n  } = options;\n\n  if (visible === undefined) {\n    visible = false;\n  }\n\n  if (globalOpacity === undefined) {\n    globalOpacity = 1.0;\n  }\n\n  if (outlineThickness === undefined) {\n    outlineThickness = 3;\n  }\n\n  if (paintFilterLabelMapImageData) {\n    labelMapData = paintFilterLabelMapImageData;\n  } else {\n    // Create a labelmap image the same dimensions as our background volume.\n    labelMapData = vtkImageData.newInstance(\n      backgroundImageData.get('spacing', 'origin', 'direction')\n    );\n    labelMapData.setDimensions(backgroundImageData.getDimensions());\n    labelMapData.computeTransforms();\n\n    const values = new Uint8Array(backgroundImageData.getNumberOfPoints());\n    const dataArray = vtkDataArray.newInstance({\n      numberOfComponents: 1, // labelmap with single component\n      values,\n    });\n    labelMapData.getPointData().setScalars(dataArray);\n  }\n\n  const mapper = vtkVolumeMapper.newInstance();\n  if (useSampleDistance) {\n    const sampleDistance =\n      0.7 *\n      Math.sqrt(\n        labelMapData\n          .getSpacing()\n          .map(v => v * v)\n          .reduce((a, b) => a + b, 0)\n      );\n\n    mapper.setSampleDistance(sampleDistance);\n  }\n\n  const labelMap = {\n    actor: vtkVolume.newInstance(),\n    mapper,\n    cfun: vtkColorTransferFunction.newInstance(),\n    ofun: vtkPiecewiseFunction.newInstance(),\n  };\n\n  // labelmap pipeline\n  labelMap.actor.setMapper(labelMap.mapper);\n  labelMap.actor.setVisibility(visible);\n  labelMap.ofun.addPointLong(0, 0, 0.5, 1.0);\n  labelMap.ofun.addPointLong(1, 1.0, 0.5, 1.0);\n\n  // Set up labelMap color and opacity mapping\n  if (colorLUT) {\n    setGlobalOpacity(labelMap, colorLUT, globalOpacity);\n  } else {\n    // Some default.\n    labelMap.cfun.addRGBPoint(1, 1, 0, 0); // label '1' will be red\n    labelMap.cfun.addRGBPoint(2, 0, 1, 0); // label '2' will be green\n    labelMap.cfun.addRGBPoint(3, 0, 1, 1); // label '3' will be blue\n    labelMap.ofun.addPointLong(1, 0.5, 0.5, 1.0); // All labels half opacity\n  }\n\n  labelMap.actor.getProperty().setRGBTransferFunction(0, labelMap.cfun);\n  labelMap.actor.getProperty().setScalarOpacity(0, labelMap.ofun);\n  labelMap.actor.getProperty().setInterpolationTypeToNearest();\n\n  if (renderOutline) {\n    labelMap.actor.getProperty().setUseLabelOutline(true);\n    labelMap.actor.getProperty().setLabelOutlineThickness(outlineThickness);\n  }\n\n  labelMap.ofun.setClamping(false);\n  labelMap.actor.getProperty().setScalarOpacityUnitDistance(0, 0.1);\n  labelMap.actor.getProperty().setUseGradientOpacity(0, false);\n\n  return labelMap;\n}\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport cornerstoneTools from 'cornerstone-tools';\nimport vtkGenericRenderWindow from 'vtk.js/Sources/Rendering/Misc/GenericRenderWindow';\nimport vtkRenderer from 'vtk.js/Sources/Rendering/Core/Renderer';\nimport vtkWidgetManager from 'vtk.js/Sources/Widgets/Core/WidgetManager';\nimport vtkInteractorStyleMPRSlice from './vtkInteractorStyleMPRSlice';\nimport vtkPaintFilter from 'vtk.js/Sources/Filters/General/PaintFilter';\nimport vtkPaintWidget from 'vtk.js/Sources/Widgets/Widgets3D/PaintWidget';\nimport vtkSVGWidgetManager from './vtkSVGWidgetManager';\n\nimport ViewportOverlay from '../ViewportOverlay/ViewportOverlay.js';\nimport { ViewTypes } from 'vtk.js/Sources/Widgets/Core/WidgetManager/Constants';\nimport { createSub } from '../lib/createSub.js';\nimport realsApproximatelyEqual from '../lib/math/realsApproximatelyEqual';\nimport createLabelPipeline from './createLabelPipeline';\nimport { uuidv4 } from './../helpers';\nimport setGlobalOpacity from './setGlobalOpacity';\n\nconst throttle = cornerstoneTools.importInternal('util/throttle');\n\nconst minSlabThickness = 0.1; // TODO -> Should this be configurable or not?\n\nconst radiansToDegrees = 360 / (2.0 * Math.PI);\n\nexport default class View2D extends Component {\n  static propTypes = {\n    volumes: PropTypes.array.isRequired,\n    actors: PropTypes.array,\n    painting: PropTypes.bool.isRequired,\n    paintFilterBackgroundImageData: PropTypes.object,\n    paintFilterLabelMapImageData: PropTypes.object,\n    onPaint: PropTypes.func,\n    onPaintStart: PropTypes.func,\n    onPaintEnd: PropTypes.func,\n    dataDetails: PropTypes.object,\n    onCreated: PropTypes.func,\n    onDestroyed: PropTypes.func,\n    orientation: PropTypes.object,\n    labelmapRenderingOptions: PropTypes.object,\n    showRotation: PropTypes.bool,\n  };\n\n  static defaultProps = {\n    painting: false,\n    labelmapRenderingOptions: {\n      visible: true,\n      renderOutline: true,\n      segmentsDefaultProperties: [],\n      onNewSegmentationRequested: () => {},\n    },\n    showRotation: false,\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.genericRenderWindow = null;\n    this.widgetManager = vtkWidgetManager.newInstance();\n    this.container = React.createRef();\n\n    this.subs = {\n      interactor: createSub(),\n      data: createSub(),\n      labelmap: createSub(),\n      paint: createSub(),\n      paintStart: createSub(),\n      paintEnd: createSub(),\n    };\n    this.interactorStyleSubs = [];\n    this.state = {\n      voi: this.getVOI(props.volumes[0]),\n      rotation: { theta: 0, phi: 0 },\n    };\n\n    this.apiProperties = {};\n  }\n\n  updatePaintbrush() {\n    const manip = this.paintWidget.getManipulator();\n    const handle = this.paintWidget.getWidgetState().getHandle();\n    const camera = this.paintRenderer.getActiveCamera();\n    const normal = camera.getDirectionOfProjection();\n    manip.setNormal(...normal);\n    manip.setOrigin(...camera.getFocalPoint());\n    handle.rotateFromDirections(handle.getDirection(), normal);\n  }\n\n  componentDidMount() {\n    // Tracking ID to tie emitted events to this component\n    const uid = uuidv4();\n\n    this.genericRenderWindow = vtkGenericRenderWindow.newInstance({\n      background: [0, 0, 0],\n    });\n\n    this.genericRenderWindow.setContainer(this.container.current);\n\n    let widgets = [];\n    let filters = [];\n    let actors = [];\n    let volumes = [];\n\n    const radius = 5;\n    const label = 1;\n\n    this.renderer = this.genericRenderWindow.getRenderer();\n    this.renderWindow = this.genericRenderWindow.getRenderWindow();\n    const oglrw = this.genericRenderWindow.getOpenGLRenderWindow();\n\n    // add paint renderer\n    this.paintRenderer = vtkRenderer.newInstance();\n    this.renderWindow.addRenderer(this.paintRenderer);\n    this.renderWindow.setNumberOfLayers(2);\n    this.paintRenderer.setLayer(1);\n    this.paintRenderer.setInteractive(false);\n\n    // update view node tree so that vtkOpenGLHardwareSelector can access\n    // the vtkOpenGLRenderer instance.\n    oglrw.buildPass(true);\n\n    const istyle = vtkInteractorStyleMPRSlice.newInstance();\n    this.renderWindow.getInteractor().setInteractorStyle(istyle);\n\n    const inter = this.renderWindow.getInteractor();\n    const updateCameras = () => {\n      const baseCamera = this.renderer.getActiveCamera();\n      const paintCamera = this.paintRenderer.getActiveCamera();\n\n      const position = baseCamera.getReferenceByName('position');\n      const focalPoint = baseCamera.getReferenceByName('focalPoint');\n      const viewUp = baseCamera.getReferenceByName('viewUp');\n      const viewAngle = baseCamera.getReferenceByName('viewAngle');\n\n      paintCamera.set({\n        position,\n        focalPoint,\n        viewUp,\n        viewAngle,\n      });\n    };\n    // TODO unsubscribe from this before component unmounts.\n    inter.onAnimation(updateCameras);\n    updateCameras();\n\n    this.widgetManager.disablePicking();\n    this.widgetManager.setRenderer(this.paintRenderer);\n    this.paintWidget = vtkPaintWidget.newInstance();\n    this.paintWidget.setRadius(radius);\n    this.paintFilter = vtkPaintFilter.newInstance();\n    this.paintFilter.setLabel(label);\n    this.paintFilter.setRadius(radius);\n\n    // trigger pipeline update\n    this.componentDidUpdate({});\n\n    // must be added AFTER the data volume is added so that this can be rendered in front\n    if (this.labelmap && this.labelmap.actor) {\n      this.renderer.addVolume(this.labelmap.actor);\n    }\n\n    if (this.props.actors) {\n      actors = actors.concat(this.props.actors);\n    }\n\n    if (this.labelmap && this.labelmap.actor) {\n      actors = actors.concat(this.labelmap.actor);\n    }\n\n    if (this.props.volumes) {\n      volumes = volumes.concat(this.props.volumes);\n    }\n\n    filters = [this.paintFilter];\n    widgets = [this.paintWidget];\n\n    // Make throttled function for rotation update.\n    this.throttledUpdateRotationOverlay = throttle(\n      this.updateRotationOverlay,\n      16,\n      { trailing: true }\n    ); // ~ 60 fps\n\n    // Set orientation based on props\n    if (this.props.orientation) {\n      const { orientation } = this.props;\n\n      this.setOrientation(orientation.sliceNormal, orientation.viewUp);\n    } else {\n      istyle.setSliceNormal(0, 0, 1);\n    }\n\n    const camera = this.renderer.getActiveCamera();\n\n    camera.setParallelProjection(true);\n    this.renderer.resetCamera();\n\n    istyle.setVolumeActor(this.props.volumes[0]);\n    const range = istyle.getSliceRange();\n    istyle.setSlice((range[0] + range[1]) / 2);\n\n    istyle.onModified(() => {\n      this.updatePaintbrush();\n    });\n    this.updatePaintbrush();\n\n    const svgWidgetManager = vtkSVGWidgetManager.newInstance();\n\n    svgWidgetManager.setRenderer(this.renderer);\n    svgWidgetManager.setScale(1);\n\n    this.svgWidgetManager = svgWidgetManager;\n\n    // TODO: Not sure why this is necessary to force the initial draw\n    this.genericRenderWindow.resize();\n\n    const boundUpdateVOI = this.updateVOI.bind(this);\n    const boundGetOrienation = this.getOrientation.bind(this);\n    const boundSetOrientation = this.setOrientation.bind(this);\n    const boundResetOrientation = this.resetOrientation.bind(this);\n    const boundGetViewUp = this.getViewUp.bind(this);\n    const boundGetSliceNormal = this.getSliceNormal.bind(this);\n    const boundSetInteractorStyle = this.setInteractorStyle.bind(this);\n    const boundGetSlabThickness = this.getSlabThickness.bind(this);\n    const boundSetSlabThickness = this.setSlabThickness.bind(this);\n    const boundAddSVGWidget = this.addSVGWidget.bind(this);\n    const boundGetApiProperty = this.getApiProperty.bind(this);\n    const boundSetApiProperty = this.setApiProperty.bind(this);\n    const boundSetSegmentRGB = this.setSegmentRGB.bind(this);\n    const boundSetSegmentRGBA = this.setSegmentRGBA.bind(this);\n    const boundSetSegmentAlpha = this.setSegmentAlpha.bind(this);\n    const boundUpdateImage = this.updateImage.bind(this);\n    const boundSetSegmentVisibility = this.setSegmentVisibility.bind(this);\n    const boundSetGlobalOpacity = this.setGlobalOpacity.bind(this);\n    const boundSetVisibility = this.setVisibility.bind(this);\n    const boundSetOutlineThickness = this.setOutlineThickness.bind(this);\n    const boundOutlineRendering = this.setOutlineRendering.bind(this);\n    const boundRequestNewSegmentation = this.requestNewSegmentation.bind(this);\n\n    this.svgWidgets = {};\n\n    if (this.props.onCreated) {\n      /**\n       * Note: The contents of this Object are\n       * considered part of the API contract\n       * we make with consumers of this component.\n       */\n      const api = {\n        uid, // Tracking id available on `api`\n        genericRenderWindow: this.genericRenderWindow,\n        widgetManager: this.widgetManager,\n        svgWidgetManager: this.svgWidgetManager,\n        addSVGWidget: boundAddSVGWidget,\n        container: this.container.current,\n        widgets,\n        svgWidgets: this.svgWidgets,\n        filters,\n        actors,\n        volumes,\n        _component: this,\n        updateImage: boundUpdateImage,\n        updateVOI: boundUpdateVOI,\n        getOrientation: boundGetOrienation,\n        setOrientation: boundSetOrientation,\n        resetOrientation: boundResetOrientation,\n        getViewUp: boundGetViewUp,\n        getSliceNormal: boundGetSliceNormal,\n        setInteractorStyle: boundSetInteractorStyle,\n        getSlabThickness: boundGetSlabThickness,\n        setSlabThickness: boundSetSlabThickness,\n        setSegmentRGB: boundSetSegmentRGB,\n        setSegmentRGBA: boundSetSegmentRGBA,\n        setSegmentAlpha: boundSetSegmentAlpha,\n        setSegmentVisibility: boundSetSegmentVisibility,\n        setGlobalOpacity: boundSetGlobalOpacity,\n        setVisibility: boundSetVisibility,\n        setOutlineThickness: boundSetOutlineThickness,\n        setOutlineRendering: boundOutlineRendering,\n        requestNewSegmentation: boundRequestNewSegmentation,\n        get: boundGetApiProperty,\n        set: boundSetApiProperty,\n        type: 'VIEW2D',\n      };\n\n      this.props.onCreated(api);\n    }\n  }\n\n  getViewUp() {\n    const renderWindow = this.genericRenderWindow.getRenderWindow();\n    const currentIStyle = renderWindow.getInteractor().getInteractorStyle();\n\n    return currentIStyle.getViewUp();\n  }\n\n  getSliceNormal() {\n    const renderWindow = this.genericRenderWindow.getRenderWindow();\n    const currentIStyle = renderWindow.getInteractor().getInteractorStyle();\n\n    return currentIStyle.getSliceNormal();\n  }\n\n  setOrientation(sliceNormal, viewUp) {\n    const renderWindow = this.genericRenderWindow.getRenderWindow();\n    const currentIStyle = renderWindow.getInteractor().getInteractorStyle();\n\n    this.updateRotationRelativeToOrientation(sliceNormal);\n\n    currentIStyle.setSliceOrientation(sliceNormal, viewUp);\n  }\n\n  resetOrientation() {\n    const orientation = this.props.orientation || {\n      sliceNormal: [0, 0, 1],\n      viewUp: [0, -1, 0],\n    };\n\n    // Reset orientation.\n    this.setOrientation(orientation.sliceNormal, orientation.viewUp);\n\n    // Reset slice.\n    const renderWindow = this.genericRenderWindow.getRenderWindow();\n    const currentIStyle = renderWindow.getInteractor().getInteractorStyle();\n    const range = currentIStyle.getSliceRange();\n\n    currentIStyle.setSlice((range[0] + range[1]) / 2);\n  }\n\n  getApiProperty(propertyName) {\n    return this.apiProperties[propertyName];\n  }\n\n  setApiProperty(propertyName, value) {\n    this.apiProperties[propertyName] = value;\n  }\n\n  addSVGWidget(widget, name) {\n    const { svgWidgetManager } = this;\n\n    svgWidgetManager.addWidget(widget);\n    svgWidgetManager.render();\n\n    this.svgWidgets[name] = widget;\n  }\n\n  getSlabThickness() {\n    const renderWindow = this.genericRenderWindow.getRenderWindow();\n    const currentIStyle = renderWindow.getInteractor().getInteractorStyle();\n\n    if (currentIStyle.getSlabThickness) {\n      return currentIStyle.getSlabThickness();\n    }\n  }\n\n  setSlabThickness(slabThickness) {\n    const renderWindow = this.genericRenderWindow.getRenderWindow();\n    const istyle = renderWindow.getInteractor().getInteractorStyle();\n\n    if (istyle.setSlabThickness) {\n      istyle.setSlabThickness(slabThickness);\n\n      if (this.props.paintFilterLabelMapImageData) {\n        const labelmapActor = this.labelmap.actor;\n\n        if (realsApproximatelyEqual(slabThickness, minSlabThickness)) {\n          if (\n            labelmapActor.getVisibility() !==\n            this.props.labelmapRenderingOptions.visible\n          ) {\n            labelmapActor.setVisibility(\n              this.props.labelmapRenderingOptions.visible\n            );\n          }\n        } else {\n          labelmapActor.setVisibility(false);\n        }\n      }\n    }\n\n    renderWindow.render();\n  }\n\n  updateImage() {\n    const renderWindow = this.genericRenderWindow.getRenderWindow();\n\n    renderWindow.render();\n  }\n\n  setInteractorStyle({ istyle, callbacks = {}, configuration = {} }) {\n    const { volumes } = this.props;\n    const renderWindow = this.genericRenderWindow.getRenderWindow();\n    const currentIStyle = renderWindow.getInteractor().getInteractorStyle();\n\n    // unsubscribe from previous iStyle's callbacks.\n    while (this.interactorStyleSubs.length) {\n      this.interactorStyleSubs.pop().unsubscribe();\n    }\n\n    let currentViewport;\n    if (currentIStyle.getViewport && istyle.getViewport) {\n      currentViewport = currentIStyle.getViewport();\n    }\n\n    const slabThickness = this.getSlabThickness();\n    const interactor = renderWindow.getInteractor();\n\n    interactor.setInteractorStyle(istyle);\n\n    // TODO: Not sure why this is required the second time this function is called\n    istyle.setInteractor(interactor);\n\n    if (currentViewport) {\n      istyle.setViewport(currentViewport);\n    }\n\n    if (istyle.getVolumeActor() !== volumes[0]) {\n      if (slabThickness && istyle.setSlabThickness) {\n        istyle.setSlabThickness(slabThickness);\n      }\n\n      istyle.setVolumeActor(volumes[0]);\n    }\n\n    // Add appropriate callbacks\n    Object.keys(callbacks).forEach(key => {\n      if (typeof istyle[key] === 'function') {\n        const subscription = istyle[key](callbacks[key]);\n\n        if (subscription && typeof subscription.unsubscribe === 'function') {\n          this.interactorStyleSubs.push(subscription);\n        }\n      }\n    });\n\n    // Set Configuration\n    if (configuration) {\n      istyle.set(configuration);\n    }\n\n    renderWindow.render();\n  }\n\n  updateVOI(windowWidth, windowCenter) {\n    this.setState({ voi: { windowWidth, windowCenter } });\n  }\n\n  updateRotationOverlay(theta, phi) {\n    this.setState({ rotation: { theta, phi } });\n  }\n\n  updateRotationRelativeToOrientation(newNormal) {\n    const { orientation } = this.props;\n    const { sliceNormal: originalSliceNormal } = orientation;\n\n    // convert to spherical coords;\n\n    // All unit vectors so no reason to calculate r for the speherical coords.\n\n    // Get original offset of normal relative to Z axis.\n    let [thetaOriginal, phiOriginal] = [\n      Math.acos(originalSliceNormal[2]), // r === 1\n      Math.atan2(originalSliceNormal[1], originalSliceNormal[0]),\n    ];\n\n    // Get new offset of normal relative to Z axis.\n    let [thetaNew, phiNew] = [\n      Math.acos(newNormal[2]), // r === 1\n      Math.atan2(newNormal[1], newNormal[0]),\n    ];\n\n    // Convert to degrees for the UI.\n    thetaOriginal *= radiansToDegrees;\n    phiOriginal *= radiansToDegrees;\n    thetaNew *= radiansToDegrees;\n    phiNew *= radiansToDegrees;\n\n    // Get the relative angle to the original orientation.\n    let thetaRelative = thetaNew - thetaOriginal;\n    let phiRelative = phiNew - phiOriginal;\n\n    // Rescale to the right ranges (0 <= theta <= pi, 0 <= phi < 2*pi)\n    if (thetaRelative > 180) {\n      thetaRelative -= 180;\n    } else if (thetaRelative < 0) {\n      thetaRelative = 180 - Math.abs(thetaRelative);\n    }\n\n    if (phiRelative >= 360) {\n      phiRelative -= 360;\n    } else if (phiRelative < 0) {\n      phiRelative = 360 - Math.abs(phiRelative);\n    }\n\n    this.throttledUpdateRotationOverlay(thetaRelative, phiRelative);\n  }\n\n  getOrientation() {\n    return this.props.orientation;\n  }\n\n  setSegmentRGBA(segmentIndex, [red, green, blue, alpha]) {\n    this.setSegmentRGB(segmentIndex, [red, green, blue]);\n    this.setSegmentAlpha(segmentIndex, alpha);\n  }\n\n  setGlobalOpacity(globalOpacity) {\n    const { labelmap } = this;\n    const colorLUT = this.props.labelmapRenderingOptions.colorLUT;\n    setGlobalOpacity(labelmap, colorLUT, globalOpacity);\n  }\n\n  setVisibility(visible) {\n    const { labelmap } = this;\n    labelmap.actor.setVisibility(visible);\n  }\n\n  setOutlineThickness(outlineThickness) {\n    const { labelmap } = this;\n    labelmap.actor.getProperty().setLabelOutlineThickness(outlineThickness);\n  }\n\n  setOutlineRendering(renderOutline) {\n    const { labelmap } = this;\n    labelmap.actor.getProperty().setUseLabelOutline(renderOutline);\n  }\n\n  requestNewSegmentation() {\n    this.props.labelmapRenderingOptions.onNewSegmentationRequested();\n  }\n\n  setSegmentRGB(segmentIndex, [red, green, blue]) {\n    const { labelmap } = this;\n\n    labelmap.cfun.addRGBPoint(segmentIndex, red / 255, green / 255, blue / 255);\n  }\n\n  setSegmentVisibility(segmentIndex, isVisible) {\n    this.setSegmentAlpha(segmentIndex, isVisible ? 255 : 0);\n  }\n\n  setSegmentAlpha(segmentIndex, alpha) {\n    const { labelmap } = this;\n    let { globalOpacity } = this.props.labelmapRenderingOptions;\n\n    if (globalOpacity === undefined) {\n      globalOpacity = 1.0;\n    }\n\n    const segmentOpacity = (alpha / 255) * globalOpacity;\n\n    labelmap.ofun.addPointLong(segmentIndex, segmentOpacity, 0.5, 1.0);\n  }\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.volumes !== this.props.volumes) {\n      this.props.volumes.forEach(volume => {\n        if (!volume.isA('vtkVolume')) {\n          console.warn('Data to <Vtk2D> is not vtkVolume data');\n        }\n      });\n\n      if (this.props.volumes.length) {\n        this.props.volumes.forEach(this.renderer.addVolume);\n      } else {\n        // TODO: Remove all volumes\n      }\n\n      this.renderWindow.render();\n    }\n\n    if (\n      !prevProps.paintFilterBackgroundImageData &&\n      this.props.paintFilterBackgroundImageData\n    ) {\n      // re-render if data has updated\n      this.subs.data.sub(\n        this.props.paintFilterBackgroundImageData.onModified(() => {\n          this.genericRenderWindow.resize();\n          this.renderWindow.render();\n        })\n      );\n      this.paintFilter.setBackgroundImage(\n        this.props.paintFilterBackgroundImageData\n      );\n    } else if (\n      prevProps.paintFilterBackgroundImageData &&\n      !this.props.paintFilterBackgroundImageData\n    ) {\n      this.paintFilter.setBackgroundImage(null);\n      this.subs.data.unsubscribe();\n    }\n\n    if (\n      prevProps.paintFilterLabelMapImageData !==\n        this.props.paintFilterLabelMapImageData &&\n      this.props.paintFilterLabelMapImageData\n    ) {\n      this.subs.labelmap.unsubscribe();\n\n      // Remove actors.\n      if (this.labelmap && this.labelmap.actor) {\n        this.renderer.removeVolume(this.labelmap.actor);\n\n        if (this.api) {\n          const { actors } = this.api;\n\n          const index = actors.findIndex(\n            actor => actor === this.labelmap.actor\n          );\n\n          if (index !== -1) {\n            actors.splice(index, 1);\n          }\n        }\n      }\n\n      const labelmapImageData = this.props.paintFilterLabelMapImageData;\n\n      const labelmap = createLabelPipeline(\n        this.props.paintFilterBackgroundImageData,\n        labelmapImageData,\n        this.props.labelmapRenderingOptions\n      );\n\n      this.labelmap = labelmap;\n\n      this.props.labelmapRenderingOptions.segmentsDefaultProperties.forEach(\n        (properties, segmentNumber) => {\n          if (properties) {\n            this.setSegmentVisibility(segmentNumber, properties.visible);\n          }\n        }\n      );\n\n      // Add actors.\n      if (this.labelmap && this.labelmap.actor) {\n        this.renderer.addVolume(this.labelmap.actor);\n\n        if (this.api) {\n          this.api.actors = this.api.actors.concat(this.labelmap.actor);\n        }\n      }\n\n      labelmap.mapper.setInputConnection(this.paintFilter.getOutputPort());\n\n      // You can update the labelmap externally just by calling modified()\n      this.paintFilter.setLabelMap(labelmapImageData);\n      this.subs.labelmap.sub(\n        labelmapImageData.onModified(() => {\n          labelmap.mapper.modified();\n\n          this.renderWindow.render();\n        })\n      );\n\n      this.genericRenderWindow.resize();\n    }\n\n    if (\n      prevProps.labelmapRenderingOptions &&\n      prevProps.labelmapRenderingOptions.visible !==\n        this.props.labelmapRenderingOptions.visible\n    ) {\n      this.labelmap.actor.setVisibility(\n        prevProps.labelmapRenderingOptions.visible\n      );\n    }\n\n    if (prevProps.painting !== this.props.painting) {\n      if (this.props.painting) {\n        this.viewWidget = this.widgetManager.addWidget(\n          this.paintWidget,\n          ViewTypes.SLICE\n        );\n        this.subs.paintStart.sub(\n          this.viewWidget.onStartInteractionEvent(() => {\n            this.paintFilter.startStroke();\n            this.paintFilter.addPoint(\n              this.paintWidget.getWidgetState().getTrueOrigin()\n            );\n            if (this.props.onPaintStart) {\n              this.props.onPaintStart();\n            }\n          })\n        );\n        this.subs.paint.sub(\n          this.viewWidget.onInteractionEvent(() => {\n            if (this.viewWidget.getPainting()) {\n              this.paintFilter.addPoint(\n                this.paintWidget.getWidgetState().getTrueOrigin()\n              );\n              if (this.props.onPaint) {\n                this.props.onPaint();\n              }\n            }\n          })\n        );\n        this.subs.paintEnd.sub(\n          this.viewWidget.onEndInteractionEvent(() => {\n            const strokeBufferPromise = this.paintFilter.endStroke();\n\n            if (this.props.onPaintEnd) {\n              strokeBufferPromise.then(strokeBuffer => {\n                this.props.onPaintEnd(strokeBuffer);\n              });\n            }\n          })\n        );\n\n        this.widgetManager.grabFocus(this.paintWidget);\n        this.widgetManager.enablePicking();\n\n        this.genericRenderWindow.resize();\n      } else if (this.viewWidget) {\n        this.widgetManager.releaseFocus();\n        this.widgetManager.removeWidget(this.paintWidget);\n        this.widgetManager.disablePicking();\n\n        this.subs.paintStart.unsubscribe();\n        this.subs.paint.unsubscribe();\n        this.subs.paintEnd.unsubscribe();\n        this.viewWidget = null;\n\n        this.genericRenderWindow.resize();\n      }\n    }\n  }\n\n  componentWillUnmount() {\n    Object.keys(this.subs).forEach(k => {\n      this.subs[k].unsubscribe();\n    });\n\n    if (this.props.onDestroyed) {\n      this.props.onDestroyed();\n    }\n\n    this.genericRenderWindow.delete();\n  }\n\n  getVOI = actor => {\n    // Note: This controls window/level\n\n    // TODO: Make this work reactively with onModified...\n    const rgbTransferFunction = actor.getProperty().getRGBTransferFunction(0);\n    const range = rgbTransferFunction.getMappingRange();\n    const windowWidth = Math.abs(range[1] - range[0]);\n    const windowCenter = range[0] + windowWidth / 2;\n\n    return {\n      windowCenter,\n      windowWidth,\n    };\n  };\n\n  render() {\n    if (!this.props.volumes || !this.props.volumes.length) {\n      return null;\n    }\n\n    const style = { width: '100%', height: '100%', position: 'relative' };\n    const voi = this.state.voi;\n    const rotation = this.props.showRotation ? this.state.rotation : null;\n\n    return (\n      <div style={style}>\n        <div ref={this.container} style={style} />\n        <ViewportOverlay\n          {...this.props.dataDetails}\n          voi={voi}\n          rotation={rotation}\n        />\n      </div>\n    );\n  }\n}\n","// From: https://stackoverflow.com/a/2117523/1867984\n\n// prettier-ignore\nexport default function uuidv4() {\n  return ([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g, c =>\n    (c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16)\n  );\n}\n","// eps is up to you to determine based on your application.\nexport default function realsApproximatelyEqual(a, b, eps = 0.00001) {\n  return Math.abs(a - b) < eps;\n}\n","import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport vtkGenericRenderWindow from 'vtk.js/Sources/Rendering/Misc/GenericRenderWindow';\nimport vtkWidgetManager from 'vtk.js/Sources/Widgets/Core/WidgetManager';\nimport vtkPaintFilter from 'vtk.js/Sources/Filters/General/PaintFilter';\nimport vtkPaintWidget from 'vtk.js/Sources/Widgets/Widgets3D/PaintWidget';\n\nimport ViewportOverlay from '../ViewportOverlay/ViewportOverlay.js';\nimport { ViewTypes } from 'vtk.js/Sources/Widgets/Core/WidgetManager/Constants';\nimport { createSub } from '../lib/createSub.js';\nimport createLabelPipeline from './createLabelPipeline';\n\nexport default class View3D extends Component {\n  static propTypes = {\n    volumes: PropTypes.array,\n    actors: PropTypes.array,\n    painting: PropTypes.bool.isRequired,\n    paintFilterBackgroundImageData: PropTypes.object,\n    paintFilterLabelMapImageData: PropTypes.object,\n    onPaint: PropTypes.func,\n    onPaintStart: PropTypes.func,\n    onPaintEnd: PropTypes.func,\n    sliceNormal: PropTypes.array.isRequired,\n    dataDetails: PropTypes.object,\n    onCreated: PropTypes.func,\n    onDestroyed: PropTypes.func,\n    labelmapRenderingOptions: PropTypes.object,\n  };\n\n  static defaultProps = {\n    painting: false,\n    sliceNormal: [0, 0, 1],\n    labelmapRenderingOptions: {\n      visible: true,\n      renderOutline: false,\n    },\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.genericRenderWindow = null;\n    this.widgetManager = vtkWidgetManager.newInstance();\n    this.container = React.createRef();\n    this.subs = {\n      interactor: createSub(),\n      data: createSub(),\n      labelmap: createSub(),\n      paint: createSub(),\n      paintStart: createSub(),\n      paintEnd: createSub(),\n    };\n  }\n\n  componentDidMount() {\n    this.genericRenderWindow = vtkGenericRenderWindow.newInstance({\n      background: [0, 0, 0],\n    });\n\n    this.genericRenderWindow.setContainer(this.container.current);\n\n    let widgets = [];\n    let filters = [];\n    let actors = [];\n    let volumes = [];\n\n    const radius = 5;\n    const label = 1;\n\n    this.renderer = this.genericRenderWindow.getRenderer();\n    this.renderWindow = this.genericRenderWindow.getRenderWindow();\n\n    this.widgetManager.disablePicking();\n    this.widgetManager.setRenderer(this.renderer);\n    this.paintWidget = vtkPaintWidget.newInstance();\n    this.paintWidget.setRadius(radius);\n    this.paintFilter = vtkPaintFilter.newInstance();\n    this.paintFilter.setLabel(label);\n    this.paintFilter.setRadius(radius);\n\n    // trigger pipeline update\n    this.componentDidUpdate({});\n\n    if (this.props.actors) {\n      actors = actors.concat(this.props.actors);\n    }\n\n    if (this.labelmap && this.labelmap.actor) {\n      actors = actors.concat(this.labelmap.actor);\n    }\n\n    if (this.props.volumes) {\n      volumes = volumes.concat(this.props.volumes);\n    }\n\n    filters = [this.paintFilter];\n    widgets = [this.paintWidget];\n\n    // must be added AFTER the data volume is added so that this can be rendered in front\n    if (this.labelmap && this.labelmap.actor) {\n      this.renderer.addVolume(this.labelmap.actor);\n    }\n\n    this.renderer.resetCamera();\n    this.renderer.updateLightsGeometryToFollowCamera();\n\n    // TODO: Not sure why this is necessary to force the initial draw\n    this.genericRenderWindow.resize();\n\n    if (this.props.onCreated) {\n      /**\n       * Note: The contents of this Object are\n       * considered part of the API contract\n       * we make with consumers of this component.\n       */\n      const api = {\n        genericRenderWindow: this.genericRenderWindow,\n        widgetManager: this.widgetManager,\n        container: this.container.current,\n        widgets,\n        filters,\n        actors,\n        volumes,\n        type: 'VIEW3D',\n        _component: this, // Backdoor still open for now whilst the API isn't as mature as View2D.\n      };\n\n      this.props.onCreated(api);\n    }\n  }\n\n  componentDidUpdate(prevProps) {\n    console.time('View3D componentDidUpdate');\n    if (prevProps.volumes !== this.props.volumes) {\n      this.props.volumes.forEach(volume => {\n        if (!volume.isA('vtkVolume')) {\n          console.warn('Data to <Vtk2D> is not vtkVolume data');\n        }\n      });\n\n      if (this.props.volumes.length) {\n        this.props.volumes.forEach(this.renderer.addVolume);\n      } else {\n        // TODO: Remove all volumes\n      }\n\n      this.renderWindow.render();\n    }\n\n    if (prevProps.actors !== this.props.actors && this.props.actors) {\n      this.props.actors.forEach(actor => {\n        if (!actor.isA('vtkActor')) {\n          console.warn('Data to <Vtk2D> is not vtkActor data');\n        }\n      });\n\n      if (this.props.actors.length) {\n        this.props.actors.forEach(this.renderer.addActor);\n      } else {\n        // TODO: Remove all actors\n      }\n\n      this.renderWindow.render();\n    }\n\n    if (\n      !prevProps.paintFilterBackgroundImageData &&\n      this.props.paintFilterBackgroundImageData\n    ) {\n      // re-render if data has updated\n      this.subs.data.sub(\n        this.props.paintFilterBackgroundImageData.onModified(() =>\n          this.renderWindow.render()\n        )\n      );\n      this.paintFilter.setBackgroundImage(\n        this.props.paintFilterBackgroundImageData\n      );\n    } else if (\n      prevProps.paintFilterBackgroundImageData &&\n      !this.props.paintFilterBackgroundImageData\n    ) {\n      this.paintFilter.setBackgroundImage(null);\n      this.subs.data.unsubscribe();\n    }\n\n    if (\n      prevProps.paintFilterLabelMapImageData !==\n        this.props.paintFilterLabelMapImageData &&\n      this.props.paintFilterLabelMapImageData\n    ) {\n      this.subs.labelmap.unsubscribe();\n\n      const labelmapImageData = this.props.paintFilterLabelMapImageData;\n      const labelmap = createLabelPipeline(\n        this.props.paintFilterBackgroundImageData,\n        labelmapImageData,\n        this.props.labelmapRenderingOptions,\n        false\n      );\n\n      this.labelmap = labelmap;\n\n      labelmap.mapper.setInputConnection(this.paintFilter.getOutputPort());\n\n      // You can update the labelmap externally just by calling modified()\n      this.paintFilter.setLabelMap(labelmapImageData);\n      this.subs.labelmap.sub(\n        labelmapImageData.onModified(() => {\n          labelmap.mapper.modified();\n\n          this.renderWindow.render();\n        })\n      );\n    }\n\n    if (prevProps.painting !== this.props.painting) {\n      if (this.props.painting) {\n        console.time('turnOnPainting');\n        this.viewWidget = this.widgetManager.addWidget(\n          this.paintWidget,\n          ViewTypes.VOLUME\n        );\n        this.subs.paintStart.sub(\n          this.viewWidget.onStartInteractionEvent(() => {\n            this.paintFilter.startStroke();\n            this.paintFilter.addPoint(\n              this.paintWidget.getWidgetState().getTrueOrigin()\n            );\n            if (this.props.onPaintStart) {\n              this.props.onPaintStart();\n            }\n          })\n        );\n        this.subs.paint.sub(\n          this.viewWidget.onInteractionEvent(() => {\n            if (this.viewWidget.getPainting()) {\n              this.paintFilter.addPoint(\n                this.paintWidget.getWidgetState().getTrueOrigin()\n              );\n              if (this.props.onPaint) {\n                this.props.onPaint();\n              }\n            }\n          })\n        );\n        this.subs.paintEnd.sub(\n          this.viewWidget.onEndInteractionEvent(() => {\n            const strokeBufferPromise = this.paintFilter.endStroke();\n\n            if (this.props.onPaintEnd) {\n              strokeBufferPromise.then(strokeBuffer => {\n                this.props.onPaintEnd(strokeBuffer);\n              });\n            }\n          })\n        );\n\n        this.widgetManager.grabFocus(this.paintWidget);\n        this.widgetManager.enablePicking();\n        console.timeEnd('turnOnPainting');\n      } else if (this.viewWidget) {\n        console.time('turnOffPainting');\n        this.widgetManager.releaseFocus();\n        this.widgetManager.removeWidget(this.paintWidget);\n        this.widgetManager.disablePicking();\n\n        this.subs.paintStart.unsubscribe();\n        this.subs.paint.unsubscribe();\n        this.subs.paintEnd.unsubscribe();\n        this.viewWidget = null;\n        console.timeEnd('turnOffPainting');\n      }\n    }\n\n    console.timeEnd('View3D componentDidUpdate');\n  }\n\n  componentWillUnmount() {\n    Object.keys(this.subs).forEach(k => {\n      this.subs[k].unsubscribe();\n    });\n\n    if (this.props.onDestroyed) {\n      this.props.onDestroyed();\n    }\n\n    this.genericRenderWindow.delete();\n  }\n\n  render() {\n    if (!this.props.volumes && !this.props.actors) {\n      return null;\n    }\n\n    const style = { width: '100%', height: '100%', position: 'relative' };\n\n    let voi = {\n      windowCenter: 0,\n      windowWidth: 0,\n    };\n\n    if (this.pipeline) {\n      const actor = this.props.volumes[0];\n\n      // Note: This controls window/level\n      const rgbTransferFunction = actor.getProperty().getRGBTransferFunction(0);\n      const range = rgbTransferFunction.getMappingRange();\n      const windowWidth = range[0] + range[1];\n      const windowCenter = range[0] + windowWidth / 2;\n\n      voi = {\n        windowCenter,\n        windowWidth,\n      };\n    }\n\n    return (\n      <div style={style}>\n        <div ref={this.container} style={style} />\n        <ViewportOverlay {...this.props.dataDetails} voi={voi} />\n      </div>\n    );\n  }\n}\n","export function toWindowLevel(low, high) {\n  const windowWidth = Math.abs(low - high);\n  const windowCenter = low + windowWidth / 2;\n\n  return { windowWidth, windowCenter };\n}\n\nexport function toLowHighRange(windowWidth, windowCenter) {\n  const lower = windowCenter - windowWidth / 2.0;\n  const upper = windowCenter + windowWidth / 2.0;\n\n  return { lower, upper };\n}\n","import macro from 'vtk.js/Sources/macro';\nimport vtkInteractorStyleMPRSlice from './vtkInteractorStyleMPRSlice.js';\nimport Constants from 'vtk.js/Sources/Rendering/Core/InteractorStyle/Constants';\nimport {\n  toWindowLevel,\n  toLowHighRange,\n} from '../lib/windowLevelRangeConverter';\n\nconst { States } = Constants;\n\n// ----------------------------------------------------------------------------\n// Global methods\n// ----------------------------------------------------------------------------\n\n// ----------------------------------------------------------------------------\n// vtkInteractorStyleMPRWindowLevel methods\n// ----------------------------------------------------------------------------\n\nfunction vtkInteractorStyleMPRWindowLevel(publicAPI, model) {\n  // Set our className\n  model.classHierarchy.push('vtkInteractorStyleMPRWindowLevel');\n\n  const superHandleMouseMove = publicAPI.handleMouseMove;\n  publicAPI.handleMouseMove = callData => {\n    const pos = [callData.position.x, callData.position.y];\n\n    if (model.state === States.IS_WINDOW_LEVEL) {\n      publicAPI.windowLevelFromMouse(pos);\n      publicAPI.invokeInteractionEvent({ type: 'InteractionEvent' });\n    }\n\n    if (superHandleMouseMove) {\n      superHandleMouseMove(callData);\n    }\n  };\n\n  publicAPI.windowLevelFromMouse = pos => {\n    const range = model.volumeActor\n      .getMapper()\n      .getInputData()\n      .getPointData()\n      .getScalars()\n      .getRange();\n    const imageDynamicRange = range[1] - range[0];\n    const multiplier =\n      Math.round(imageDynamicRange / 1024) * publicAPI.getLevelScale();\n    const dx = Math.round((pos[0] - model.wlStartPos[0]) * multiplier);\n    const dy = Math.round((pos[1] - model.wlStartPos[1]) * multiplier);\n\n    let windowWidth = model.levels.windowWidth + dx;\n    let windowCenter = model.levels.windowCenter - dy;\n\n    windowWidth = Math.max(0.01, windowWidth);\n\n    if (\n      model.windowWidth === windowWidth &&\n      model.windowCenter === windowCenter\n    ) {\n      return;\n    }\n\n    publicAPI.setWindowLevel(windowWidth, windowCenter);\n\n    model.wlStartPos[0] = Math.round(pos[0]);\n    model.wlStartPos[1] = Math.round(pos[1]);\n\n    const onLevelsChanged = publicAPI.getOnLevelsChanged();\n    if (onLevelsChanged) {\n      onLevelsChanged({ windowCenter, windowWidth });\n    }\n  };\n\n  publicAPI.getWindowLevel = () => {\n    const range = model.volumeActor\n      .getProperty()\n      .getRGBTransferFunction(0)\n      .getMappingRange()\n      .slice();\n    return toWindowLevel(...range);\n  };\n\n  publicAPI.setWindowLevel = (windowWidth, windowCenter) => {\n    const lowHigh = toLowHighRange(windowWidth, windowCenter);\n\n    model.levels.windowWidth = windowWidth;\n    model.levels.windowCenter = windowCenter;\n\n    model.volumeActor\n      .getProperty()\n      .getRGBTransferFunction(0)\n      .setMappingRange(lowHigh.lower, lowHigh.upper);\n  };\n\n  const superHandleLeftButtonPress = publicAPI.handleLeftButtonPress;\n  publicAPI.handleLeftButtonPress = callData => {\n    model.wlStartPos[0] = callData.position.x;\n    model.wlStartPos[1] = callData.position.y;\n    if (!callData.shiftKey && !callData.controlKey) {\n      const property = model.volumeActor.getProperty();\n      if (property) {\n        model.initialMRange = property\n          .getRGBTransferFunction(0)\n          .getMappingRange()\n          .slice();\n\n        model.levels = toWindowLevel(\n          model.initialMRange[0],\n          model.initialMRange[1]\n        );\n\n        publicAPI.startWindowLevel();\n      }\n    } else if (superHandleLeftButtonPress) {\n      superHandleLeftButtonPress(callData);\n    }\n  };\n\n  publicAPI.superHandleLeftButtonRelease = publicAPI.handleLeftButtonRelease;\n  publicAPI.handleLeftButtonRelease = () => {\n    switch (model.state) {\n      case States.IS_WINDOW_LEVEL:\n        publicAPI.endWindowLevel();\n        break;\n\n      default:\n        publicAPI.superHandleLeftButtonRelease();\n        break;\n    }\n  };\n}\n\n// ----------------------------------------------------------------------------\n// Object factory\n// ----------------------------------------------------------------------------\n\nconst DEFAULT_VALUES = {\n  wlStartPos: [0, 0],\n  levelScale: 1,\n};\n\n// ----------------------------------------------------------------------------\n\nexport function extend(publicAPI, model, initialValues = {}) {\n  Object.assign(model, DEFAULT_VALUES, initialValues);\n\n  // Inheritance\n  vtkInteractorStyleMPRSlice.extend(publicAPI, model, initialValues);\n\n  macro.setGet(publicAPI, model, ['onLevelsChanged', 'levelScale']);\n\n  // Object specific methods\n  vtkInteractorStyleMPRWindowLevel(publicAPI, model);\n}\n\n// ----------------------------------------------------------------------------\n\nexport const newInstance = macro.newInstance(\n  extend,\n  'vtkInteractorStyleMPRWindowLevel'\n);\n\n// ----------------------------------------------------------------------------\n\nexport default Object.assign({ newInstance, extend });\n","import macro from 'vtk.js/Sources/macro';\nimport vtkInteractorStyleMPRSlice from './vtkInteractorStyleMPRSlice.js';\nimport Constants from 'vtk.js/Sources/Rendering/Core/InteractorStyle/Constants';\nimport vtkCoordinate from 'vtk.js/Sources/Rendering/Core/Coordinate';\n\nconst { States } = Constants;\n\n// ----------------------------------------------------------------------------\n// Global methods\n// ----------------------------------------------------------------------------\n\n// ----------------------------------------------------------------------------\n// vtkInteractorStyleMPRCrosshairs methods\n// ----------------------------------------------------------------------------\n\nfunction vtkInteractorStyleMPRCrosshairs(publicAPI, model) {\n  // Set our className\n  model.classHierarchy.push('vtkInteractorStyleMPRCrosshairs');\n\n  function moveCrosshairs(callData) {\n    const { apis, apiIndex } = model;\n    const api = apis[apiIndex];\n\n    const pos = callData.position;\n    const renderer = callData.pokedRenderer;\n\n    const dPos = vtkCoordinate.newInstance();\n    dPos.setCoordinateSystemToDisplay();\n\n    dPos.setValue(pos.x, pos.y, 0);\n    let worldPos = dPos.getComputedWorldValue(renderer);\n\n    const camera = renderer.getActiveCamera();\n    const directionOfProjection = camera.getDirectionOfProjection();\n\n    const halfSlabThickness = api.getSlabThickness() / 2;\n\n    // Add half of the slab thickness to the world position, such that we select\n    // The center of the slice.\n\n    for (let i = 0; i < worldPos.length; i++) {\n      worldPos[i] += halfSlabThickness * directionOfProjection[i];\n    }\n\n    api.svgWidgets.crosshairsWidget.moveCrosshairs(worldPos, apis, apiIndex);\n\n    publicAPI.invokeInteractionEvent({ type: 'InteractionEvent' });\n  }\n\n  const superHandleMouseMove = publicAPI.handleMouseMove;\n  publicAPI.handleMouseMove = callData => {\n    if (model.state === States.IS_WINDOW_LEVEL) {\n      moveCrosshairs(callData);\n    }\n\n    if (superHandleMouseMove) {\n      superHandleMouseMove(callData);\n    }\n  };\n\n  const superHandleLeftButtonPress = publicAPI.handleLeftButtonPress;\n  publicAPI.handleLeftButtonPress = callData => {\n    if (!callData.shiftKey && !callData.controlKey) {\n      if (model.volumeActor) {\n        moveCrosshairs(callData);\n        publicAPI.startWindowLevel();\n      }\n    } else if (superHandleLeftButtonPress) {\n      superHandleLeftButtonPress(callData);\n    }\n  };\n\n  publicAPI.superHandleLeftButtonRelease = publicAPI.handleLeftButtonRelease;\n  publicAPI.handleLeftButtonRelease = () => {\n    switch (model.state) {\n      case States.IS_WINDOW_LEVEL:\n        publicAPI.endWindowLevel();\n        break;\n\n      default:\n        publicAPI.superHandleLeftButtonRelease();\n        break;\n    }\n  };\n}\n\n// ----------------------------------------------------------------------------\n// Object factory\n// ----------------------------------------------------------------------------\n\nconst DEFAULT_VALUES = {};\n\n// ----------------------------------------------------------------------------\n\nexport function extend(publicAPI, model, initialValues = {}) {\n  Object.assign(model, DEFAULT_VALUES, initialValues);\n\n  // Inheritance\n  vtkInteractorStyleMPRSlice.extend(publicAPI, model, initialValues);\n\n  macro.setGet(publicAPI, model, ['callback', 'apis', 'apiIndex', 'onScroll']);\n\n  // Object specific methods\n  vtkInteractorStyleMPRCrosshairs(publicAPI, model);\n}\n\n// ----------------------------------------------------------------------------\n\nexport const newInstance = macro.newInstance(\n  extend,\n  'vtkInteractorStyleMPRCrosshairs'\n);\n\n// ----------------------------------------------------------------------------\n\nexport default Object.assign({ newInstance, extend });\n","import macro from 'vtk.js/Sources/macro';\nimport vtkInteractorStyleMPRSlice from './vtkInteractorStyleMPRSlice.js';\nimport Constants from 'vtk.js/Sources/Rendering/Core/InteractorStyle/Constants';\nimport vtkCoordinate from 'vtk.js/Sources/Rendering/Core/Coordinate';\nimport vtkMatrixBuilder from 'vtk.js/Sources/Common/Core/MatrixBuilder';\nimport { vec2, vec3, quat } from 'gl-matrix';\nimport vtkMath from 'vtk.js/Sources/Common/Core/Math';\n\nconst { States } = Constants;\n\nconst operations = {\n  ROTATE_CROSSHAIRS: 0,\n  MOVE_CROSSHAIRS: 1,\n  MOVE_REFERENCE_LINE: 2,\n  PAN: 3,\n};\n\n// ----------------------------------------------------------------------------\n// Global methods\n// ----------------------------------------------------------------------------\n\n// ----------------------------------------------------------------------------\n// vtkInteractorStyleRotatableMPRCrosshairs methods\n// ----------------------------------------------------------------------------\n\nfunction vtkInteractorStyleRotatableMPRCrosshairs(publicAPI, model) {\n  // Set our className\n  model.classHierarchy.push('vtkInteractorStyleRotatableMPRCrosshairs');\n\n  function selectOpperation(callData) {\n    const { apis, apiIndex, lineGrabDistance } = model;\n    const thisApi = apis[apiIndex];\n    let { position } = callData;\n\n    setOtherApisInactive();\n\n    const { rotatableCrosshairsWidget } = thisApi.svgWidgets;\n\n    if (!rotatableCrosshairsWidget) {\n      throw new Error(\n        'Must use rotatable crosshair svg widget with this istyle.'\n      );\n    }\n\n    const lines = rotatableCrosshairsWidget.getReferenceLines();\n    const point = rotatableCrosshairsWidget.getPoint();\n    const centerRadius = rotatableCrosshairsWidget.getCenterRadius();\n\n    const distanceFromCenter = vec2.distance(point, [position.x, position.y]);\n\n    if (distanceFromCenter < centerRadius) {\n      // Click on center -> move the crosshairs.\n      model.operation = { type: operations.MOVE_CROSSHAIRS };\n\n      lines.forEach(line => {\n        line.selected = true;\n      });\n\n      return;\n    }\n\n    const { svgWidgetManager } = thisApi;\n    const size = svgWidgetManager.getSize();\n    const scale = svgWidgetManager.getScale();\n    const height = size[1];\n\n    // Map to the click point to the same coords as the SVG.\n    const p = { x: position.x * scale, y: height - position.y * scale };\n\n    // Check each rotation handle\n    for (let lineIndex = 0; lineIndex < lines.length; lineIndex++) {\n      const line = lines[lineIndex];\n      const lineRotateHandles = line.rotateHandles;\n      const { points } = lineRotateHandles;\n\n      for (let i = 0; i < points.length; i++) {\n        const distance = vec2.distance([points[i].x, points[i].y], [p.x, p.y]);\n\n        if (distance < lineGrabDistance) {\n          model.operation = {\n            type: operations.ROTATE_CROSSHAIRS,\n            prevPosition: position,\n          };\n\n          lineRotateHandles.selected = true;\n\n          // Set this line active.\n          if (lineIndex === 0) {\n            lines[0].active = true;\n            lines[1].active = false;\n          } else {\n            lines[0].active = false;\n            lines[1].active = true;\n          }\n\n          return;\n        }\n      }\n    }\n\n    const distanceFromFirstLine = distanceFromLine(lines[0], p); //position);\n    const distanceFromSecondLine = distanceFromLine(lines[1], p); //;\n\n    if (\n      distanceFromFirstLine <= lineGrabDistance ||\n      distanceFromSecondLine <= lineGrabDistance\n    ) {\n      // Click on line -> start a rotate of the other planes.\n\n      const selectedLineIndex =\n        distanceFromFirstLine < distanceFromSecondLine ? 0 : 1;\n\n      lines[selectedLineIndex].selected = true;\n      lines[selectedLineIndex].active = true;\n\n      // Deactivate other line if active\n      const otherLineIndex = selectedLineIndex === 0 ? 1 : 0;\n\n      lines[otherLineIndex].active = false;\n\n      // Set operation data.\n\n      model.operation = {\n        type: operations.MOVE_REFERENCE_LINE,\n        snapToLineIndex: selectedLineIndex === 0 ? 1 : 0,\n      };\n\n      return;\n    }\n\n    lines.forEach(line => {\n      line.active = false;\n    });\n\n    setOtherApisInactive();\n\n    // What is the fallback? Pan? Do nothing for now.\n    model.operation = { type: null };\n  }\n\n  function setOtherApisInactive() {\n    // Set other apis inactive\n\n    const { apis, apiIndex } = model;\n\n    apis.forEach((api, index) => {\n      if (index !== apiIndex) {\n        const { rotatableCrosshairsWidget } = api.svgWidgets;\n\n        if (!rotatableCrosshairsWidget) {\n          throw new Error(\n            'Must use rotatable crosshair svg widget with this istyle.'\n          );\n        }\n\n        const lines = rotatableCrosshairsWidget.getReferenceLines();\n\n        lines[0].active = false;\n        lines[1].active = false;\n      }\n    });\n  }\n\n  function distanceFromLine(line, point) {\n    const [a, b] = line.points;\n    const c = point;\n\n    // Get area from all 3 points...\n    const areaOfTriangle = Math.abs(\n      (a.x * (b.y - c.y) + b.x * (c.y - a.y) + c.x * (a.y - b.y)) / 2\n    );\n\n    // And area also equals 1/2 base * height, where height is the distance!\n    // So:\n    const base = vec2.distance([a.x, a.y], [b.x, b.y]);\n    const height = (2.0 * areaOfTriangle) / base;\n\n    // Note we don't have to worry about finite line length\n    // As the lines go across the whole canvas.\n\n    return height;\n  }\n\n  function performOperation(callData) {\n    const { operation } = model;\n    const { type } = operation;\n\n    let snapToLineIndex;\n    let pos;\n\n    switch (type) {\n      case operations.MOVE_CROSSHAIRS:\n        moveCrosshairs(callData.position, callData.pokedRenderer);\n        break;\n      case operations.MOVE_REFERENCE_LINE:\n        snapToLineIndex = operation.snapToLineIndex;\n        pos = snapPosToLine(callData.position, snapToLineIndex);\n\n        moveCrosshairs(pos, callData.pokedRenderer);\n        break;\n      case operations.ROTATE_CROSSHAIRS:\n        rotateCrosshairs(callData);\n        break;\n    }\n  }\n\n  function rotateCrosshairs(callData) {\n    const { operation } = model;\n    const { prevPosition } = operation;\n\n    const newPosition = callData.position;\n\n    if (newPosition.x === prevPosition.x && newPosition.y === prevPosition.y) {\n      // No change, exit early.\n      return;\n    }\n\n    const { apis, apiIndex } = model;\n    const thisApi = apis[apiIndex];\n\n    const { rotatableCrosshairsWidget } = thisApi.svgWidgets;\n\n    const point = rotatableCrosshairsWidget.getPoint();\n\n    let pointToPreviousPosition = [];\n    let pointToNewPosition = [];\n\n    // Get vector from center of crosshairs to previous position.\n    vec2.subtract(\n      pointToPreviousPosition,\n      [prevPosition.x, prevPosition.y],\n      point\n    );\n\n    // Get vector from center of crosshairs to new position.\n    vec2.subtract(pointToNewPosition, [newPosition.x, newPosition.y], point);\n\n    // Get angle of rotation from previous reference line position to the new position.\n    let angle = vec2.angle(pointToPreviousPosition, pointToNewPosition);\n\n    // Use the determinant to find the sign of the angle.\n    const determinant =\n      pointToNewPosition[0] * pointToPreviousPosition[1] -\n      pointToNewPosition[1] * pointToPreviousPosition[0];\n\n    if (determinant > 0) {\n      angle *= -1;\n    }\n\n    // Axis is the opposite direction of the plane normal for this API.\n    const sliceNormal = thisApi.getSliceNormal();\n    const axis = [-sliceNormal[0], -sliceNormal[1], -sliceNormal[2]];\n\n    // Rotate other apis\n    apis.forEach((api, index) => {\n      if (index !== apiIndex) {\n        const cameraForApi = api.genericRenderWindow\n          .getRenderWindow()\n          .getInteractor()\n          .getCurrentRenderer()\n          .getActiveCamera();\n\n        const crosshairPointForApi = api.get('cachedCrosshairWorldPosition');\n        const initialCrosshairPointForApi = api.get(\n          'initialCachedCrosshairWorldPosition'\n        );\n\n        const center = [];\n        vtkMath.subtract(\n          crosshairPointForApi,\n          initialCrosshairPointForApi,\n          center\n        );\n        const translate = [];\n        vtkMath.add(crosshairPointForApi, center, translate);\n\n        const { matrix } = vtkMatrixBuilder\n          .buildFromRadian()\n          .translate(translate[0], translate[1], translate[2])\n          .rotate(angle, axis)\n          .translate(-translate[0], -translate[1], -translate[2]);\n\n        cameraForApi.applyTransform(matrix);\n\n        const sliceNormalForApi = api.getSliceNormal();\n        const viewUpForApi = api.getViewUp();\n        api.setOrientation(sliceNormalForApi, viewUpForApi);\n      }\n    });\n\n    updateCrosshairs(callData);\n\n    /*\n    After the rotations and update of the crosshairs, the focal point of the\n    camera has a shift along the line of sight coordinate respect to the\n    crosshair (i.e., the focal point is not on the same slice of the crosshair).\n    We calculate the new focal point coordinates as the nearest point between\n    the line of sight of the camera and the crosshair coordinates:\n\n      p1 = cameraPositionForApi\n      p2 = cameraFocalPointForApi\n      q = crosshairPointForApi\n\n      Vector3 u = p2 - p1;\n      Vector3 pq = q - p1;\n      Vector3 w2 = pq - vtkMath.multiplyScalar(u, vtkMath.dot(pq, u) / u2);\n\n      Vector3 newFocalPoint = q - w2;\n    */\n\n    apis.forEach(api => {\n      const cameraForApi = api.genericRenderWindow\n        .getRenderWindow()\n        .getInteractor()\n        .getCurrentRenderer()\n        .getActiveCamera();\n\n      const crosshairPointForApi = api.get('cachedCrosshairWorldPosition');\n      const cameraFocalPointForApi = cameraForApi.getFocalPoint();\n      const cameraPositionForApi = cameraForApi.getPosition();\n\n      const u = [];\n      vtkMath.subtract(cameraFocalPointForApi, cameraPositionForApi, u);\n      const pq = [];\n      vtkMath.subtract(crosshairPointForApi, cameraPositionForApi, pq);\n      const uLength2 = u[0] * u[0] + u[1] * u[1] + u[2] * u[2];\n      vtkMath.multiplyScalar(u, vtkMath.dot(pq, u) / uLength2);\n      const w2 = [];\n      vtkMath.subtract(pq, u, w2);\n      const newFocalPointForApi = [];\n      vtkMath.subtract(crosshairPointForApi, w2, newFocalPointForApi);\n\n      cameraForApi.setFocalPoint(\n        newFocalPointForApi[0],\n        newFocalPointForApi[1],\n        newFocalPointForApi[2]\n      );\n    });\n\n    operation.prevPosition = newPosition;\n  }\n\n  function updateCrosshairs(callData) {\n    const { apis, apiIndex } = model;\n    const thisApi = apis[apiIndex];\n\n    const { rotatableCrosshairsWidget } = thisApi.svgWidgets;\n\n    const worldPos = thisApi.get('cachedCrosshairWorldPosition');\n\n    rotatableCrosshairsWidget.moveCrosshairs(worldPos, apis, apiIndex);\n  }\n\n  function snapPosToLine(position, lineIndex) {\n    const { apis, apiIndex } = model;\n    const thisApi = apis[apiIndex];\n    const { svgWidgetManager } = thisApi;\n    const size = svgWidgetManager.getSize();\n    const scale = svgWidgetManager.getScale();\n    const height = size[1];\n\n    // Map to the click point to the same coords as the SVG.\n    const p = { x: position.x * scale, y: height - position.y * scale };\n\n    const { rotatableCrosshairsWidget } = thisApi.svgWidgets;\n    const lines = rotatableCrosshairsWidget.getReferenceLines();\n    const line = lines[lineIndex];\n    const points = line.points;\n\n    // Project p onto line to get new crosshair position\n    let line0toP = [];\n    let line0toline1 = [];\n\n    vec2.sub(line0toP, [p.x, p.y], [points[0].x, points[0].y]);\n    vec2.sub(\n      line0toline1,\n      [points[1].x, points[1].y],\n      [points[0].x, points[0].y]\n    );\n\n    const magnitudeOfLine = vec2.distance(\n      [points[0].x, points[0].y],\n      [points[1].x, points[1].y]\n    );\n\n    const unitVectorAlongLine = [\n      line0toline1[0] / magnitudeOfLine,\n      line0toline1[1] / magnitudeOfLine,\n    ];\n\n    const dotProduct = vec2.dot(line0toP, line0toline1);\n\n    const distanceAlongLine = dotProduct / magnitudeOfLine;\n\n    const newCenterSVG = [\n      points[0].x + unitVectorAlongLine[0] * distanceAlongLine,\n      points[0].y + unitVectorAlongLine[1] * distanceAlongLine,\n    ];\n\n    // Convert back to display coords.\n    return {\n      x: newCenterSVG[0] / scale,\n      y: (height - newCenterSVG[1]) / scale,\n    };\n  }\n\n  function moveCrosshairs(pos, renderer) {\n    const { apis, apiIndex } = model;\n    const thisApi = apis[apiIndex];\n\n    const dPos = vtkCoordinate.newInstance();\n    dPos.setCoordinateSystemToDisplay();\n\n    dPos.setValue(pos.x, pos.y, 0);\n    let worldPos = dPos.getComputedWorldValue(renderer);\n\n    const camera = renderer.getActiveCamera();\n    const directionOfProjection = camera.getDirectionOfProjection();\n\n    const halfSlabThickness = thisApi.getSlabThickness() / 2;\n\n    // Add half of the slab thickness to the world position, such that we select\n    // The center of the slice.\n\n    for (let i = 0; i < worldPos.length; i++) {\n      worldPos[i] += halfSlabThickness * directionOfProjection[i];\n    }\n\n    thisApi.svgWidgets.rotatableCrosshairsWidget.moveCrosshairs(\n      worldPos,\n      apis,\n      apiIndex\n    );\n\n    publicAPI.invokeInteractionEvent({ type: 'InteractionEvent' });\n  }\n\n  function scrollCrosshairs(lineIndex, direction) {\n    const { apis, apiIndex } = model;\n    const thisApi = apis[apiIndex];\n    const { svgWidgetManager, volumes } = thisApi;\n    const volume = volumes[0];\n    const size = svgWidgetManager.getSize();\n    const scale = svgWidgetManager.getScale();\n    const height = size[1];\n    const renderer = thisApi.genericRenderWindow.getRenderer();\n\n    const { rotatableCrosshairsWidget } = thisApi.svgWidgets;\n\n    if (!rotatableCrosshairsWidget) {\n      throw new Error(\n        'Must use rotatable crosshair svg widget with this istyle.'\n      );\n    }\n\n    const lines = rotatableCrosshairsWidget.getReferenceLines();\n    const otherLineIndex = lineIndex === 0 ? 1 : 0;\n\n    const point = rotatableCrosshairsWidget.getPoint();\n    // Transform point to SVG coordinates\n    const p = [point[0] * scale, height - point[1] * scale];\n\n    // Get the unit vector to move the line in.\n\n    const linePoints = lines[otherLineIndex].points;\n    let lowToHighPoints;\n\n    // If line is horizontal (<1 pix difference in height), move right when scroll forward.\n    if (Math.abs(linePoints[0].y - linePoints[1].y) < 1.0) {\n      if (linePoints[0].x < linePoints[1].x) {\n        lowToHighPoints = [linePoints[0], linePoints[1]];\n      } else {\n        lowToHighPoints = [linePoints[1], linePoints[0]];\n      }\n    }\n    // If end is higher on screen, scroll moves crosshairs that way.\n    else if (linePoints[0].y < linePoints[1].y) {\n      lowToHighPoints = [linePoints[0], linePoints[1]];\n    } else {\n      lowToHighPoints = [linePoints[1], linePoints[0]];\n    }\n\n    const unitVector = [];\n    vec2.subtract(\n      unitVector,\n      [lowToHighPoints[1].x, lowToHighPoints[1].y],\n      [lowToHighPoints[0].x, lowToHighPoints[0].y]\n    );\n    vec2.normalize(unitVector, unitVector);\n\n    if (direction === 'forwards') {\n      unitVector[0] *= -1;\n      unitVector[1] *= -1;\n    }\n\n    const displayCoordintateScrollIncrement = getDisplayCoordinateScrollIncrement(\n      point\n    );\n\n    const newCenterPointSVG = [\n      p[0] + unitVector[0] * displayCoordintateScrollIncrement,\n      p[1] + unitVector[1] * displayCoordintateScrollIncrement,\n    ];\n\n    // Clip to box defined by the crosshairs extent\n\n    let lowX;\n    let highX;\n    let lowY;\n    let highY;\n\n    if (lowToHighPoints[0].x < lowToHighPoints[1].x) {\n      lowX = lowToHighPoints[0].x;\n      highX = lowToHighPoints[1].x;\n    } else {\n      lowX = lowToHighPoints[1].x;\n      highX = lowToHighPoints[0].x;\n    }\n\n    if (lowToHighPoints[0].y < lowToHighPoints[1].y) {\n      lowY = lowToHighPoints[0].y;\n      highY = lowToHighPoints[1].y;\n    } else {\n      lowY = lowToHighPoints[1].y;\n      highY = lowToHighPoints[0].y;\n    }\n\n    newCenterPointSVG[0] = Math.min(\n      Math.max(newCenterPointSVG[0], lowX),\n      highX\n    );\n\n    newCenterPointSVG[1] = Math.min(\n      Math.max(newCenterPointSVG[1], lowY),\n      highY\n    );\n\n    // translate to the display coordinates.\n    const displayCoordinate = {\n      x: newCenterPointSVG[0] / scale,\n      y: (height - newCenterPointSVG[1]) / scale,\n    };\n\n    // Move point.\n    moveCrosshairs(displayCoordinate, renderer);\n  }\n\n  function getDisplayCoordinateScrollIncrement(point) {\n    const { apis, apiIndex } = model;\n    const thisApi = apis[apiIndex];\n    const { volumes, genericRenderWindow } = thisApi;\n    const renderer = genericRenderWindow.getRenderer();\n    const volume = volumes[0];\n    const diagonalWorldLength = volume\n      .getMapper()\n      .getInputData()\n      .getSpacing()\n      .map(v => v * v)\n      .reduce((a, b) => a + b, 0);\n\n    const dPos = vtkCoordinate.newInstance();\n    dPos.setCoordinateSystemToDisplay();\n    dPos.setValue(point[0], point[1], 0);\n\n    let worldPosCenter = dPos.getComputedWorldValue(renderer);\n\n    dPos.setValue(point[0] + 1, point[1], 0);\n\n    let worldPosOnePixelOver = dPos.getComputedWorldValue(renderer);\n\n    const distanceOfOnePixelInWorld = vec2.distance(\n      worldPosCenter,\n      worldPosOnePixelOver\n    );\n\n    return diagonalWorldLength / distanceOfOnePixelInWorld;\n  }\n\n  function handlePassiveMouseMove(callData) {\n    const { apis, apiIndex, lineGrabDistance } = model;\n    const thisApi = apis[apiIndex];\n    let { position } = callData;\n\n    // Note: If rotate selected, don't select line.\n    const selectedRotateHandles = [false, false];\n\n    const selectedLines = [false, false];\n\n    const { rotatableCrosshairsWidget } = thisApi.svgWidgets;\n\n    if (!rotatableCrosshairsWidget) {\n      throw new Error(\n        'Must use rotatable crosshair svg widget with this istyle.'\n      );\n    }\n\n    let shouldUpdate;\n\n    const lines = rotatableCrosshairsWidget.getReferenceLines();\n    const point = rotatableCrosshairsWidget.getPoint();\n    const centerRadius = rotatableCrosshairsWidget.getCenterRadius();\n\n    const distanceFromCenter = vec2.distance(point, [position.x, position.y]);\n\n    if (distanceFromCenter > centerRadius) {\n      const { svgWidgetManager } = thisApi;\n      const size = svgWidgetManager.getSize();\n      const scale = svgWidgetManager.getScale();\n      const height = size[1];\n\n      // Map to the click point to the same coords as the SVG.\n      const p = { x: position.x * scale, y: height - position.y * scale };\n\n      let selectedRotationHandle = false;\n\n      // Check each rotation handle\n      for (let lineIndex = 0; lineIndex < lines.length; lineIndex++) {\n        const line = lines[lineIndex];\n        const lineRotateHandles = line.rotateHandles;\n        const { points } = lineRotateHandles;\n\n        for (let i = 0; i < points.length; i++) {\n          const distance = vec2.distance(\n            [points[i].x, points[i].y],\n            [p.x, p.y]\n          );\n\n          if (distance < lineGrabDistance) {\n            selectedRotateHandles[lineIndex] = true;\n            selectedRotationHandle = true;\n            // Don't need to check both points if one is found to be valid.\n            break;\n          }\n        }\n      }\n\n      // If a rotation handle isn't selected, see if we should select lines.\n      if (!selectedRotationHandle) {\n        const distanceFromFirstLine = distanceFromLine(lines[0], p);\n        const distanceFromSecondLine = distanceFromLine(lines[1], p);\n\n        if (\n          distanceFromFirstLine <= lineGrabDistance ||\n          distanceFromSecondLine <= lineGrabDistance\n        ) {\n          const selectedLineIndex =\n            distanceFromFirstLine < distanceFromSecondLine ? 0 : 1;\n\n          selectedLines[selectedLineIndex] = true;\n        }\n      }\n    } else {\n      // Highlight both lines.\n      selectedLines[0] = true;\n      selectedLines[1] = true;\n    }\n\n    lines.forEach((line, index) => {\n      const selected = selectedLines[index];\n      const rotateSelected = selectedRotateHandles[index];\n      const rotateHandles = line.rotateHandles;\n\n      // If changed, update and flag should update.\n      if (line.selected !== selected) {\n        line.selected = selected;\n        shouldUpdate = true;\n      }\n\n      if (rotateHandles.selected !== rotateSelected) {\n        rotateHandles.selected = rotateSelected;\n        shouldUpdate = true;\n      }\n    });\n\n    if (shouldUpdate) {\n      updateCrosshairs(callData);\n    }\n  }\n\n  const superHandleMouseMove = publicAPI.handleMouseMove;\n  publicAPI.handleMouseMove = callData => {\n    if (model.state === States.IS_WINDOW_LEVEL) {\n      performOperation(callData);\n    } else {\n      handlePassiveMouseMove(callData);\n    }\n\n    if (superHandleMouseMove) {\n      superHandleMouseMove(callData);\n    }\n  };\n\n  //const superHandleLeftButtonPress = publicAPI.handleLeftButtonPress;\n  publicAPI.handleLeftButtonPress = callData => {\n    if (model.volumeActor) {\n      selectOpperation(callData);\n      performOperation(callData);\n\n      publicAPI.startWindowLevel();\n    }\n  };\n\n  publicAPI.superHandleLeftButtonRelease = publicAPI.handleLeftButtonRelease;\n  publicAPI.handleLeftButtonRelease = callData => {\n    switch (model.state) {\n      case States.IS_WINDOW_LEVEL:\n        mouseUp(callData);\n        break;\n\n      default:\n        publicAPI.superHandleLeftButtonRelease();\n        break;\n    }\n  };\n\n  function mouseUp(callData) {\n    model.operation = { type: null };\n\n    // Unselect lines\n    const { apis, apiIndex } = model;\n    const thisApi = apis[apiIndex];\n    const { rotatableCrosshairsWidget } = thisApi.svgWidgets;\n\n    if (!rotatableCrosshairsWidget) {\n      throw new Error(\n        'Must use rotatable crosshair svg widget with this istyle.'\n      );\n    }\n\n    const lines = rotatableCrosshairsWidget.getReferenceLines();\n\n    lines.forEach(line => {\n      line.selected = false;\n      line.rotateHandles.selected = false;\n    });\n\n    updateCrosshairs(callData);\n\n    publicAPI.endWindowLevel();\n  }\n\n  const superScrollToSlice = publicAPI.scrollToSlice;\n  publicAPI.scrollToSlice = slice => {\n    const { apis, apiIndex, lineGrabDistance } = model;\n    const thisApi = apis[apiIndex];\n\n    const { rotatableCrosshairsWidget } = thisApi.svgWidgets;\n\n    if (!rotatableCrosshairsWidget) {\n      throw new Error(\n        'Must use rotatable crosshair svg widget with this istyle.'\n      );\n    }\n\n    const lines = rotatableCrosshairsWidget.getReferenceLines();\n\n    let activeLineIndex;\n\n    lines.forEach((line, lineIndex) => {\n      if (line.active) {\n        activeLineIndex = lineIndex;\n      }\n    });\n\n    if (activeLineIndex === undefined) {\n      if (!model.disableNormalMPRScroll) {\n        superScrollToSlice(slice);\n      }\n    } else {\n      const direction = publicAPI.getSlice() - slice;\n\n      const scrollDirection = direction > 0 ? 'forwards' : 'backwards';\n\n      scrollCrosshairs(activeLineIndex, scrollDirection);\n    }\n  };\n}\n\n// ----------------------------------------------------------------------------\n// Object factory\n// ----------------------------------------------------------------------------\n\nconst DEFAULT_VALUES = {\n  operation: { type: null },\n  lineGrabDistance: 20,\n  disableNormalMPRScroll: false,\n};\n\n// ----------------------------------------------------------------------------\n\nexport function extend(publicAPI, model, initialValues = {}) {\n  Object.assign(model, DEFAULT_VALUES, initialValues);\n\n  // Inheritance\n  vtkInteractorStyleMPRSlice.extend(publicAPI, model, initialValues);\n\n  macro.setGet(publicAPI, model, [\n    'callback',\n    'apis',\n    'apiIndex',\n    'onScroll',\n    'operation',\n    'lineGrabDistance',\n    'disableNormalMPRScroll',\n  ]);\n\n  // Object specific methods\n  vtkInteractorStyleRotatableMPRCrosshairs(publicAPI, model);\n}\n\n// ----------------------------------------------------------------------------\n\nexport const newInstance = macro.newInstance(\n  extend,\n  'vtkInteractorStyleRotatableMPRCrosshairs'\n);\n\n// ----------------------------------------------------------------------------\n\nexport default Object.assign({ newInstance, extend });\n","import macro from 'vtk.js/Sources/macro';\nimport vtkInteractorStyleMPRSlice from './vtkInteractorStyleMPRSlice.js';\nimport vtkCoordinate from 'vtk.js/Sources/Rendering/Core/Coordinate';\nimport Constants from 'vtk.js/Sources/Rendering/Core/InteractorStyle/Constants';\n\nconst { States } = Constants;\n\n// ----------------------------------------------------------------------------\n// Global methods\n// ----------------------------------------------------------------------------\n\n// ----------------------------------------------------------------------------\n// vtkInteractorStyleMPRRotate methods\n// ----------------------------------------------------------------------------\n\nfunction vtkInteractorStyleMPRRotate(publicAPI, model) {\n  // Set our className\n  model.classHierarchy.push('vtkInteractorStyleMPRRotate');\n  model.wlStartPos = [0, 0];\n\n  const superHandleMouseMove = publicAPI.handleMouseMove;\n  publicAPI.handleMouseMove = callData => {\n    const pos = [\n      Math.round(callData.position.x),\n      Math.round(callData.position.y),\n    ];\n    const renderer = callData.pokedRenderer;\n\n    if (model.state === States.IS_ROTATE) {\n      publicAPI.rotateFromMouse(pos, renderer);\n      publicAPI.invokeInteractionEvent({ type: 'InteractionEvent' });\n    }\n\n    if (superHandleMouseMove) {\n      superHandleMouseMove(callData);\n    }\n  };\n\n  publicAPI.rotateFromMouse = (pos, renderer) => {\n    const rwi = model.interactor;\n    const size = rwi.getView().getViewportSize(renderer);\n    const xSensitivity = 100.0 / size[0];\n    const ySensitivity = 100.0 / size[1];\n    const dThetaX = -((pos[1] - model.rotateStartPos[1]) * ySensitivity);\n    const dThetaY = -((pos[0] - model.rotateStartPos[0]) * xSensitivity);\n    const viewport = publicAPI.getViewport();\n\n    viewport.rotateRelative(dThetaX, dThetaY);\n\n    model.rotateStartPos[0] = Math.round(pos[0]);\n    model.rotateStartPos[1] = Math.round(pos[1]);\n\n    const { apis, apiIndex } = model;\n    const api = apis[apiIndex];\n\n    if (\n      !api.svgWidgets.crosshairsWidget &&\n      !api.svgWidgets.rotatableCrosshairsWidget\n    ) {\n      // If we aren't using the crosshairs widget, bail out early.\n      return;\n    }\n\n    //const renderer = api.genericRenderWindow.getRenderer();\n    let cachedCrosshairWorldPosition = api.get('cachedCrosshairWorldPosition');\n\n    if (cachedCrosshairWorldPosition === undefined) {\n      // Crosshairs not initilised.\n      return;\n    }\n\n    const wPos = vtkCoordinate.newInstance();\n    wPos.setCoordinateSystemToWorld();\n    wPos.setValue(...cachedCrosshairWorldPosition);\n\n    const doubleDisplayPosition = wPos.getComputedDoubleDisplayValue(renderer);\n\n    const dPos = vtkCoordinate.newInstance();\n    dPos.setCoordinateSystemToDisplay();\n\n    dPos.setValue(doubleDisplayPosition[0], doubleDisplayPosition[1], 0);\n    let worldPos = dPos.getComputedWorldValue(renderer);\n\n    const camera = renderer.getActiveCamera();\n    const directionOfProjection = camera.getDirectionOfProjection();\n    const halfSlabThickness = api.getSlabThickness() / 2;\n\n    // Add half of the slab thickness to the world position, such that we select\n    //The center of the slice.\n\n    for (let i = 0; i < worldPos.length; i++) {\n      worldPos[i] += halfSlabThickness * directionOfProjection[i];\n    }\n\n    if (api.svgWidgets.crosshairsWidget) {\n      api.svgWidgets.crosshairsWidget.moveCrosshairs(worldPos, apis, apiIndex);\n    }\n    if (api.svgWidgets.rotatableCrosshairsWidget) {\n      api.svgWidgets.rotatableCrosshairsWidget.moveCrosshairs(\n        worldPos,\n        apis,\n        apiIndex\n      );\n    }\n  };\n\n  const superHandleLeftButtonPress = publicAPI.handleLeftButtonPress;\n  publicAPI.handleLeftButtonPress = callData => {\n    model.rotateStartPos[0] = Math.round(callData.position.x);\n    model.rotateStartPos[1] = Math.round(callData.position.y);\n    if (!callData.shiftKey && !callData.controlKey) {\n      const property = model.volumeActor.getProperty();\n      if (property) {\n        publicAPI.startRotate();\n      }\n    } else if (superHandleLeftButtonPress) {\n      superHandleLeftButtonPress(callData);\n    }\n  };\n\n  publicAPI.superHandleLeftButtonRelease = publicAPI.handleLeftButtonRelease;\n  publicAPI.handleLeftButtonRelease = () => {\n    switch (model.state) {\n      case States.IS_ROTATE:\n        publicAPI.endRotate();\n        break;\n\n      default:\n        publicAPI.superHandleLeftButtonRelease();\n        break;\n    }\n  };\n\n  // setManipulators();\n}\n\n// ----------------------------------------------------------------------------\n// Object factory\n// ----------------------------------------------------------------------------\n\nconst DEFAULT_VALUES = {\n  rotateStartPos: [0, 0],\n};\n\n// ----------------------------------------------------------------------------\n\nexport function extend(publicAPI, model, initialValues = {}) {\n  Object.assign(model, DEFAULT_VALUES, initialValues);\n\n  // Inheritance\n  vtkInteractorStyleMPRSlice.extend(publicAPI, model, initialValues);\n\n  macro.setGet(publicAPI, model, ['onInteractiveRotateChanged']);\n\n  // Object specific methods\n  vtkInteractorStyleMPRRotate(publicAPI, model);\n}\n\n// ----------------------------------------------------------------------------\n\nexport const newInstance = macro.newInstance(\n  extend,\n  'vtkInteractorStyleMPRRotate'\n);\n\n// ----------------------------------------------------------------------------\n\nexport default Object.assign({ newInstance, extend });\n","import macro from 'vtk.js/Sources/macro';\nimport vtkMatrixBuilder from 'vtk.js/Sources/Common/Core/MatrixBuilder';\nimport vtkCoordinate from 'vtk.js/Sources/Rendering/Core/Coordinate';\n\nlet instanceId = 1;\n\nfunction getWidgetNode(svgContainer, widgetId) {\n  let node = svgContainer.querySelector(`#${widgetId}`);\n  if (!node) {\n    node = document.createElement('g');\n    node.setAttribute('id', widgetId);\n    svgContainer.appendChild(node);\n  }\n  return node;\n}\n\n// ----------------------------------------------------------------------------\n\nfunction vtkSVGCrosshairsWidget(publicAPI, model) {\n  model.classHierarchy.push('vtkSVGCrosshairsWidget');\n  model.widgetId = `vtkSVGCrosshairsWidget-${instanceId++}`;\n\n  publicAPI.render = (svgContainer, scale) => {\n    const node = getWidgetNode(svgContainer, model.widgetId);\n    const { point, strokeColor, strokeWidth, strokeDashArray, padding } = model;\n    if (point[0] === null || point[1] === null) {\n      return;\n    }\n\n    const width = parseInt(svgContainer.getAttribute('width'), 10);\n    const height = parseInt(svgContainer.getAttribute('height'), 10);\n    // Unused\n    // const widthScale = svgContainer.getBoundingClientRect().width / width;\n    // const heightScale = svgContainer.getBoundingClientRect().height / height;\n    // const widthClient = svgContainer.getBoundingClientRect().width;\n    // const heightClient = svgContainer.getBoundingClientRect().height;\n\n    const p = point.slice();\n    p[0] = point[0] * scale;\n    p[1] = height - point[1] * scale;\n\n    const left = [0, height / scale / 2];\n    const top = [width / scale / 2, 0];\n    const right = [width / scale, height / scale / 2];\n    const bottom = [width / scale / 2, height / scale];\n\n    if (model.display) {\n      node.innerHTML = `\n      <g id=\"container\" fill-opacity=\"1\" stroke-dasharray=\"none\" stroke=\"none\" stroke-opacity=\"1\" fill=\"none\">\n       <g>\n       <!-- TODO: Why is this <svg> necessary?? </svg> If I don't include it, nothing renders !-->\n       <svg version=\"1.1\" viewBox=\"0 0 ${width} ${height}\" width=${width} height=${height} style=\"width: 100%; height: 100%\">\n       <!-- Top !-->\n        <line\n          x1=\"${p[0]}\"\n          y1=\"${top[1]}\"\n          x2=\"${p[0]}\"\n          y2=\"${p[1] - padding}\"\n          stroke=\"${strokeColor}\"\n          stroke-dasharray=\"${strokeDashArray}\"\n          stroke-linecap=\"round\"\n          stroke-linejoin=\"round\"\n          stroke-width=\"${strokeWidth}\"\n        ></line>\n        <!-- Right !-->\n        <line\n          x1=\"${right[0]}\"\n          y1=\"${p[1]}\"\n          x2=\"${p[0] + padding}\"\n          y2=\"${p[1]}\"\n          stroke-dasharray=\"${strokeDashArray}\"\n          stroke=\"${strokeColor}\"\n          stroke-linecap=\"round\"\n          stroke-linejoin=\"round\"\n          stroke-width=${strokeWidth}\n        ></line>\n        <!-- Bottom !-->\n        <line\n          x1=\"${p[0]}\"\n          y1=\"${bottom[1]}\"\n          x2=\"${p[0]}\"\n          y2=\"${p[1] + padding}\"\n          stroke-dasharray=\"${strokeDashArray}\"\n          stroke=\"${strokeColor}\"\n          stroke-linecap=\"round\"\n          stroke-linejoin=\"round\"\n          stroke-width=${strokeWidth}\n        ></line>\n        <!-- Left !-->\n        <line\n          x1=\"${left[0]}\"\n          y1=\"${p[1]}\"\n          x2=\"${p[0] - padding}\"\n          y2=\"${p[1]}\"\n          stroke-dasharray=\"${strokeDashArray}\"\n          stroke=\"${strokeColor}\"\n          stroke-linecap=\"round\"\n          stroke-linejoin=\"round\"\n          stroke-width=${strokeWidth}\n        ></line>\n       </g>\n      </g>\n            `;\n    } else {\n      node.innerHTML = '';\n    }\n  };\n\n  publicAPI.resetCrosshairs = (apis, apiIndex) => {\n    const api = apis[apiIndex];\n\n    if (!api.svgWidgets.crosshairsWidget) {\n      // If we aren't using the crosshairs widget, bail out early.\n      return;\n    }\n\n    // Get viewport and get its center.\n    const renderer = api.genericRenderWindow.getRenderer();\n    const view = renderer.getRenderWindow().getViews()[0];\n    const dims = view.getViewportSize(renderer);\n    const dPos = vtkCoordinate.newInstance();\n\n    dPos.setCoordinateSystemToDisplay();\n\n    dPos.setValue(0.5 * dims[0], 0.5 * dims[1], 0);\n    let worldPos = dPos.getComputedWorldValue(renderer);\n\n    const camera = renderer.getActiveCamera();\n    const directionOfProjection = camera.getDirectionOfProjection();\n    const halfSlabThickness = api.getSlabThickness() / 2;\n\n    // Add half of the slab thickness to the world position, such that we select\n    //The center of the slice.\n\n    for (let i = 0; i < worldPos.length; i++) {\n      worldPos[i] += halfSlabThickness * directionOfProjection[i];\n    }\n\n    publicAPI.moveCrosshairs(worldPos, apis);\n  };\n\n  publicAPI.moveCrosshairs = (worldPos, apis) => {\n    if (worldPos === undefined || apis === undefined) {\n      console.error(\n        'worldPos, apis must be defined in order to update crosshairs.'\n      );\n    }\n\n    // Set camera focal point to world coordinate for linked views\n    apis.forEach((api, viewportIndex) => {\n      api.set('cachedCrosshairWorldPosition', worldPos);\n\n      // We are basically doing the same as getSlice but with the world coordinate\n      // that we want to jump to instead of the camera focal point.\n      // I would rather do the camera adjustment directly but I keep\n      // doing it wrong and so this is good enough for now.\n      const renderWindow = api.genericRenderWindow.getRenderWindow();\n\n      const istyle = renderWindow.getInteractor().getInteractorStyle();\n      const sliceNormal = istyle.getSliceNormal();\n      const transform = vtkMatrixBuilder\n        .buildFromDegree()\n        .identity()\n        .rotateFromDirections(sliceNormal, [1, 0, 0]);\n\n      const mutatedWorldPos = worldPos.slice();\n      transform.apply(mutatedWorldPos);\n      const slice = mutatedWorldPos[0];\n\n      istyle.setSlice(slice);\n\n      renderWindow.render();\n\n      const renderer = api.genericRenderWindow.getRenderer();\n      const wPos = vtkCoordinate.newInstance();\n      wPos.setCoordinateSystemToWorld();\n      wPos.setValue(...worldPos);\n\n      const displayPosition = wPos.getComputedDisplayValue(renderer);\n\n      const { svgWidgetManager } = api;\n      api.svgWidgets.crosshairsWidget.setPoint(\n        displayPosition[0],\n        displayPosition[1]\n      );\n\n      svgWidgetManager.render();\n    });\n  };\n\n  publicAPI.updateCrosshairForApi = api => {\n    if (!api.svgWidgets.crosshairsWidget) {\n      // If we aren't using the crosshairs widget, bail out early.\n      return;\n    }\n\n    const renderer = api.genericRenderWindow.getRenderer();\n    let cachedCrosshairWorldPosition = api.get('cachedCrosshairWorldPosition');\n\n    const wPos = vtkCoordinate.newInstance();\n    wPos.setCoordinateSystemToWorld();\n    wPos.setValue(...cachedCrosshairWorldPosition);\n\n    const doubleDisplayPosition = wPos.getComputedDoubleDisplayValue(renderer);\n\n    const dPos = vtkCoordinate.newInstance();\n    dPos.setCoordinateSystemToDisplay();\n\n    dPos.setValue(doubleDisplayPosition[0], doubleDisplayPosition[1], 0);\n    let worldPos = dPos.getComputedWorldValue(renderer);\n\n    const camera = renderer.getActiveCamera();\n    const directionOfProjection = camera.getDirectionOfProjection();\n    const halfSlabThickness = api.getSlabThickness() / 2;\n\n    // Add half of the slab thickness to the world position, such that we select\n    //The center of the slice.\n\n    for (let i = 0; i < worldPos.length; i++) {\n      worldPos[i] += halfSlabThickness * directionOfProjection[i];\n    }\n\n    publicAPI.moveCrosshairs(worldPos, [api]);\n  };\n}\n\n// ----------------------------------------------------------------------------\n\nconst DEFAULT_VALUES = {\n  point: [null, null],\n  strokeColor: '#00ff00',\n  strokeWidth: 1,\n  strokeDashArray: '',\n  padding: 20,\n  display: true,\n};\n\n// ----------------------------------------------------------------------------\n\nexport function extend(publicAPI, model, initialValues = {}) {\n  Object.assign(model, DEFAULT_VALUES, initialValues);\n\n  macro.obj(publicAPI, model);\n  macro.get(publicAPI, model, ['widgetId']);\n  macro.setGet(publicAPI, model, [\n    'strokeColor',\n    'strokeWidth',\n    'strokeDashArray',\n    'display',\n  ]);\n  macro.setGetArray(publicAPI, model, ['point', 'padding'], 2);\n\n  vtkSVGCrosshairsWidget(publicAPI, model);\n}\n\n// ----------------------------------------------------------------------------\n\nexport const newInstance = macro.newInstance(extend, 'vtkSVGCrosshairsWidget');\n\n// ----------------------------------------------------------------------------\n\nexport default { newInstance, extend };\n","// Pulled from source: https://github.com/w8r/liang-barsky\n// MIT Licensed.\n\n/**\n * @preserve\n * Fast, destructive implemetation of Liang-Barsky line clipping algorithm.\n * It clips a 2D segment by a rectangle.\n * @author Alexander Milevski <info@w8r.name>\n * @license MIT\n */\n\nconst EPSILON = 1e-6;\nconst INSIDE = 1;\nconst OUTSIDE = 0;\n\nfunction clipT(num, denom, c) {\n  const [tE, tL] = c;\n  if (Math.abs(denom) < EPSILON) return num < 0;\n  const t = num / denom;\n\n  if (denom > 0) {\n    if (t > tL) return 0;\n    if (t > tE) c[0] = t;\n  } else {\n    if (t < tE) return 0;\n    if (t < tL) c[1] = t;\n  }\n  return 1;\n}\n\n/**\n * @param  {Point} a\n * @param  {Point} b\n * @param  {BoundingBox} box [xmin, ymin, xmax, ymax]\n * @param  {Point?} [da]\n * @param  {Point?} [db]\n * @return {number}\n */\nexport default function clip(a, b, box, da, db) {\n  const [x1, y1] = a;\n  const [x2, y2] = b;\n  const dx = x2 - x1;\n  const dy = y2 - y1;\n\n  if (da === undefined || db === undefined) {\n    da = a;\n    db = b;\n  } else {\n    da[0] = a[0];\n    da[1] = a[1];\n    db[0] = b[0];\n    db[1] = b[1];\n  }\n\n  if (\n    Math.abs(dx) < EPSILON &&\n    Math.abs(dy) < EPSILON &&\n    x1 >= box[0] &&\n    x1 <= box[2] &&\n    y1 >= box[1] &&\n    y1 <= box[3]\n  ) {\n    return INSIDE;\n  }\n\n  const c = [0, 1];\n  if (\n    clipT(box[0] - x1, dx, c) &&\n    clipT(x1 - box[2], -dx, c) &&\n    clipT(box[1] - y1, dy, c) &&\n    clipT(y1 - box[3], -dy, c)\n  ) {\n    const [tE, tL] = c;\n    if (tL < 1) {\n      db[0] = x1 + tL * dx;\n      db[1] = y1 + tL * dy;\n    }\n    if (tE > 0) {\n      da[0] += tE * dx;\n      da[1] += tE * dy;\n    }\n    return INSIDE;\n  }\n  return OUTSIDE;\n}\n","import macro from 'vtk.js/Sources/macro';\nimport vtkMatrixBuilder from 'vtk.js/Sources/Common/Core/MatrixBuilder';\nimport vtkCoordinate from 'vtk.js/Sources/Rendering/Core/Coordinate';\nimport liangBarksyClip from '../helpers/liangBarksyClip';\nimport { vec2, vec3 } from 'gl-matrix';\nimport { projectVector2D } from 'vtk.js/Sources/Common/Core/Math';\n\nlet instanceId = 1;\n\nfunction getWidgetNode(svgContainer, widgetId) {\n  let node = svgContainer.querySelector(`#${widgetId}`);\n  if (!node) {\n    node = document.createElement('g');\n    node.setAttribute('id', widgetId);\n    svgContainer.appendChild(node);\n  }\n  return node;\n}\n\n// ----------------------------------------------------------------------------\n\nfunction vtkSVGRotatableCrosshairsWidget(publicAPI, model) {\n  model.classHierarchy.push('vtkSVGRotatableCrosshairsWidget');\n  model.widgetId = `vtkSVGRotatableCrosshairsWidget-${instanceId++}`;\n\n  model.calculateReferenceLines = (apiIndex, point) => {\n    const { strokeColors, apis } = model;\n    if (point[0] === null || point[1] === null) {\n      return;\n    }\n\n    const thisApi = apis[apiIndex];\n\n    const { svgWidgetManager } = thisApi;\n    const [width, height] = svgWidgetManager.getSize();\n    const scale = svgWidgetManager.getScale();\n\n    const p = point.slice();\n\n    p[0] = point[0] * scale;\n    p[1] = height - point[1] * scale;\n\n    const left = 0;\n    const top = 0;\n    const right = width / scale;\n    const bottom = height / scale;\n\n    const quarterSmallestDimension = Math.min(width, height) / 4;\n\n    // A \"far\" distance for line clipping algorithm.\n    const farDistance = Math.sqrt(bottom * bottom + right * right);\n\n    // TODO -> Move this calculation logic to the update function\n    // And then save the values so we can grab them with another func.\n    const referenceLines = [];\n\n    const crosshairWorldPosition = apis[apiIndex].get(\n      'cachedCrosshairWorldPosition'\n    );\n\n    const { rotatableCrosshairsWidget } = thisApi.svgWidgets;\n\n    const oldReferenceLines = rotatableCrosshairsWidget.getReferenceLines();\n\n    for (let i = 0; i < apis.length; i++) {\n      if (i !== apiIndex) {\n        const api = apis[i];\n\n        const viewUp = api.getViewUp();\n        const sliceNormal = api.getSliceNormal();\n\n        let xAxis = [];\n\n        vec3.cross(xAxis, viewUp, sliceNormal);\n        vec3.normalize(xAxis, xAxis);\n\n        // get a point in the plane.\n        // Need a distant world position or we get rounding errors when mapping to screen and don't get nice right angles.\n        const referenceWorldPointInPlane = [\n          crosshairWorldPosition[0] + (viewUp[0] + xAxis[0]) * 1000000,\n          crosshairWorldPosition[1] + (viewUp[1] + xAxis[1]) * 1000000,\n          crosshairWorldPosition[2] + (viewUp[2] + xAxis[2]) * 1000000,\n        ];\n\n        // thisApi as we want to map it to the displayPosition of THIS api.\n        const renderer = thisApi.genericRenderWindow.getRenderer();\n        const wPos = vtkCoordinate.newInstance();\n        wPos.setCoordinateSystemToWorld();\n        wPos.setValue(...referenceWorldPointInPlane);\n\n        const doubleDisplayPosition = wPos.getComputedDoubleDisplayValue(\n          renderer\n        );\n\n        // convert to svg coordinates:\n\n        const doubleSVGPosition = [\n          doubleDisplayPosition[0] * scale,\n          height - doubleDisplayPosition[1] * scale,\n        ];\n\n        let unitVectorFromCenter = [];\n        vec2.subtract(unitVectorFromCenter, p, doubleSVGPosition);\n        vec2.normalize(unitVectorFromCenter, unitVectorFromCenter);\n\n        const distantPoint = [\n          p[0] + unitVectorFromCenter[0] * farDistance,\n          p[1] + unitVectorFromCenter[1] * farDistance,\n        ];\n\n        const negativeDistantPoint = [\n          p[0] - unitVectorFromCenter[0] * farDistance,\n          p[1] - unitVectorFromCenter[1] * farDistance,\n        ];\n\n        liangBarksyClip(negativeDistantPoint, distantPoint, [\n          left, //xmin\n          top, // ymin\n          right, // xmax\n          bottom, // ymax\n        ]);\n\n        const oldReferenceLine = oldReferenceLines.find(\n          refLine => refLine && refLine.apiIndex === i\n        );\n\n        let lineSelected = false;\n        let rotateSelected = false;\n        let lineActive = false;\n\n        if (oldReferenceLine) {\n          lineSelected = oldReferenceLine.selected;\n          rotateSelected = oldReferenceLine.rotateHandles.selected;\n          lineActive = oldReferenceLine.active;\n        }\n\n        const firstRotateHandle = {\n          x: p[0] + quarterSmallestDimension * unitVectorFromCenter[0],\n          y: p[1] + quarterSmallestDimension * unitVectorFromCenter[1],\n        };\n\n        const secondRotateHandle = {\n          x: p[0] - quarterSmallestDimension * unitVectorFromCenter[0],\n          y: p[1] - quarterSmallestDimension * unitVectorFromCenter[1],\n        };\n\n        const referenceLine = {\n          points: [\n            { x: negativeDistantPoint[0], y: negativeDistantPoint[1] },\n            {\n              x: distantPoint[0],\n              y: distantPoint[1],\n            },\n          ],\n          rotateHandles: {\n            selected: rotateSelected,\n            points: [firstRotateHandle, secondRotateHandle],\n          },\n          color: strokeColors[i],\n          apiIndex: i,\n          selected: lineSelected,\n          active: lineActive,\n        };\n\n        referenceLines.push(referenceLine);\n      }\n    }\n\n    rotatableCrosshairsWidget.setReferenceLines(\n      referenceLines[0],\n      referenceLines[1]\n    );\n  };\n\n  publicAPI.render = (svgContainer, scale) => {\n    const node = getWidgetNode(svgContainer, model.widgetId);\n    let {\n      point,\n      strokeColors,\n      strokeWidth,\n      strokeDashArray,\n      rotateHandleRadius,\n      apis,\n      apiIndex,\n      selectedStrokeWidth,\n    } = model;\n    if (point[0] === null || point[1] === null) {\n      return;\n    }\n\n    const thisApi = apis[apiIndex];\n    const referenceLines = thisApi.svgWidgets.rotatableCrosshairsWidget.getReferenceLines();\n\n    const width = parseInt(svgContainer.getAttribute('width'), 10);\n    const height = parseInt(svgContainer.getAttribute('height'), 10);\n\n    const left = 0;\n    const bottom = height / scale;\n\n    // split up lines.\n\n    const p = point.slice();\n\n    p[0] = point[0] * scale;\n    p[1] = height - point[1] * scale;\n\n    const [firstLine, secondLine] = referenceLines;\n\n    const {\n      points: firstLineRotateHandles,\n      selected: firstLineRotateSelected,\n    } = firstLine.rotateHandles;\n    const {\n      points: secondLineRotateHandles,\n      selected: secondLineRotateSelected,\n    } = secondLine.rotateHandles;\n\n    const [firstLinePart1, firstLinePart2] = model.getSplitReferenceLine(\n      firstLine,\n      p\n    );\n    const [secondLinePart1, secondLinePart2] = model.getSplitReferenceLine(\n      secondLine,\n      p\n    );\n\n    const firstLineStrokeColor = strokeColors[firstLine.apiIndex];\n    const secondLineStrokeColor = strokeColors[secondLine.apiIndex];\n\n    const firstLineStrokeWidth =\n      firstLine.selected || firstLine.active\n        ? selectedStrokeWidth\n        : strokeWidth;\n    const secondLineStrokeWidth =\n      secondLine.selected || secondLine.active\n        ? selectedStrokeWidth\n        : strokeWidth;\n\n    const firstLineRotateWidth = firstLineRotateSelected\n      ? selectedStrokeWidth\n      : strokeWidth;\n    const secondLineRotateWidth = secondLineRotateSelected\n      ? selectedStrokeWidth\n      : strokeWidth;\n\n    const firstLineShowCrosshairs =\n      firstLine.selected || firstLineRotateSelected;\n    const secondLineShowCrosshairs =\n      secondLine.selected || secondLineRotateSelected;\n\n    const firstLineRotateHandleRadius = firstLineShowCrosshairs\n      ? rotateHandleRadius\n      : 0;\n\n    const secondLineRotateHandleRadius = secondLineShowCrosshairs\n      ? rotateHandleRadius\n      : 0;\n\n    const firstLineRotateHandleFill = firstLineRotateSelected\n      ? referenceLines[0].color\n      : 'none';\n\n    const secondLineRotateHandleFill = secondLineRotateSelected\n      ? referenceLines[1].color\n      : 'none';\n\n    if (model.display) {\n      node.innerHTML = `\n      <g id=\"container\" fill-opacity=\"1\" stroke-dasharray=\"none\" stroke=\"none\" stroke-opacity=\"1\" fill=\"none\">\n       <g>\n       <svg version=\"1.1\" viewBox=\"0 0 ${width} ${height}\" width=${width} height=${height} style=\"width: 100%; height: 100%\">\n        <g\n\n          stroke=\"${firstLineStrokeColor}\"\n          stroke-dasharray=\"${strokeDashArray}\"\n          stroke-linecap=\"round\"\n          stroke-linejoin=\"round\"\n          stroke-width=\"${firstLineStrokeWidth}\"\n        >\n        <!-- First Line part 1!-->\n          <line\n            x1=\"${firstLinePart1[0].x}\"\n            y1=\"${firstLinePart1[0].y}\"\n            x2=\"${firstLinePart1[1].x}\"\n            y2=\"${firstLinePart1[1].y}\"\n          ></line>\n          <!-- First Line part 2!-->\n          <line\n            x1=\"${firstLinePart2[0].x}\"\n            y1=\"${firstLinePart2[0].y}\"\n            x2=\"${firstLinePart2[1].x}\"\n            y2=\"${firstLinePart2[1].y}\"\n          ></line>\n        </g>\n        <g\n          stroke=\"${referenceLines[0].color}\"\n          stroke-dasharray=\"${strokeDashArray}\"\n          stroke-linecap=\"round\"\n          stroke-linejoin=\"round\"\n          stroke-width=\"${firstLineRotateWidth}\"\n        >\n            <!--First line rotateHandle 0 -->\n            <circle cx=\"${firstLineRotateHandles[0].x}\" cy=\"${\n        firstLineRotateHandles[0].y\n      }\" r=\"${firstLineRotateHandleRadius}\" fill=\"${firstLineRotateHandleFill}\" />\n            <!--First line rotateHandle 1 -->\n            <circle cx=\"${firstLineRotateHandles[1].x}\" cy=\"${\n        firstLineRotateHandles[1].y\n      }\" r=\"${firstLineRotateHandleRadius}\" fill=\"${firstLineRotateHandleFill}\" />\n        </g>\n        <g\n          stroke-dasharray=\"${strokeDashArray}\"\n          stroke=\"${secondLineStrokeColor}\"\n          stroke-linecap=\"round\"\n          stroke-linejoin=\"round\"\n          stroke-width=${secondLineStrokeWidth}\n        >\n          <!-- Second Line part 1 !-->\n          <line\n            x1=\"${secondLinePart1[0].x}\"\n            y1=\"${secondLinePart1[0].y}\"\n            x2=\"${secondLinePart1[1].x}\"\n            y2=\"${secondLinePart1[1].y}\"\n          ></line>\n          <!-- Second Line part 2 !-->\n          <line\n            x1=\"${secondLinePart2[0].x}\"\n            y1=\"${secondLinePart2[0].y}\"\n            x2=\"${secondLinePart2[1].x}\"\n            y2=\"${secondLinePart2[1].y}\"\n          ></line>\n      </g>\n      <g\n        stroke-dasharray=\"${strokeDashArray}\"\n        stroke=\"${referenceLines[1].color}\"\n        stroke-linecap=\"round\"\n        stroke-linejoin=\"round\"\n        stroke-width=${secondLineRotateWidth}\n      >\n        <!--Second line rotateHandle 0 -->\n        <circle cx=\"${secondLineRotateHandles[0].x}\" cy=\"${\n        secondLineRotateHandles[0].y\n      }\" r=\"${secondLineRotateHandleRadius}\" fill=\"${secondLineRotateHandleFill}\" />\n        <!--Second line rotateHandle 1 -->\n        <circle cx=\"${secondLineRotateHandles[1].x}\" cy=\"${\n        secondLineRotateHandles[1].y\n      }\" r=\"${secondLineRotateHandleRadius}\" fill=\"${secondLineRotateHandleFill}\" />\n      </g>\n      <circle cx=\"${width - 20}\" cy=\"${20}\" r=\"10\" fill=\"${\n        strokeColors[apiIndex]\n      }\" />\n      </g>\n\n      `;\n    } else {\n      node.innerHTML = '';\n    }\n  };\n\n  model.getSplitReferenceLine = (referenceLine, center) => {\n    const { centerRadius } = model;\n\n    const lineDirection = [];\n    vec2.subtract(\n      lineDirection,\n      [referenceLine.points[1].x, referenceLine.points[1].y],\n      [referenceLine.points[0].x, referenceLine.points[0].y]\n    );\n    vec2.normalize(lineDirection, lineDirection);\n\n    const linePart1 = [\n      {\n        x: center[0] + lineDirection[0] * centerRadius,\n        y: center[1] + lineDirection[1] * centerRadius,\n      },\n      referenceLine.points[1],\n    ];\n    const linePart2 = [\n      {\n        x: center[0] - lineDirection[0] * centerRadius,\n        y: center[1] - lineDirection[1] * centerRadius,\n      },\n      referenceLine.points[0],\n    ];\n\n    return [linePart1, linePart2];\n  };\n\n  publicAPI.resetCrosshairs = (apis, apiIndex) => {\n    const api = apis[apiIndex];\n\n    if (!api.svgWidgets.rotatableCrosshairsWidget) {\n      // If we aren't using the crosshairs widget, bail out early.\n      return;\n    }\n\n    // Get viewport and get its center.\n    const renderer = api.genericRenderWindow.getRenderer();\n    const view = renderer.getRenderWindow().getViews()[0];\n    const dims = view.getViewportSize(renderer);\n    const dPos = vtkCoordinate.newInstance();\n\n    dPos.setCoordinateSystemToDisplay();\n\n    dPos.setValue(0.5 * dims[0], 0.5 * dims[1], 0);\n    let worldPos = dPos.getComputedWorldValue(renderer);\n\n    const camera = renderer.getActiveCamera();\n    const directionOfProjection = camera.getDirectionOfProjection();\n    const halfSlabThickness = api.getSlabThickness() / 2;\n\n    // Add half of the slab thickness to the world position, such that we select\n    //The center of the slice.\n\n    for (let i = 0; i < worldPos.length; i++) {\n      worldPos[i] += halfSlabThickness * directionOfProjection[i];\n    }\n\n    publicAPI.moveCrosshairs(worldPos, apis);\n  };\n\n  publicAPI.moveCrosshairs = (worldPos, apis) => {\n    if (worldPos === undefined || apis === undefined) {\n      console.error(\n        'worldPos, apis must be defined in order to update crosshairs.'\n      );\n    }\n\n    // Set camera focal point to world coordinate for linked views\n    apis.forEach((api, apiIndex) => {\n      api.set('cachedCrosshairWorldPosition', worldPos);\n      if (api.get('initialCachedCrosshairWorldPosition') === undefined) {\n        api.set('initialCachedCrosshairWorldPosition', worldPos);\n      }\n\n      // We are basically doing the same as getSlice but with the world coordinate\n      // that we want to jump to instead of the camera focal point.\n      // I would rather do the camera adjustment directly but I keep\n      // doing it wrong and so this is good enough for now.\n      const renderWindow = api.genericRenderWindow.getRenderWindow();\n\n      const istyle = renderWindow.getInteractor().getInteractorStyle();\n      const sliceNormal = istyle.getSliceNormal();\n      const transform = vtkMatrixBuilder\n        .buildFromDegree()\n        .identity()\n        .rotateFromDirections(sliceNormal, [1, 0, 0]);\n\n      const mutatedWorldPos = worldPos.slice();\n      transform.apply(mutatedWorldPos);\n      const slice = mutatedWorldPos[0];\n\n      istyle.setSlice(slice);\n\n      renderWindow.render();\n\n      const renderer = api.genericRenderWindow.getRenderer();\n      const wPos = vtkCoordinate.newInstance();\n      wPos.setCoordinateSystemToWorld();\n      wPos.setValue(...worldPos);\n\n      const displayPosition = wPos.getComputedDoubleDisplayValue(renderer);\n\n      const { svgWidgetManager } = api;\n      api.svgWidgets.rotatableCrosshairsWidget.setPoint(\n        displayPosition[0],\n        displayPosition[1]\n      );\n\n      model.calculateReferenceLines(apiIndex, displayPosition);\n\n      svgWidgetManager.render();\n    });\n  };\n\n  publicAPI.updateCrosshairForApi = api => {\n    if (!api.svgWidgets.rotatableCrosshairsWidget) {\n      // If we aren't using the crosshairs widget, bail out early.\n      return;\n    }\n\n    const renderer = api.genericRenderWindow.getRenderer();\n    let cachedCrosshairWorldPosition = api.get('cachedCrosshairWorldPosition');\n\n    const wPos = vtkCoordinate.newInstance();\n    wPos.setCoordinateSystemToWorld();\n    wPos.setValue(...cachedCrosshairWorldPosition);\n\n    const doubleDisplayPosition = wPos.getComputedDoubleDisplayValue(renderer);\n\n    const dPos = vtkCoordinate.newInstance();\n    dPos.setCoordinateSystemToDisplay();\n\n    dPos.setValue(doubleDisplayPosition[0], doubleDisplayPosition[1], 0);\n    let worldPos = dPos.getComputedWorldValue(renderer);\n\n    const camera = renderer.getActiveCamera();\n    const directionOfProjection = camera.getDirectionOfProjection();\n    const halfSlabThickness = api.getSlabThickness() / 2;\n\n    // Add half of the slab thickness to the world position, such that we select\n    //The center of the slice.\n\n    for (let i = 0; i < worldPos.length; i++) {\n      worldPos[i] += halfSlabThickness * directionOfProjection[i];\n    }\n\n    publicAPI.moveCrosshairs(worldPos, [api]);\n  };\n}\n\n// ----------------------------------------------------------------------------\n\nconst DEFAULT_VALUES = {\n  point: [null, null],\n  apis: [null, null, null],\n  referenceLines: [null, null],\n  strokeColors: ['#e83a0e', '#ede90c', '#07e345'],\n  strokeWidth: 1,\n  rotateHandleRadius: 5,\n  selectedStrokeWidth: 3,\n  centerRadius: 20,\n  strokeDashArray: '',\n  display: true,\n};\n\n// ----------------------------------------------------------------------------\n\nexport function extend(publicAPI, model, initialValues = {}) {\n  Object.assign(model, DEFAULT_VALUES, initialValues);\n\n  macro.obj(publicAPI, model);\n  macro.get(publicAPI, model, ['widgetId']);\n  macro.setGet(publicAPI, model, [\n    'strokeWidth',\n    'selectedStrokeWidth',\n    'strokeDashArray',\n    'display',\n    'apiIndex',\n    'referenceLines',\n    'centerRadius',\n  ]);\n\n  macro.setGetArray(publicAPI, model, ['point', 'referenceLines'], 2);\n  macro.setGetArray(publicAPI, model, ['apis', 'strokeColors'], 3);\n\n  vtkSVGRotatableCrosshairsWidget(publicAPI, model);\n}\n\n// ----------------------------------------------------------------------------\n\nexport const newInstance = macro.newInstance(\n  extend,\n  'vtkSVGRotatableCrosshairsWidget'\n);\n\n// ----------------------------------------------------------------------------\n\nexport default { newInstance, extend };\n","const imageDataCache = new Map();\n\nexport default imageDataCache;\n","import { vec3 } from 'gl-matrix';\nimport vtkImageData from 'vtk.js/Sources/Common/DataModel/ImageData';\nimport vtkDataArray from 'vtk.js/Sources/Common/Core/DataArray';\nimport vtkMath from 'vtk.js/Sources/Common/Core/Math';\n\nimport buildMetadata from './data/buildMetadata.js';\nimport imageDataCache from './data/imageDataCache.js';\nimport sortDatasetsByImagePosition from './data/sortDatasetsByImagePosition.js';\n\n//Tolerance for ImageOrientationPatient\nconst iopTolerance = 1e-6;\n\nexport default function getImageData(imageIds, displaySetInstanceUid) {\n  const cachedImageDataObject = imageDataCache.get(displaySetInstanceUid);\n\n  if (cachedImageDataObject) {\n    return cachedImageDataObject;\n  }\n\n  const { metaData0, metaDataMap, imageMetaData0 } = buildMetadata(imageIds);\n\n  let { rowCosines, columnCosines } = metaData0;\n\n  //correct for the 32bit float header issue before orthogonalizing\n  //https://github.com/OHIF/Viewers/issues/2847\n  for (let i = 0; i < rowCosines.length; i++) {\n    if (Math.abs(rowCosines[i]) < iopTolerance) {\n      rowCosines[i] = 0;\n    }\n    if (Math.abs(columnCosines[i]) < iopTolerance) {\n      columnCosines[i] = 0;\n    }\n  }\n  const rowCosineVec = vec3.fromValues(...rowCosines);\n  const colCosineVec = vec3.fromValues(...columnCosines);\n  const scanAxisNormal = vec3.cross([], rowCosineVec, colCosineVec);\n\n  let direction = [rowCosineVec, colCosineVec, scanAxisNormal];\n  vtkMath.orthogonalize3x3(direction, direction);\n\n  //setDirection expects orthogonal matrix\n  const orthogonalizedDirection = [\n    ...direction[0],\n    ...direction[1],\n    ...direction[2],\n  ];\n\n  const { spacing, origin, sortedDatasets } = sortDatasetsByImagePosition(\n    scanAxisNormal,\n    metaDataMap\n  );\n\n  const xSpacing = metaData0.columnPixelSpacing;\n  const ySpacing = metaData0.rowPixelSpacing;\n  const zSpacing = spacing;\n  const xVoxels = metaData0.columns;\n  const yVoxels = metaData0.rows;\n  const zVoxels = metaDataMap.size;\n  const signed = imageMetaData0.pixelRepresentation === 1;\n  const multiComponent = metaData0.numberOfComponents > 1;\n\n  // TODO: Support numberOfComponents = 3 for RGB?\n  if (multiComponent) {\n    throw new Error('Multi component image not supported by this plugin.');\n  }\n\n  let pixelArray;\n  switch (imageMetaData0.bitsAllocated) {\n    case 8:\n      if (signed) {\n        throw new Error(\n          '8 Bit signed images are not yet supported by this plugin.'\n        );\n      } else {\n        throw new Error(\n          '8 Bit unsigned images are not yet supported by this plugin.'\n        );\n      }\n\n    case 16:\n      pixelArray = new Float32Array(xVoxels * yVoxels * zVoxels);\n\n      break;\n  }\n\n  const scalarArray = vtkDataArray.newInstance({\n    name: 'Pixels',\n    numberOfComponents: 1,\n    values: pixelArray,\n  });\n\n  const imageData = vtkImageData.newInstance();\n  imageData.setDimensions(xVoxels, yVoxels, zVoxels);\n  imageData.setSpacing(xSpacing, ySpacing, zSpacing);\n  imageData.setDirection(orthogonalizedDirection);\n  imageData.setOrigin(...origin);\n  imageData.getPointData().setScalars(scalarArray);\n\n  const _publishPixelDataInserted = count => {\n    imageDataObject.subscriptions.onPixelDataInserted.forEach(callback => {\n      callback(count);\n    });\n  };\n\n  const _publishPixelDataInsertedError = error => {\n    imageDataObject.subscriptions.onPixelDataInsertedError.forEach(callback => {\n      callback(error);\n    });\n  };\n\n  const _publishAllPixelDataInserted = () => {\n    imageDataObject.subscriptions.onAllPixelDataInserted.forEach(callback => {\n      callback();\n    });\n    imageDataObject.isLoading = false;\n    imageDataObject.loaded = true;\n    imageDataObject.vtkImageData.modified();\n\n    // Remove all subscriptions on completion.\n    imageDataObject.subscriptions = {\n      onPixelDataInserted: [],\n      onPixelDataInsertedError: [],\n      onAllPixelDataInserted: [],\n    };\n  };\n\n  const imageDataObject = {\n    imageIds,\n    metaData0,\n    imageMetaData0,\n    dimensions: [xVoxels, yVoxels, zVoxels],\n    spacing: [xSpacing, ySpacing, zSpacing],\n    origin,\n    direction,\n    vtkImageData: imageData,\n    metaDataMap,\n    sortedDatasets,\n    loaded: false,\n    subscriptions: {\n      onPixelDataInserted: [],\n      onPixelDataInsertedError: [],\n      onAllPixelDataInserted: [],\n    },\n    onPixelDataInserted: callback => {\n      imageDataObject.subscriptions.onPixelDataInserted.push(callback);\n    },\n    onPixelDataInsertedError: callback => {\n      imageDataObject.subscriptions.onPixelDataInsertedError.push(callback);\n    },\n    onAllPixelDataInserted: callback => {\n      imageDataObject.subscriptions.onAllPixelDataInserted.push(callback);\n    },\n    _publishPixelDataInserted,\n    _publishAllPixelDataInserted,\n    _publishPixelDataInsertedError,\n  };\n\n  imageDataCache.set(displaySetInstanceUid, imageDataObject);\n\n  return imageDataObject;\n}\n","import cornerstone from 'cornerstone-core';\n\nexport default function buildMetadata(imageIds) {\n  // Retrieve the Cornerstone imageIds from the display set\n  // TODO: In future, we want to get the metadata independently from Cornerstone\n  const imageId0 = imageIds[0];\n\n  const {\n    pixelRepresentation,\n    bitsAllocated,\n    bitsStored,\n    highBit,\n    photometricInterpretation,\n    samplesPerPixel,\n  } = cornerstone.metaData.get('imagePixelModule', imageId0);\n\n  let { windowWidth, windowCenter } = cornerstone.metaData.get(\n    'voiLutModule',\n    imageId0\n  );\n\n  // TODO maybe expose voi lut lists?\n  if (Array.isArray(windowWidth)) {\n    windowWidth = windowWidth[0];\n  }\n\n  if (Array.isArray(windowCenter)) {\n    windowCenter = windowCenter[0];\n  }\n\n  const { modality } = cornerstone.metaData.get(\n    'generalSeriesModule',\n    imageId0\n  );\n\n  // Compute the image size and spacing given the meta data we already have available.\n  const metaDataMap = new Map();\n  imageIds.forEach(imageId => {\n    // TODO: Retrieve this from somewhere other than Cornerstone\n    const metaData = cornerstone.metaData.get('imagePlaneModule', imageId);\n\n    metaDataMap.set(imageId, metaData);\n  });\n\n  return {\n    metaData0: metaDataMap.values().next().value,\n    metaDataMap,\n    imageIds,\n    imageMetaData0: {\n      bitsAllocated,\n      bitsStored,\n      samplesPerPixel,\n      highBit,\n      photometricInterpretation,\n      pixelRepresentation,\n      windowWidth,\n      windowCenter,\n      modality,\n    },\n  };\n}\n","import { vec3 } from 'gl-matrix';\n\n/**\n *\n * @param {*} scanAxisNormal - [x, y, z] array or gl-matrix vec3\n * @param {*} imageMetaDataMap - one of the results from BuildMetadata()\n */\nexport default function sortDatasetsByImagePosition(\n  scanAxisNormal,\n  imageMetaDataMap\n) {\n  // See https://github.com/dcmjs-org/dcmjs/blob/4849ed50db8788741c2773b3d9c75cc52441dbcb/src/normalizers.js#L167\n  // TODO: Find a way to make this code generic?\n\n  const datasets = Array.from(imageMetaDataMap.values());\n  const referenceDataset = datasets[0];\n\n  const distanceDatasetPairs = datasets.map(function(dataset) {\n    const positionVector = vec3.sub(\n      [],\n      referenceDataset.imagePositionPatient,\n      dataset.imagePositionPatient\n    );\n    const distance = vec3.dot(positionVector, scanAxisNormal);\n\n    return {\n      distance,\n      dataset,\n    };\n  });\n\n  distanceDatasetPairs.sort(function(a, b) {\n    return b.distance - a.distance;\n  });\n\n  const sortedDatasets = distanceDatasetPairs.map(a => a.dataset);\n  const distances = distanceDatasetPairs.map(a => a.distance);\n\n  // TODO: The way we calculate spacing determines how the volume shows up if\n  // we have missing slices.\n  // - Should we just bail out for now if missing slices are present?\n  //const spacing = mean(diff(distances));\n  const spacing = Math.abs(distances[1] - distances[0]);\n\n  return {\n    spacing,\n    origin: distanceDatasetPairs[0].dataset.imagePositionPatient,\n    sortedDatasets,\n  };\n}\n","import cornerstone from 'cornerstone-core';\n\nexport default function getPatientWeightAndCorrectedDose(imageId) {\n  const seriesModule = cornerstone.metaData.get('generalSeriesModule', imageId);\n\n  const patientStudyModule = cornerstone.metaData.get(\n    'patientStudyModule',\n    imageId\n  );\n\n  if (!patientStudyModule) {\n    throw new Error('patientStudyModule metadata is required');\n  }\n\n  const patientWeight = patientStudyModule.patientWeight; // In kg\n\n  if (!patientWeight) {\n    throw new Error(\n      'patientWeight must be present in patientStudyModule for modality PT'\n    );\n  }\n\n  const petSequenceModule = cornerstone.metaData.get(\n    'petIsotopeModule',\n    imageId\n  );\n\n  if (!petSequenceModule) {\n    throw new Error('petSequenceModule metadata is required');\n  }\n\n  // TODO:\n  // - Update this to match the SUV logic provided here:\n  //   https://github.com/salimkanoun/fijiPlugins/blob/master/Pet_Ct_Viewer/src/SUVDialog.java\n  // - Test with PET datasets from various providers to ensure SUV is correct\n  const radiopharmaceuticalInfo = petSequenceModule.radiopharmaceuticalInfo;\n  const startTime = radiopharmaceuticalInfo.radiopharmaceuticalStartTime;\n  const totalDose = radiopharmaceuticalInfo.radionuclideTotalDose;\n  const halfLife = radiopharmaceuticalInfo.radionuclideHalfLife;\n  const seriesAcquisitionTime = seriesModule.seriesTime;\n\n  if (!startTime || !totalDose || !halfLife || !seriesAcquisitionTime) {\n    throw new Error(\n      'The required radiopharmaceutical information was not present.'\n    );\n  }\n\n  const acquisitionTimeInSeconds =\n    _fracToDec(seriesAcquisitionTime.fractionalSeconds || 0) +\n    seriesAcquisitionTime.seconds +\n    seriesAcquisitionTime.minutes * 60 +\n    seriesAcquisitionTime.hours * 60 * 60;\n  const injectionStartTimeInSeconds =\n    _fracToDec(startTime.fractionalSeconds) +\n    startTime.seconds +\n    startTime.minutes * 60 +\n    startTime.hours * 60 * 60;\n  const durationInSeconds =\n    acquisitionTimeInSeconds - injectionStartTimeInSeconds;\n  const correctedDose =\n    totalDose * Math.exp((-durationInSeconds * Math.log(2)) / halfLife);\n\n  return { patientWeight, correctedDose };\n}\n\n/**\n * Returns a decimal value given a fractional value.\n * @private\n * @method\n * @name _fracToDec\n *\n * @param  {number} fractionalValue The value to convert.\n * @returns {number}                 The value converted to decimal.\n */\nfunction _fracToDec(fractionalValue) {\n  return parseFloat(`.${fractionalValue}`);\n}\n","import cornerstone from 'cornerstone-core';\nimport insertSlice from './data/insertSlice.js';\nimport getPatientWeightAndCorrectedDose from './data/getPatientWeightAndCorrectedDose.js';\n\n// TODO: If we attempt to load multiple imageDataObjects at once this will break.\nexport default function loadImageDataProgressively(imageDataObject) {\n  if (imageDataObject.loaded || imageDataObject.isLoading) {\n    // Returning instantly resolved promise as good to go.\n    // Returning promise to be resolved by other process as loading.\n    return;\n  }\n\n  const {\n    imageIds,\n    vtkImageData,\n    metaDataMap,\n    sortedDatasets,\n  } = imageDataObject;\n\n  const imageId0 = imageIds[0];\n\n  const seriesModule = cornerstone.metaData.get(\n    'generalSeriesModule',\n    imageId0\n  );\n\n  // If no seriesModule is present will default to linear scaling function.\n  const modality = seriesModule && seriesModule.modality;\n  let modalitySpecificScalingParameters;\n\n  if (modality === 'PT') {\n    modalitySpecificScalingParameters = getPatientWeightAndCorrectedDose(\n      imageId0\n    );\n  }\n\n  imageDataObject.isLoading = true;\n\n  // This is straight up a hack: vtkjs cries when you feed it data with a range of zero.\n  // So lets set the first voxel to 1, which will be replaced when the first image comes in.\n  const scalars = vtkImageData.getPointData().getScalars();\n  const scalarData = scalars.getData();\n\n  scalarData[0] = 1;\n\n  const range = {\n    max: Number.NEGATIVE_INFINITY,\n    min: Number.POSITIVE_INFINITY,\n  };\n\n  const numberOfFrames = imageIds.length;\n  let numberProcessed = 0;\n\n  const reRenderFraction = numberOfFrames / 5;\n  let reRenderTarget = reRenderFraction;\n\n  const insertPixelDataErrorHandler = error => {\n    numberProcessed++;\n    imageDataObject._publishPixelDataInsertedError(error);\n\n    if (numberProcessed === numberOfFrames) {\n      // Done loading, publish complete and remove all subscriptions.\n      imageDataObject._publishAllPixelDataInserted();\n    }\n  };\n\n  const insertPixelData = image => {\n    const { imagePositionPatient } = metaDataMap.get(image.imageId);\n\n    const sliceIndex = sortedDatasets.findIndex(\n      dataset => dataset.imagePositionPatient === imagePositionPatient\n    );\n\n    const { max, min } = insertSlice(\n      vtkImageData,\n      sliceIndex,\n      image,\n      modality,\n      modalitySpecificScalingParameters\n    );\n\n    if (max > range.max) {\n      range.max = max;\n    }\n\n    if (min < range.min) {\n      range.min = min;\n    }\n\n    const dataArray = vtkImageData.getPointData().getScalars();\n\n    dataArray.setRange(range, 1);\n    numberProcessed++;\n\n    if (numberProcessed > reRenderTarget) {\n      reRenderTarget += reRenderFraction;\n\n      vtkImageData.modified();\n    }\n\n    imageDataObject._publishPixelDataInserted(numberProcessed);\n\n    if (numberProcessed === numberOfFrames) {\n      // Done loading, publish complete and remove all subscriptions.\n      imageDataObject._publishAllPixelDataInserted();\n    }\n  };\n\n  prefetchImageIds(imageIds, insertPixelData, insertPixelDataErrorHandler);\n}\n\nfunction prefetchImageIds(\n  imageIds,\n  insertPixelData,\n  insertPixelDataErrorHandler\n) {\n  const imageLoadPoolManager = cornerstone.imageLoadPoolManager;\n  const requestType = 'prefetch';\n\n  const requestFn = id =>\n    cornerstone\n      .loadAndCacheImage(id)\n      .then(insertPixelData, insertPixelDataErrorHandler);\n\n  imageIds.forEach(imageId => {\n    imageLoadPoolManager.addRequest(\n      requestFn.bind(this, imageId),\n      requestType,\n      {\n        imageId,\n      }\n    );\n  });\n}\n","/**\n *\n * @param {Object} imageData - The vtkImageData\n * @param {*} sliceIndex - The index of the slice you are inserting.\n * @param {*} image The cornerstone image to pull pixel data data from.\n * @param {*} modality The modality of the image.\n * @param {*} modalitySpecificScalingParameters Specific scaling paramaters for this modality. E.g. Patient weight.\n */\nexport default function insertSlice(\n  imageData,\n  sliceIndex,\n  image,\n  modality,\n  modalitySpecificScalingParameters\n) {\n  const scalars = imageData.getPointData().getScalars();\n  const scalarData = scalars.getData();\n\n  const scalingFunction = _getScalingFunction(\n    modality,\n    image,\n    modalitySpecificScalingParameters\n  );\n\n  const pixels = image.getPixelData();\n  const sliceLength = pixels.length;\n\n  let pixelIndex = 0;\n  let max = scalingFunction(pixels[pixelIndex]);\n  let min = max;\n\n  for (let pixelIndex = 0; pixelIndex < pixels.length; pixelIndex++) {\n    const destIdx = pixelIndex + sliceIndex * sliceLength;\n    const pixel = pixels[pixelIndex];\n    const pixelValue = scalingFunction(pixel);\n\n    if (pixelValue > max) {\n      max = pixelValue;\n    } else if (pixelValue < min) {\n      min = pixelValue;\n    }\n\n    scalarData[destIdx] = pixelValue;\n  }\n\n  return { min, max };\n}\n\nfunction _getScalingFunction(\n  modality,\n  image,\n  modalitySpecificScalingParameters\n) {\n  const { slope, intercept } = image;\n\n  if (modality === 'PT') {\n    const { patientWeight, correctedDose } = modalitySpecificScalingParameters;\n    return pixel => {\n      const modalityPixelValue = pixel * slope + intercept;\n\n      return (1000 * modalityPixelValue * patientWeight) / correctedDose;\n    };\n  } else {\n    return pixel => {\n      return pixel * slope + intercept;\n    };\n  }\n}\n","/**\n * @param {vtkVolume} volume A vtkVolume object to invert\n * @param {()=>void|{render:()=>void}} [rendering] - A function to render the volume after\n * being inverted or a RenderWindow object. Can be null.\n * @returns void\n */\nexport default (volume, rendering = null) => {\n  if (!volume) {\n    return;\n  }\n\n  const rgbTransferFunction = volume.getProperty().getRGBTransferFunction(0);\n  const size = rgbTransferFunction.getSize();\n\n  for (let index = 0; index < size; index++) {\n    const nodeValue1 = [];\n\n    rgbTransferFunction.getNodeValue(index, nodeValue1);\n\n    nodeValue1[1] = 1 - nodeValue1[1];\n    nodeValue1[2] = 1 - nodeValue1[2];\n    nodeValue1[3] = 1 - nodeValue1[3];\n\n    rgbTransferFunction.setNodeValue(index, nodeValue1);\n  }\n\n  if (rendering instanceof Function) {\n    rendering();\n  } else if (rendering && rendering.render) {\n    rendering.render();\n  }\n};\n","import View2D from './VTKViewport/View2D';\nimport View3D from './VTKViewport/View3D';\nimport vtkInteractorStyleMPRSlice from './VTKViewport/vtkInteractorStyleMPRSlice.js';\nimport vtkInteractorStyleMPRWindowLevel from './VTKViewport/vtkInteractorStyleMPRWindowLevel.js';\nimport vtkInteractorStyleMPRCrosshairs from './VTKViewport/vtkInteractorStyleMPRCrosshairs.js';\nimport vtkInteractorStyleRotatableMPRCrosshairs from './VTKViewport/vtkInteractorStyleRotatableMPRCrosshairs.js';\nimport vtkInteractorStyleMPRRotate from './VTKViewport/vtkInteractorStyleMPRRotate.js';\nimport vtkSVGWidgetManager from './VTKViewport/vtkSVGWidgetManager.js';\nimport vtkSVGCrosshairsWidget from './VTKViewport/vtkSVGCrosshairsWidget.js';\nimport vtkSVGRotatableCrosshairsWidget from './VTKViewport/vtkSVGRotatableCrosshairsWidget.js';\nimport ViewportData from './VTKViewport/ViewportData';\nimport ViewportOverlay from './ViewportOverlay/ViewportOverlay.js';\nimport getImageData from './lib/getImageData.js';\nimport loadImageData from './lib/loadImageData.js';\nimport invertVolume from './lib/invertVolume.js';\nimport EVENTS from './events.js';\n\nexport {\n  View2D,\n  View3D,\n  ViewportOverlay,\n  ViewportData,\n  getImageData,\n  loadImageData,\n  vtkInteractorStyleMPRWindowLevel,\n  vtkInteractorStyleMPRCrosshairs,\n  vtkInteractorStyleRotatableMPRCrosshairs,\n  vtkInteractorStyleMPRRotate,\n  vtkInteractorStyleMPRSlice,\n  vtkSVGWidgetManager,\n  vtkSVGCrosshairsWidget,\n  vtkSVGRotatableCrosshairsWidget,\n  invertVolume,\n  EVENTS,\n};\n\nexport default View2D;\n"],"sourceRoot":""}